<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ROS入门学习1-ROS简介与安装</title>
      <link href="/2020/09/13/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A01-ROS%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85/"/>
      <url>/2020/09/13/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A01-ROS%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><ul><li>ROS入门学习1-ROS简介与安装</li><li>ROS入门学习2-ROS架构与通信机制</li><li>ROS入门学习3-常用命令与工具介绍</li><li>ROS入门学习4-创建工作空间与功能包</li><li>ROS入门学习5-理解话题中 Publier 与 Subscriber </li><li>ROS入门学习6-理解服务中 Server 与 Client </li><li>ROS入门学习7-理解动作中 Server 与 Client </li><li>ROS入门学习8-多机通信配置</li><li>ROS入门学习9-坐标树的维护</li><li>ROS入门学习9-坐标变幻（广播与监听）</li></ul><ul><li>ROS机器人仿真1-URDF格式</li><li>ROS机器人仿真2-XACRO格式</li><li>ROS机器人仿真3-在Gazebo环境下显示与移动</li><li>ROS机器人仿真4-配置激光雷达和深度相机插件</li><li>ROS机器人仿真5-测试Gmapping建图效果</li></ul><ul><li>SLAM与自主导航学习1-常用的SLAM算法和路径规划算法</li><li>SLAM与自主导航学习2-gmapping功能包安装与演示</li><li>SLAM与自主导航学习3-cartographer功能包安装与演示</li><li>SLAM与自主导航学习4-hector功能包安装与演示</li><li>SLAM与自主导航学习5-navigation功能包安装与演示</li></ul><ul><li>源码解读1-gmapping算法释疑</li><li>源码解读2-move_base算法释疑</li><li>源码解读3-amcl算法释疑</li></ul><ul><li>trobot学习1-配置与清单</li><li>trobot学习2-多机通信配置</li><li>trobot学习3-下位机驱动程序</li><li>trobot学习4-上位机驱动程序</li><li>trobot学习5-PID调速与速度校准</li><li>trobot学习7-里程计数据查看</li><li>trobot学习8-激光雷达RPLIDAR A1驱动</li><li>trobot学习9-深度相机Kinect V1驱动</li></ul><ul><li>项目经验与总结1-线程的简单使用</li><li>项目经验与总结2-机器人常见底盘运动学分析</li><li>项目经验与总结3-数据库SQLite3的简单使用</li><li>项目经验与总结4-时间与定时操作</li><li>项目经验与总结5-文件操作</li></ul><ul><li>Opencv学习1-图像的平移、缩放与投影</li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS机器人仿真 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS机器人 </tag>
            
            <tag> 3D建模与仿真 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS机器人仿真2-XACRO格式</title>
      <link href="/2020/09/09/ROS%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%BB%BF%E7%9C%9F2-XACRO%E6%A0%BC%E5%BC%8F/"/>
      <url>/2020/09/09/ROS%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%BB%BF%E7%9C%9F2-XACRO%E6%A0%BC%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>随着机器人模块的增加，urdf格式文件代码工作量急剧增大且后期维护较为困难。为此，Xacro(XML Macros)格式有助于压缩文件大小，增加文件可读性和可维护性。<br>本章主要通过XACRO创建一个简单的机器人模型。</p><blockquote><p><strong>运行环境：</strong></p><ul><li>虚拟机 VMware15.1</li><li>Ubuntu 16.04</li><li>ROS kinect</li></ul></blockquote><h2 id="1-创建机器人仿真功能包-robot-simulation"><a href="#1-创建机器人仿真功能包-robot-simulation" class="headerlink" title="1. 创建机器人仿真功能包 robot_simulation"></a>1. 创建机器人仿真功能包 robot_simulation</h2><pre><code>$ catkin_create_pkg robot_simulation roscpp rospy std_msgs urdf   gazebo_plugins gazebo_ros gazebo_ros_control</code></pre><p>(如已创建，可跳过)</p><h3 id="1-1-创建XACRO机器人模型"><a href="#1-1-创建XACRO机器人模型" class="headerlink" title="1.1 创建XACRO机器人模型"></a>1.1 创建XACRO机器人模型</h3><ul><li>新建<code>robot_simulation/xacro/trobot_base.urdf.xacro</code>文件，内容如下：</li></ul><figure class="highlight xml"><figcaption><span>trobot_base.urdf.xacro</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">robot</span> <span class="attr">name</span>=<span class="string">&quot;trobot&quot;</span> <span class="attr">xmlns:xacro</span>=<span class="string">&quot;http://www.ros.org/wiki/xacro&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Defining the colors used in this robot --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;Black&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;0 0 0 1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">material</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;White&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;1 1 1 1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">material</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;Blue&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;0 0 1 1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">material</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;Red&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;1 0 0 1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">material</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Macro for inertia matrix --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:macro</span> <span class="attr">name</span>=<span class="string">&quot;sphere_inertial_matrix&quot;</span> <span class="attr">params</span>=<span class="string">&quot;m r&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">inertial</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mass</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;m&#125;&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inertia</span> <span class="attr">ixx</span>=<span class="string">&quot;$&#123;2*m*r*r/5&#125;&quot;</span> <span class="attr">ixy</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ixz</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">iyy</span>=<span class="string">&quot;$&#123;2*m*r*r/5&#125;&quot;</span> <span class="attr">iyz</span>=<span class="string">&quot;0&quot;</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">izz</span>=<span class="string">&quot;$&#123;2*m*r*r/5&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">inertial</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xacro:macro</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:macro</span> <span class="attr">name</span>=<span class="string">&quot;cylinder_inertial_matrix&quot;</span> <span class="attr">params</span>=<span class="string">&quot;m r h&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">inertial</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mass</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;m&#125;&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inertia</span> <span class="attr">ixx</span>=<span class="string">&quot;$&#123;m*(3*r*r+h*h)/12&#125;&quot;</span> <span class="attr">ixy</span> = <span class="string">&quot;0&quot;</span> <span class="attr">ixz</span> = <span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">iyy</span>=<span class="string">&quot;$&#123;m*(3*r*r+h*h)/12&#125;&quot;</span> <span class="attr">iyz</span> = <span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">izz</span>=<span class="string">&quot;$&#123;m*r*r/2&#125;&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">inertial</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xacro:macro</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:macro</span> <span class="attr">name</span>=<span class="string">&quot;box_inertial_matrix&quot;</span> <span class="attr">params</span>=<span class="string">&quot;m w h d&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">inertial</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mass</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;m&#125;&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inertia</span> <span class="attr">ixx</span>=<span class="string">&quot;$&#123;m*(h*h+d*d)/12&#125;&quot;</span> <span class="attr">ixy</span> = <span class="string">&quot;0&quot;</span> <span class="attr">ixz</span> = <span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">iyy</span>=<span class="string">&quot;$&#123;m*(w*w+d*d)/12&#125;&quot;</span> <span class="attr">iyz</span> = <span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">izz</span>=<span class="string">&quot;$&#123;m*(w*w+h*h)/12&#125;&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">inertial</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xacro:macro</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- PROPERTY LIST --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--All units in m-kg-s-radians unit system --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;M_PI&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3.1415926535897931&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Main body length, width, height and mass --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;basebox_length&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.3&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;basebox_width&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;0.28&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;basebox_height&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.05&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;basebox_mass&quot;</span>   <span class="attr">value</span>=<span class="string">&quot;0.5&quot;</span> /&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Wheel radius, height and mass --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;wheel_radius&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.03&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;wheel_height&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.017&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;wheel_mass&quot;</span>   <span class="attr">value</span>=<span class="string">&quot;0.3&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;motor_x&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.10&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:property</span> <span class="attr">name</span>=<span class="string">&quot;motor_y&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0.145&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Macro for wheel joint --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:macro</span> <span class="attr">name</span>=<span class="string">&quot;wheel&quot;</span> <span class="attr">params</span>=<span class="string">&quot;lr translateX translateY motor_direction&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- lr: left, right --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">name</span>=<span class="string">&quot;wheel_$&#123;lr&#125;_link&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">visual</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">origin</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 0&quot;</span> <span class="attr">rpy</span>=<span class="string">&quot;$&#123;M_PI/2&#125; 0  0 &quot;</span> /&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">geometry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cylinder</span> <span class="attr">length</span>=<span class="string">&quot;$&#123;wheel_height&#125;&quot;</span> <span class="attr">radius</span>=<span class="string">&quot;$&#123;wheel_radius&#125;&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;Black&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">visual</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">collision</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">origin</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 0&quot;</span> <span class="attr">rpy</span>=<span class="string">&quot;$&#123;M_PI/2&#125; 0 0 &quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">geometry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cylinder</span> <span class="attr">length</span>=<span class="string">&quot;$&#123;wheel_height&#125;&quot;</span> <span class="attr">radius</span>=<span class="string">&quot;$&#123;wheel_radius&#125;&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">collision</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cylinder_inertial_matrix</span>  <span class="attr">m</span>=<span class="string">&quot;$&#123;wheel_mass&#125;&quot;</span> <span class="attr">r</span>=<span class="string">&quot;$&#123;wheel_radius&#125;&quot;</span> <span class="attr">h</span>=<span class="string">&quot;$&#123;wheel_height&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">gazebo</span> <span class="attr">reference</span>=<span class="string">&quot;wheel_$&#123;lr&#125;_link&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">material</span>&gt;</span>Gazebo/Black<span class="tag">&lt;/<span class="name">material</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">gazebo</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">joint</span> <span class="attr">name</span>=<span class="string">&quot;base_to_wheel_$&#123;lr&#125;_joint&quot;</span> <span class="attr">type</span>=<span class="string">&quot;continuous&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">parent</span> <span class="attr">link</span>=<span class="string">&quot;base_link&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">child</span> <span class="attr">link</span>=<span class="string">&quot;wheel_$&#123;lr&#125;_link&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">origin</span> <span class="attr">xyz</span>=<span class="string">&quot;$&#123;translateX * motor_x&#125; $&#123;translateY * motor_y&#125; 0&quot;</span> <span class="attr">rpy</span>=<span class="string">&quot;0 $&#123;motor_direction&#125; 0&quot;</span> /&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">axis</span> <span class="attr">xyz</span>=<span class="string">&quot;0 1 0&quot;</span> <span class="attr">rpy</span>=<span class="string">&quot;0  0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">joint</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Transmission is important to link the joints and the controller --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transmission</span> <span class="attr">name</span>=<span class="string">&quot;wheel_$&#123;lr&#125;_joint_trans&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>transmission_interface/SimpleTransmission<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">joint</span> <span class="attr">name</span>=<span class="string">&quot;base_to_wheel_$&#123;lr&#125;_joint&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">actuator</span> <span class="attr">name</span>=<span class="string">&quot;wheel_$&#123;lr&#125;_joint_motor&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">hardwareInterface</span>&gt;</span>VelocityJointInterface<span class="tag">&lt;/<span class="name">hardwareInterface</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">mechanicalReduction</span>&gt;</span>1<span class="tag">&lt;/<span class="name">mechanicalReduction</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">actuator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transmission</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xacro:macro</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- BASE-FOOTPRINT --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- base_footprint is a fictitious link(frame) that is on the ground right below base_link origin --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xacro:macro</span> <span class="attr">name</span>=<span class="string">&quot;trobot_body&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">name</span>=<span class="string">&quot;base_footprint&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">visual</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">origin</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 0&quot;</span> <span class="attr">rpy</span>=<span class="string">&quot;0 0 0&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">geometry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">box</span> <span class="attr">size</span>=<span class="string">&quot;0.001 0.001 0.001&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">visual</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">joint</span> <span class="attr">name</span>=<span class="string">&quot;base_footprint_joint&quot;</span> <span class="attr">type</span>=<span class="string">&quot;fixed&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">origin</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 $&#123;wheel_radius&#125;&quot;</span> <span class="attr">rpy</span>=<span class="string">&quot;0 0 0&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">parent</span> <span class="attr">link</span>=<span class="string">&quot;base_footprint&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">child</span> <span class="attr">link</span>=<span class="string">&quot;base_link&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">joint</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- BASE-LINK --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Actual body/chassis of the robot--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">name</span>=<span class="string">&quot;base_link&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">box_inertial_matrix</span>  <span class="attr">m</span>=<span class="string">&quot;$&#123;basebox_mass&#125;&quot;</span> <span class="attr">d</span>=<span class="string">&quot;$&#123;basebox_length&#125;&quot;</span> <span class="attr">w</span>=<span class="string">&quot;$&#123;basebox_width&#125;&quot;</span> <span class="attr">h</span>=<span class="string">&quot;$&#123;basebox_height&#125;&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">visual</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">origin</span> <span class="attr">xyz</span>=<span class="string">&quot; 0 0 0&quot;</span> <span class="attr">rpy</span>=<span class="string">&quot;0 0 0&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">geometry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">box</span> <span class="attr">size</span>=<span class="string">&quot;$&#123;basebox_length&#125; $&#123;basebox_width&#125; $&#123;basebox_height&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;blue&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;0 .5 .8 1&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">material</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">visual</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">collision</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">origin</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 0&quot;</span> <span class="attr">rpy</span>=<span class="string">&quot;0 0 0&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">geometry</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">box</span> <span class="attr">size</span>=<span class="string">&quot;$&#123;basebox_length&#125; $&#123;basebox_width&#125; $&#123;basebox_height&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">collision</span>&gt;</span>   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gazebo</span> <span class="attr">reference</span>=<span class="string">&quot;base_link&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">material</span>&gt;</span>Gazebo/Blue<span class="tag">&lt;/<span class="name">material</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">gazebo</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Wheel Definitions --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">wheel</span> <span class="attr">lr</span>=<span class="string">&quot;right_front&quot;</span>  <span class="attr">translateX</span>=<span class="string">&quot;1&quot;</span> <span class="attr">translateY</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">motor_direction</span>=<span class="string">&quot;0&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">wheel</span> <span class="attr">lr</span>=<span class="string">&quot;left_front&quot;</span>   <span class="attr">translateX</span>=<span class="string">&quot;1&quot;</span> <span class="attr">translateY</span>=<span class="string">&quot;1&quot;</span> <span class="attr">motor_direction</span>=<span class="string">&quot;-1.5707&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">wheel</span> <span class="attr">lr</span>=<span class="string">&quot;right_back&quot;</span>   <span class="attr">translateX</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">translateY</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">motor_direction</span>=<span class="string">&quot;0&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">wheel</span> <span class="attr">lr</span>=<span class="string">&quot;left_back&quot;</span>    <span class="attr">translateX</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">translateY</span>=<span class="string">&quot;1&quot;</span> <span class="attr">motor_direction</span>=<span class="string">&quot;-1.5707&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- controller --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gazebo</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>=<span class="string">&quot;skid_steer_drive_controller&quot;</span> <span class="attr">filename</span>=<span class="string">&quot;libgazebo_ros_skid_steer_drive.so&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">alwaysOn</span>&gt;</span>true<span class="tag">&lt;/<span class="name">alwaysOn</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">updateRate</span>&gt;</span>100.0<span class="tag">&lt;/<span class="name">updateRate</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">robotNamespace</span>&gt;</span>/<span class="tag">&lt;/<span class="name">robotNamespace</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">leftFrontJoint</span>&gt;</span>base_to_wheel_left_front_joint<span class="tag">&lt;/<span class="name">leftFrontJoint</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">rightFrontJoint</span>&gt;</span>base_to_wheel_right_front_joint<span class="tag">&lt;/<span class="name">rightFrontJoint</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">leftRearJoint</span>&gt;</span>base_to_wheel_left_back_joint<span class="tag">&lt;/<span class="name">leftRearJoint</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">rightRearJoint</span>&gt;</span>base_to_wheel_right_back_joint<span class="tag">&lt;/<span class="name">rightRearJoint</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">wheelSeparation</span>&gt;</span>$&#123;motor_y*2&#125;<span class="tag">&lt;/<span class="name">wheelSeparation</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">wheelDiameter</span>&gt;</span>$&#123;2*wheel_radius&#125;<span class="tag">&lt;/<span class="name">wheelDiameter</span>&gt;</span>              </span><br><span class="line">                <span class="tag">&lt;<span class="name">robotBaseFrame</span>&gt;</span>base_footprint<span class="tag">&lt;/<span class="name">robotBaseFrame</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">torque</span>&gt;</span>20<span class="tag">&lt;/<span class="name">torque</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">commandTopic</span>&gt;</span>cmd_vel<span class="tag">&lt;/<span class="name">commandTopic</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">odometryTopic</span>&gt;</span>odom<span class="tag">&lt;/<span class="name">odometryTopic</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">odometryFrame</span>&gt;</span>odom<span class="tag">&lt;/<span class="name">odometryFrame</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">broadcastTF</span>&gt;</span>1<span class="tag">&lt;/<span class="name">broadcastTF</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">gazebo</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">xacro:macro</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">robot</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>新建<code>robot_simulation/xacro/trobot.xacro</code>文件，内容如下：</li></ul><figure class="highlight xml"><figcaption><span>trobot.xacro</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">robot</span> <span class="attr">name</span>=<span class="string">&quot;trobot&quot;</span> <span class="attr">xmlns:xacro</span>=<span class="string">&quot;http://www.ros.org/wiki/xacro&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">xacro:include</span> <span class="attr">filename</span>=<span class="string">&quot;$(find robot_simulation)/xacro/trobot_base.urdf.xacro&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Body of mrobot, with plates, standoffs --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">trobot_body</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">robot</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h3 id="1-2-创建launch文件"><a href="#1-2-创建launch文件" class="headerlink" title="1.2 创建launch文件"></a>1.2 创建launch文件</h3><ul><li>新建<code>robot_simulation/launch/trobot_display_xacro.launch</code>文件，内容如下：</li></ul><figure class="highlight xml"><figcaption><span>trobot_display_xacro.launch</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">arg</span> <span class="attr">name</span>=<span class="string">&quot;model&quot;</span> <span class="attr">default</span>=<span class="string">&quot;$(find xacro)/xacro --inorder &#x27;$(find robot_simulation)/xacro/trobot.xacro&#x27;&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;robot_description&quot;</span> <span class="attr">command</span>=<span class="string">&quot;$(arg model)&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 运行joint_state_publisher_gui节点，发布机器人的关节状态  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;joint_state_publisher_gui&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;joint_state_publisher_gui&quot;</span> <span class="attr">type</span>=<span class="string">&quot;joint_state_publisher_gui&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 运行robot_state_publisher节点，发布tf,将机器人的连杆关节之间的关系，通过TF的形式，整理成三维姿态发布出去  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;robot_state_publisher&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;robot_state_publisher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;state_publisher&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;rviz&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;rviz&quot;</span> <span class="attr">type</span>=<span class="string">&quot;rviz&quot;</span> <span class="attr">args</span>=<span class="string">&quot;-d $(find robot_simulation)/rviz/trobot_xacro.rviz&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-Rviz中显示"><a href="#2-Rviz中显示" class="headerlink" title="2. Rviz中显示"></a>2. Rviz中显示</h2><h3 id="2-1-显示机器人模型"><a href="#2-1-显示机器人模型" class="headerlink" title="2.1 显示机器人模型"></a>2.1 显示机器人模型</h3><p>编译功能包（略），并运行launch文件</p><pre><code>$ roslaunch robot_simulation trobot_display_urdf.launch </code></pre><center><img src="https://xiaoxiaotaoya-1257031621.cos.ap-nanjing.myqcloud.com/2-%E4%BB%BF%E7%9C%9F/xacro/rviz_tf.PNG" height="600"></center><h3 id="2-2-Arbotix仿真"><a href="#2-2-Arbotix仿真" class="headerlink" title="2.2 Arbotix仿真"></a>2.2 Arbotix仿真</h3><ul><li>新建<code>robot_simulation/config/trobot_arbotix.yaml</code>文件，内容如下：</li></ul><figure class="highlight xml"><figcaption><span>trobot_arbotix.yaml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">port: /dev/ttyUSB0</span><br><span class="line">baud: 115200</span><br><span class="line">rate: 20</span><br><span class="line">sync_write: True</span><br><span class="line">sync_read: True</span><br><span class="line">read_rate: 20</span><br><span class="line">write_rate: 20</span><br><span class="line"></span><br><span class="line">controllers: &#123;</span><br><span class="line">   #  Pololu motors: 1856 cpr = 0.3888105m travel = 4773 ticks per meter (empirical: 4100)</span><br><span class="line">   base_controller: &#123;type: diff_controller, base_frame_id: base_link, base_width: 0.26, ticks_meter: 4100, Kp: 12, Kd: 12, Ki: 0, Ko: 50, accel_limit: 1.0 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>新建<code>robot_simulation/launch/trobot_display_xacro_arbotix.launch</code>文件，内容如下：</li></ul><figure class="highlight xml"><figcaption><span>trobot_display_xacro_arbotix.launch</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;/use_sim_time&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span>  </span><br><span class="line">    <span class="comment">&lt;!-- Load the URDF/Xacro model of our robot --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">arg</span> <span class="attr">name</span>=<span class="string">&quot;urdf_file&quot;</span> <span class="attr">default</span>=<span class="string">&quot;$(find xacro)/xacro.py &#x27;$(find robot_simulation)/xacro/trobot.xacro&#x27;&quot;</span> /&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">arg</span> <span class="attr">name</span>=<span class="string">&quot;gui&quot;</span> <span class="attr">default</span>=<span class="string">&quot;false&quot;</span> /&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;robot_description&quot;</span> <span class="attr">command</span>=<span class="string">&quot;$(arg urdf_file)&quot;</span> /&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;use_gui&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$(arg gui)&quot;</span>/&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;arbotix&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;arbotix_python&quot;</span> <span class="attr">type</span>=<span class="string">&quot;arbotix_driver&quot;</span> <span class="attr">output</span>=<span class="string">&quot;screen&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">rosparam</span> <span class="attr">file</span>=<span class="string">&quot;$(find robot_simulation)/config/trobot_arbotix.yaml&quot;</span> <span class="attr">command</span>=<span class="string">&quot;load&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;sim&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">node</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;joint_state_publisher&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;joint_state_publisher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;joint_state_publisher&quot;</span> /&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;robot_state_publisher&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;robot_state_publisher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;state_publisher&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;publish_frequency&quot;</span> <span class="attr">type</span>=<span class="string">&quot;double&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20.0&quot;</span> /&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">node</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">&lt;!-- We need a static transforms for the wheels --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;tf&quot;</span> <span class="attr">type</span>=<span class="string">&quot;static_transform_publisher&quot;</span> <span class="attr">name</span>=<span class="string">&quot;odom_left_wheel_broadcaster&quot;</span> <span class="attr">args</span>=<span class="string">&quot;0 0 0 0 0 0 /base_link /left_front_link 100&quot;</span> /&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;tf&quot;</span> <span class="attr">type</span>=<span class="string">&quot;static_transform_publisher&quot;</span> <span class="attr">name</span>=<span class="string">&quot;odom_right_wheel_broadcaster&quot;</span> <span class="attr">args</span>=<span class="string">&quot;0 0 0 0 0 0 /base_link /right_front_link 100&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;rviz&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;rviz&quot;</span> <span class="attr">type</span>=<span class="string">&quot;rviz&quot;</span> <span class="attr">args</span>=<span class="string">&quot;-d $(find robot_simulation)/rviz/trobot_xacro_arbotix.rviz&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure><p>编译功能包（略），并运行launch文件</p><pre><code>$ roslaunch robot_simion trobot_display_xacro_arbotix.launch $ rostopic pub -r 10 /cmd_vel geometry_msgs/Twist &#39;&#123;linear: &#123;x: 0.1, y: 0, z: 0&#125;, angular: &#123;x: 0, y: 0, z: 0.5&#125;&#125;&#39;</code></pre><center><img src="https://xiaoxiaotaoya-1257031621.cos.ap-nanjing.myqcloud.com/2-%E4%BB%BF%E7%9C%9F/xacro/rviz_odom.PNG" height="600"></center><p><strong>查看话题：</strong></p><pre><code>tao@ubuntu:~$ rostopic list/clicked_point/cmd_vel/diagnostics/initialpose/joint_states/move_base_simple/goal/odom/rosout/rosout_agg/tf/tf_static</code></pre>]]></content>
      
      
      <categories>
          
          <category> ROS机器人仿真 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS机器人 </tag>
            
            <tag> 3D建模与仿真 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS机器人仿真1-URDF格式</title>
      <link href="/2020/09/09/ROS%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%BB%BF%E7%9C%9F1-URDF%E6%A0%BC%E5%BC%8F/"/>
      <url>/2020/09/09/ROS%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%BB%BF%E7%9C%9F1-URDF%E6%A0%BC%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;ROS中自带一些仿真软件，可以快速提高开发效率。例如，简单的二维机器人仿真器STDR/stage; 强大的三维仿真环境Gazebo; 基于可视化工具的Rviz的机器人仿真Arbotix; 第三方仿真软件V-rep、Matlab-ros等等。<br>&emsp;&emsp;机器人模型创建有很多方法，如手动编写urdf或xacro格式描述机器人; 通过SkethUp或Solidworks（需要插件<a href="https://github.com/ros/solidworks_urdf_exporter/releases">sw2urdfSetup.exe</a><br>）等三维仿真软件导出机器人模型。当然，也要配置相应坐标、材料等参数。<br>&emsp;&emsp;本章主要通过URDF创建一个简单的机器人模型。</p><blockquote><p><strong>运行环境：</strong></p><ul><li>虚拟机 VMware15.1</li><li>Ubuntu 16.04</li><li>ROS kinect</li></ul></blockquote><h2 id="1-创建机器人仿真功能包-robot-simulation"><a href="#1-创建机器人仿真功能包-robot-simulation" class="headerlink" title="1. 创建机器人仿真功能包 robot_simulation"></a>1. 创建机器人仿真功能包 robot_simulation</h2><pre><code>$ catkin_create_pkg robot_simulation roscpp rospy std_msgs urdf   gazebo_plugins gazebo_ros gazebo_ros_control</code></pre><h3 id="1-1-创建URDF机器人模型"><a href="#1-1-创建URDF机器人模型" class="headerlink" title="1.1 创建URDF机器人模型"></a>1.1 创建URDF机器人模型</h3><p>&emsp;&emsp;机器人模型如下：</p><p><img src="https://xiaoxiaotaoya-1257031621.cos.ap-nanjing.myqcloud.com/2-%E4%BB%BF%E7%9C%9F/urdf/robot_model.png"></p><p>&emsp;&emsp;新建<code>robot_simulation/urdf/trobot.urdf</code>文件，内容如下：</p><figure class="highlight xml"><figcaption><span>trobot.urdf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">robot</span> <span class="attr">name</span>=<span class="string">&quot;trobot&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">name</span>=<span class="string">&quot;base_link&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">visual</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">geometry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">box</span> <span class="attr">size</span>=<span class="string">&quot;0.25 .16 .05&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">origin</span> <span class="attr">rpy</span>=<span class="string">&quot;0 0 1.57075&quot;</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 0&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;blue&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;0 .5 .8 1&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">material</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">visual</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">name</span>=<span class="string">&quot;right_front_wheel&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">visual</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">cylinder</span> <span class="attr">length</span>=<span class="string">&quot;.02&quot;</span> <span class="attr">radius</span>=<span class="string">&quot;0.025&quot;</span>/&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;black&quot;</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;0 0 0 1&quot;</span>/&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;/<span class="name">material</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">visual</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">link</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">joint</span> <span class="attr">name</span>=<span class="string">&quot;right_front_wheel_joint&quot;</span> <span class="attr">type</span>=<span class="string">&quot;continuous&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">axis</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 1&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">parent</span> <span class="attr">link</span>=<span class="string">&quot;base_link&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">child</span> <span class="attr">link</span>=<span class="string">&quot;right_front_wheel&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">origin</span> <span class="attr">rpy</span>=<span class="string">&quot;0 1.57075 0&quot;</span> <span class="attr">xyz</span>=<span class="string">&quot;0.08 0.1 -0.03&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">limit</span> <span class="attr">effort</span>=<span class="string">&quot;100&quot;</span> <span class="attr">velocity</span>=<span class="string">&quot;100&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">joint_properties</span> <span class="attr">damping</span>=<span class="string">&quot;0.0&quot;</span> <span class="attr">friction</span>=<span class="string">&quot;0.0&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">joint</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">name</span>=<span class="string">&quot;right_back_wheel&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">visual</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">cylinder</span> <span class="attr">length</span>=<span class="string">&quot;.02&quot;</span> <span class="attr">radius</span>=<span class="string">&quot;0.025&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;black&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;0 0 0 1&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">material</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">visual</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">link</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">joint</span> <span class="attr">name</span>=<span class="string">&quot;right_back_wheel_joint&quot;</span> <span class="attr">type</span>=<span class="string">&quot;continuous&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">axis</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 1&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">parent</span> <span class="attr">link</span>=<span class="string">&quot;base_link&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">child</span> <span class="attr">link</span>=<span class="string">&quot;right_back_wheel&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">origin</span> <span class="attr">rpy</span>=<span class="string">&quot;0 1.57075 0&quot;</span> <span class="attr">xyz</span>=<span class="string">&quot;0.08 -0.1 -0.03&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">limit</span> <span class="attr">effort</span>=<span class="string">&quot;100&quot;</span> <span class="attr">velocity</span>=<span class="string">&quot;100&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">joint_properties</span> <span class="attr">damping</span>=<span class="string">&quot;0.0&quot;</span> <span class="attr">friction</span>=<span class="string">&quot;0.0&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">joint</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">name</span>=<span class="string">&quot;left_front_wheel&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">visual</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">cylinder</span> <span class="attr">length</span>=<span class="string">&quot;.02&quot;</span> <span class="attr">radius</span>=<span class="string">&quot;0.025&quot;</span>/&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;black&quot;</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;0 0 0 1&quot;</span>/&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;/<span class="name">material</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">visual</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">link</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">joint</span> <span class="attr">name</span>=<span class="string">&quot;left_front_wheel_joint&quot;</span> <span class="attr">type</span>=<span class="string">&quot;continuous&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">axis</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 1&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">parent</span> <span class="attr">link</span>=<span class="string">&quot;base_link&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">child</span> <span class="attr">link</span>=<span class="string">&quot;left_front_wheel&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">origin</span> <span class="attr">rpy</span>=<span class="string">&quot;0 1.57075 0&quot;</span> <span class="attr">xyz</span>=<span class="string">&quot;-0.08 0.1 -0.03&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">limit</span> <span class="attr">effort</span>=<span class="string">&quot;100&quot;</span> <span class="attr">velocity</span>=<span class="string">&quot;100&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">joint_properties</span> <span class="attr">damping</span>=<span class="string">&quot;0.0&quot;</span> <span class="attr">friction</span>=<span class="string">&quot;0.0&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">joint</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">name</span>=<span class="string">&quot;left_back_wheel&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">visual</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">cylinder</span> <span class="attr">length</span>=<span class="string">&quot;.02&quot;</span> <span class="attr">radius</span>=<span class="string">&quot;0.025&quot;</span>/&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;black&quot;</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;0 0 0 1&quot;</span>/&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;/<span class="name">material</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">visual</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">link</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">joint</span> <span class="attr">name</span>=<span class="string">&quot;left_back_wheel_joint&quot;</span> <span class="attr">type</span>=<span class="string">&quot;continuous&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">axis</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0 1&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">parent</span> <span class="attr">link</span>=<span class="string">&quot;base_link&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">child</span> <span class="attr">link</span>=<span class="string">&quot;left_back_wheel&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">origin</span> <span class="attr">rpy</span>=<span class="string">&quot;0 1.57075 0&quot;</span> <span class="attr">xyz</span>=<span class="string">&quot;-0.08 -0.1 -0.03&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">limit</span> <span class="attr">effort</span>=<span class="string">&quot;100&quot;</span> <span class="attr">velocity</span>=<span class="string">&quot;100&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">joint_properties</span> <span class="attr">damping</span>=<span class="string">&quot;0.0&quot;</span> <span class="attr">friction</span>=<span class="string">&quot;0.0&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">joint</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">name</span>=<span class="string">&quot;head&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">visual</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">box</span> <span class="attr">size</span>=<span class="string">&quot;.02 .03 .03&quot;</span>/&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;/<span class="name">geometry</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">material</span> <span class="attr">name</span>=<span class="string">&quot;white&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">color</span> <span class="attr">rgba</span>=<span class="string">&quot;1 1 1 1&quot;</span>/&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;/<span class="name">material</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">visual</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">link</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">joint</span> <span class="attr">name</span>=<span class="string">&quot;tobox&quot;</span> <span class="attr">type</span>=<span class="string">&quot;fixed&quot;</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">parent</span> <span class="attr">link</span>=<span class="string">&quot;base_link&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">child</span> <span class="attr">link</span>=<span class="string">&quot;head&quot;</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">origin</span> <span class="attr">xyz</span>=<span class="string">&quot;0 0.08 0.025&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">joint</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">robot</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="1-2-urdf解释"><a href="#1-2-urdf解释" class="headerlink" title="1.2 urdf解释"></a>1.2 urdf解释</h3><p>&emsp;&emsp;从上述代码可以看到机器人需要配置尺寸、关节等属性。 一般, 机器人都是由<a href="http://wiki.ros.org/urdf/XML/link">link</a>和<a href="http://wiki.ros.org/urdf/XML/joint">joint</a>进行描述。两者关系可参考官网教程，如下图所示：</p><img src="https://xiaoxiaotaoya-1257031621.cos.ap-nanjing.myqcloud.com/2-%E4%BB%BF%E7%9C%9F/urdf/link.jpg" width="400"><p>&emsp;&emsp;上图共有4个link和三个joint,link之间通过joint连接。link和joint属性不同，如下定义一个名为base_link的link：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;link name&#x3D;&quot;base_link&quot;&gt;</span><br><span class="line">    &lt;visual&gt;</span><br><span class="line">        &lt;geometry&gt;</span><br><span class="line">            &lt;box size&#x3D;&quot;0.25 .16 .05&quot;&#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;geometry&gt;</span><br><span class="line">        &lt;origin rpy&#x3D;&quot;0 0 1.57075&quot; xyz&#x3D;&quot;0 0 0&quot;&#x2F;&gt;</span><br><span class="line">        &lt;material name&#x3D;&quot;blue&quot;&gt;</span><br><span class="line">            &lt;color rgba&#x3D;&quot;0 .5 .8 1&quot;&#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;material&gt;</span><br><span class="line">    &lt;&#x2F;visual&gt;</span><br><span class="line">&lt;&#x2F;link&gt;</span><br></pre></td></tr></table></figure><p><strong>说明：</strong></p><ul><li><code>&lt;visual&gt;</code>    描述一个link的外观，大小，颜色，材质纹理等;<ul><li><code>&lt;geometry&gt;</code> 定义该link的几何模型，包含该几何模型的尺寸，单位：米；<ul><li><code>&lt;box&gt;</code> 长方体 size：长 宽 高 原点在中心位置；</li><li><code>&lt;cylinder&gt;</code>  圆柱体 length：长 radius：半径 原点在中心位置；</li><li><code>&lt;sphere&gt;</code>  球体，radius：半径  原点在中心位置；</li></ul></li><li><code>&lt;material&gt;</code>  定义颜色和透明度（RGBA），取值区间 [0,1] ；</li><li><code>&lt;origin&gt;</code> 用来描述模块的位置；<ul><li><code>xyz</code> 表示固定轴的坐标，单位：米；</li><li><code>rpy</code> 表示固定轴的横滚角，俯仰角和偏航角，单位：弧度；</li></ul></li><li><code>&lt;inertial&gt;</code> 定义惯性；</li><li><code>&lt;collision&gt;</code> 描述碰撞检测属性；</li></ul></li></ul><p>&emsp;&emsp;同样，如下定义一个名为left_back_wheel_joint的joint,主要用于连接父link:base_link和子link:left_back_wheel。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;joint name&#x3D;&quot;left_back_wheel_joint&quot; type&#x3D;&quot;continuous&quot;&gt;  </span><br><span class="line">    &lt;axis xyz&#x3D;&quot;0 0 1&quot;&#x2F;&gt;  </span><br><span class="line">    &lt;parent link&#x3D;&quot;base_link&quot;&#x2F;&gt;  </span><br><span class="line">    &lt;child link&#x3D;&quot;left_back_wheel&quot;&#x2F;&gt;  </span><br><span class="line">    &lt;origin rpy&#x3D;&quot;0 1.57075 0&quot; xyz&#x3D;&quot;-0.08 -0.1 -0.03&quot;&#x2F;&gt;  </span><br><span class="line">    &lt;limit effort&#x3D;&quot;100&quot; velocity&#x3D;&quot;100&quot;&#x2F;&gt;  </span><br><span class="line">    &lt;joint_properties damping&#x3D;&quot;0.0&quot; friction&#x3D;&quot;0.0&quot;&#x2F;&gt;  </span><br><span class="line">&lt;&#x2F;joint&gt;  </span><br></pre></td></tr></table></figure><p><strong>说明：</strong></p><ul><li><code>type</code> joint类型（revolute、continuous、prismatic、fixed、floating、planar）<ul><li><code>continuous</code> 绕轴旋转的连续铰链接头，没有上限和下限。</li><li><code>fixed</code> 所有自由度均被锁定，无法移动。</li></ul></li><li><code>&lt;axis&gt;</code> 旋转关节（revolute、continuous）的旋转轴，棱柱形关节（prismatic）的平移轴，平面关节（planar）的表面法线。</li><li><code>&lt;limit&gt;</code> 安全限制（仅对于旋转和棱柱形关节需要） effort：作用力  velocity：速度</li></ul><h3 id="1-3-查看坐标系"><a href="#1-3-查看坐标系" class="headerlink" title="1.3 查看坐标系"></a>1.3 查看坐标系</h3><p>&emsp;&emsp;可使用命令</p><pre><code>$ check_urdf trobot.urdf  检查语法配置是否有误$ urdf_to_graphiz trobot.urdf    图形化工具tao@ubuntu:~/robot_simulation/src/robot_simulation/urdf$ check_urdf trobot.urdf robot name is: trobot---------- Successfully Parsed XML ---------------root Link: base_link has 5 child(ren)    child(1):  left_back_wheel    child(2):  left_front_wheel    child(3):  right_back_wheel    child(4):  right_front_wheel    child(5):  headtao@ubuntu:~/robot_simulation/src/robot_simulation/urdf$ urdf_to_graphiz trobot.urdf Created file trobot.gvCreated file trobot.pdf</code></pre><center><img src="https://xiaoxiaotaoya-1257031621.cos.ap-nanjing.myqcloud.com/2-%E4%BB%BF%E7%9C%9F/urdf/urdf_tf.PNG" height="300">trobot.pdf</center><h2 id="2-Rviz显示"><a href="#2-Rviz显示" class="headerlink" title="2. Rviz显示"></a>2. Rviz显示</h2><p>&emsp;&emsp;新建<code>robot_simulation/launch/trobot_display_urdf.launch</code>文件，内容如下：</p><figure class="highlight xml"><figcaption><span>trobot_display_urdf.launch</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">arg</span> <span class="attr">name</span>=<span class="string">&quot;model&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">arg</span> <span class="attr">name</span>=<span class="string">&quot;gui&quot;</span> <span class="attr">default</span>=<span class="string">&quot;True&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;robot_description&quot;</span> <span class="attr">textfile</span>=<span class="string">&quot;$(find robot_simulation)/urdf/trobot.urdf&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;use_gui&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$(arg gui)&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;joint_state_publisher&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;joint_state_publisher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;joint_state_publisher&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">node</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;robot_state_publisher&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;robot_state_publisher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;state_publisher&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;rviz&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;rviz&quot;</span> <span class="attr">type</span>=<span class="string">&quot;rviz&quot;</span> <span class="attr">args</span>=<span class="string">&quot;-d $(find robot_simulation)/rviz/trobot_urdf.rviz&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure><p>编译功能包（略），并运行launch文件</p><pre><code>$ roslaunch robot_simulation trobot_display_urdf.launch </code></pre><center><img src="https://xiaoxiaotaoya-1257031621.cos.ap-nanjing.myqcloud.com/2-%E4%BB%BF%E7%9C%9F/urdf/urdf_rviz.PNG" height="600"></center><blockquote><p>注：RVIZ中坐标轴 红色为x轴，绿色为y轴，蓝色为z轴</p></blockquote><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="http://wiki.ros.org/urdf/XML">http://wiki.ros.org/urdf/XML</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS机器人仿真 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS机器人 </tag>
            
            <tag> 3D建模与仿真 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>古文章-故事集1</title>
      <link href="/2020/09/02/%E5%8F%A4%E6%96%87%E7%AB%A0-%E6%95%85%E4%BA%8B%E9%9B%861/"/>
      <url>/2020/09/02/%E5%8F%A4%E6%96%87%E7%AB%A0-%E6%95%85%E4%BA%8B%E9%9B%861/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>12345</p><a id="more"></a><h2 id="核舟记"><a href="#核舟记" class="headerlink" title="核舟记"></a>核舟记</h2><blockquote><p>&emsp;&emsp;明有奇巧人曰王叔远，能以径寸之木，为宫室、器皿 、人物，以至鸟兽、木石，罔不因势象形，各具情态。尝贻余核舟一，盖大苏泛赤壁云。<br>&emsp;&emsp;舟首尾长约八分有奇，高可二黍许。中轩敞者为舱，箬篷覆之。旁开小窗，左右各四，共八扇。启窗而观，雕栏相望焉。闭之，则右刻“山高月小，水落石出”，左刻“清风徐来，水波不兴”，石青糁之。<br>&emsp;&emsp;船头坐三人，中峨冠而多髯者为东坡，佛印居右，鲁直居左。苏、黄共阅一手卷。东坡右手执卷端，左手抚鲁直背。鲁直左手执卷末，右手指卷，如有所语。东坡现右足，鲁直现左足，各微侧，其两膝相比者，各隐卷底衣褶中。佛印绝类弥勒，袒胸露乳，矫首昂视，神情与苏、黄不属。卧右膝，诎右臂支船，而竖其左膝，左臂挂念珠倚之——珠可历历数也。<br>&emsp;&emsp;舟尾横卧一楫。楫左右舟子各一人。居右者椎髻仰面，左手倚一衡木，右手攀右趾，若啸呼状。居左者右手执蒲葵扇，左手抚炉，炉上有壶，其人视端容寂，若听茶声然。<br>&emsp;&emsp;其船背稍夷，则题名其上，文曰“天启壬戌秋日，虞山王毅叔远甫刻”，细若蚊足，钩画了了，其色墨。又用篆章一，文曰“初平山人”，其色丹。<br>&emsp;&emsp;通计一舟，为人五；为窗八；为箬篷，为楫，为炉，为壶，为手卷，为念珠各一；对联、题名并篆文，为字共三十有四；而计其长曾不盈寸。盖简桃核修狭者为之。嘻，技亦灵怪矣哉！</p></blockquote><h2 id="口技"><a href="#口技" class="headerlink" title="口技"></a>口技</h2><blockquote><p>&emsp;&emsp;京中有善口技者。会宾客大宴，于厅事之东北角，施八尺屏障，口技人坐屏障中，一桌、一椅、一扇、一抚尺而已。众宾团坐。少顷，但闻屏障中抚尺一下，满坐寂然，无敢哗者。<br>&emsp;&emsp;遥闻深巷中犬吠，便有妇人惊觉欠伸，摇其夫语猥亵事。初不甚应，妇摇之不止，则二人语渐间杂，床又从中戛戛。夫呓语。既而儿醒，大啼，夫令妇儿乳，儿含乳啼，妇拍而呜之。夫起溺，妇亦抱儿起溺。床上又一大儿醒，絮絮不止。当是时，妇手拍儿声，口中呜声，儿含乳啼声，大儿初醒声，床声，夫叱大儿声，溺桶中声，一齐奏发，众妙毕备。满堂宾客，无不伸颈侧目，微笑默叹，以为妙绝也<br>&emsp;&emsp;既而夫上床寝，妇又呼大儿溺，毕，都上床寝。小儿亦渐欲睡。夫茀声起，妇拍儿亦渐拍渐止。微闻有鼠作作索索，盆器倾侧，妇梦中咳嗽之声。宾客意少舒，稍稍正坐。<br>&emsp;&emsp;忽一人大呼“火起”，夫起大呼，妇亦起大呼。两儿齐哭。俄而百千人大呼，百千儿哭，百千犬吠。中间力拉崩倒之声，火爆声，呼呼风声，百千齐作；又夹百千求救声，曳屋许许声，抢夺声，泼水声。凡所应有，无所不有。虽人有百手，手有百指，不能指其一端；人有百口，口有百舌，不能名其一处也。于是宾客无不变色离席，奋袖出臂，两股战战，几欲先走。<br>&emsp;&emsp;忽然抚尺一下，群响毕绝。撤屏视之，一人、一桌、一椅、一扇、一抚尺而已。</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>实习项目经验总结4：LINUX系统下的C++线程使用</title>
      <link href="/2020/05/24/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%934%EF%BC%9ALINUX%E7%B3%BB%E7%BB%9F%E4%B8%8B%E7%9A%84C++%E7%BA%BF%E7%A8%8B%E4%BD%BF%E7%94%A8/"/>
      <url>/2020/05/24/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%934%EF%BC%9ALINUX%E7%B3%BB%E7%BB%9F%E4%B8%8B%E7%9A%84C++%E7%BA%BF%E7%A8%8B%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;记录LINUX系统下的C++线程使用，不涉及保密项目。</p><p>&emsp;&emsp;c++ 11 之后有了标准的线程库：<code>std::thread</code>。但在LINUX下<code>pthread</code>使用的多一点,因此本文主要学习<code>pthread</code>的一些用法。</p><ul><li><a href="https://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread.h.html">&lt;pthread.h&gt;</a></li></ul><a id="more"></a><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>线程基本概念待续。。。。</p><h2 id="线程的基本使用"><a href="#线程的基本使用" class="headerlink" title="线程的基本使用"></a>线程的基本使用</h2><h3 id="线程的创建与退出"><a href="#线程的创建与退出" class="headerlink" title="线程的创建与退出"></a>线程的创建与退出</h3><ul><li>线程的创建 <a href="https://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_create.html">pthread_create</a></li></ul><pre><code>函数原型：int pthread_create(pthread_t *thread, const pthread_attr_t *attr,void *(*start_routine)(void*), void *arg);--- thread: 线程标识符，即线程ID，标识唯一线程；--- attr    : 一个不透明的属性对象，可以被用来设置线程属性。您可以指定线程属性对象，也可以使用默认值 NULL；--- start_routine: 线程运行函数起始地址，一旦线程被创建就会执行；--- arg: 运行函数的参数。它必须通过把引用作为指针强制转换为 void 类型进行传递。如果没有传递参数，则使用 NULL；--- 创建成功，返回0；失败，则返回错误号。</code></pre><ul><li>线程的退出 <a href="https://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_exit.html">pthread_exit</a></li></ul><pre><code>函数原型：void pthread_exit(void *value_ptr);--- 没有返回值。最后一个线程终止后，该进程以状态0退出；</code></pre><figure class="highlight c++"><figcaption><span>pthread_study1.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Author: xiaoxiaotaoya</span></span><br><span class="line"><span class="comment">* Data: 2020-05-23</span></span><br><span class="line"><span class="comment">* 内容：学习线程的创建和退出，以及数组的参数传递。</span></span><br><span class="line"><span class="comment">* tao@ubuntu:~/Desktop/study/thread c++$ g++ pthread_study1.cpp -lpthread -o pthread_study1.o</span></span><br><span class="line"><span class="comment">* tao@ubuntu:~/Desktop/study/thread c++$ ./pthread_study1.o </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NUM_THREADS 5   <span class="comment">//定义线程数量</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//线程函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> *<span class="title">PrintHello</span><span class="params">(<span class="keyword">void</span> *threadid)</span></span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">   <span class="comment">// 对传入的参数进行强制类型转换，由无类型指针变为整形数指针，然后再读取</span></span><br><span class="line">   <span class="keyword">int</span> tid = *((<span class="keyword">int</span>*)threadid);</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello Pthread！&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;当前线程 ID: &quot;</span> &lt;&lt; tid &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">pthread_t</span> threads[NUM_THREADS];</span><br><span class="line">   <span class="keyword">int</span> indexes[NUM_THREADS];<span class="comment">// 用数组来保存i的值</span></span><br><span class="line">   <span class="keyword">int</span> i, rec;</span><br><span class="line">   <span class="keyword">for</span>( i=<span class="number">0</span>; i &lt; NUM_THREADS; i++ )&#123;      </span><br><span class="line">      <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;创建线程：&quot;</span> &lt;&lt; i &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">      indexes[i] = i; <span class="comment">//先保存i的值</span></span><br><span class="line">      <span class="comment">// 传入的时候必须强制转换为void* 类型，即无类型指针        </span></span><br><span class="line">      rec = pthread_create(&amp;threads[i], <span class="literal">NULL</span>, PrintHello, (<span class="keyword">void</span> *)&amp;(indexes[i]));</span><br><span class="line">      <span class="keyword">if</span> (rec)&#123;</span><br><span class="line">         <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Error:无法创建线程,&quot;</span> &lt;&lt; rec &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">         <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   pthread_exit(<span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/c%2B%2B%20pthread/pthread1.PNG" width="600" hegiht="400" > pthread_study1 运行结果</center><figure class="highlight c++"><figcaption><span>pthread_study2.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Author: xiaoxiaotaoya</span></span><br><span class="line"><span class="comment">* Data: 2020-05-23</span></span><br><span class="line"><span class="comment">* 内容：学习结构的参数传递。</span></span><br><span class="line"><span class="comment">* tao@ubuntu:~/Desktop/study/thread c++$ g++ pthread_study2.cpp -lpthread -o pthread_study2.o</span></span><br><span class="line"><span class="comment">* tao@ubuntu:~/Desktop/study/thread c++$ ./pthread_study2.o </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NUM_THREADS 5   <span class="comment">//定义线程数量</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建结构体 thread_data</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">thread_data</span>&#123;</span></span><br><span class="line">   <span class="keyword">int</span>  thread_id;</span><br><span class="line">   <span class="keyword">char</span> *message;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//线程函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> *<span class="title">PrintHello</span><span class="params">(<span class="keyword">void</span> *threadarg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">thread_data</span> *<span class="title">my_data</span>;</span></span><br><span class="line">   my_data = (struct thread_data *) threadarg;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Thread ID : &quot;</span> &lt;&lt; my_data-&gt;thread_id &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Message : &quot;</span> &lt;&lt; my_data-&gt;message &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">   pthread_exit(<span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">pthread_t</span> threads[NUM_THREADS];</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">thread_data</span> <span class="title">td</span>[<span class="title">NUM_THREADS</span>];</span></span><br><span class="line">   <span class="keyword">int</span> i,rec;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">for</span>( i=<span class="number">0</span>; i &lt; NUM_THREADS; i++ )&#123;</span><br><span class="line">      <span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;main() : creating thread, &quot;</span> &lt;&lt; i &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">      td[i].thread_id = i;</span><br><span class="line">      td[i].message = (<span class="keyword">char</span>*)<span class="string">&quot;This is message&quot;</span>;</span><br><span class="line">      rec = pthread_create(&amp;threads[i], <span class="literal">NULL</span>, PrintHello, (<span class="keyword">void</span> *)&amp;td[i]);</span><br><span class="line">      <span class="keyword">if</span> (rec)&#123;</span><br><span class="line">         <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Error:unable to create thread,&quot;</span> &lt;&lt; rec &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">         <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   pthread_exit(<span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/c%2B%2B%20pthread/pthread2.PNG" width="600" hegiht="400" > pthread_study2 运行结果</center><h3 id="线程的阻塞与分离"><a href="#线程的阻塞与分离" class="headerlink" title="线程的阻塞与分离"></a>线程的阻塞与分离</h3><ul><li>线程的阻塞 <a href="https://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_join.html">pthread_join</a><br>功能：阻塞线程，当子线程任务执行完后，才能继续执行主线程任务；</li></ul><pre><code>函数原型：int pthread_join(pthread_t thread, void **value_ptr);--- thread: 线程标识符，即线程ID，标识唯一线程；--- value_ptr: 用户定义的指针，用来存储被等待线程的返回值；--- 创建成功，返回0；失败，则返回错误号。</code></pre><ul><li>线程的分离 <a href="https://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_detach.html">pthread_detach</a><br>功能：主线程与子线程分离，子线程结束后，资源自动回收。</li></ul><pre><code>函数原型：int pthread_detach(pthread_t thread);--- thread: 线程标识符，即线程ID，标识唯一线程；--- 创建成功，返回0；失败，则返回错误号。</code></pre><figure class="highlight c++"><figcaption><span>pthread_study3.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Author: xiaoxiaotaoya</span></span><br><span class="line"><span class="comment">* Data: 2020-05-23</span></span><br><span class="line"><span class="comment">* 内容：学习线程的阻塞与分离，以及整数的参数传递。</span></span><br><span class="line"><span class="comment">* tao@ubuntu:~/Desktop/study/thread c++$ g++ pthread_study3.cpp -lpthread -o pthread_study3.o</span></span><br><span class="line"><span class="comment">* tao@ubuntu:~/Desktop/study/thread c++$ ./pthread_study3.o </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;  //使用printf</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INDEX 3   <span class="comment">//定义线程数量</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//线程函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> *<span class="title">Thread_Run</span><span class="params">(<span class="keyword">void</span> *threadid)</span></span>&#123;</span><br><span class="line">    pthread_detach(pthread_self()); <span class="comment">//分离创建的子线程自己，该子线程终止时底层资源立即被回收</span></span><br><span class="line">    <span class="keyword">int</span> tid = *((<span class="keyword">int</span>*)threadid);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;当前线程 ID: &quot;</span> &lt;&lt; tid &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Current count is %d\n&quot;</span>,count);   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">pthread_t</span> ThreadID[INDEX];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i &lt; INDEX; i++ )&#123;</span><br><span class="line">        <span class="comment">//按顺序创建线程</span></span><br><span class="line">        pthread_create(&amp;ThreadID[i],<span class="literal">NULL</span>,Thread_Run,(<span class="keyword">void</span> *)&amp;(i));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;创建线程INDEX：%d\n&quot;</span>,i);</span><br><span class="line">        <span class="comment">//阻塞线程</span></span><br><span class="line">        <span class="keyword">int</span> rec = pthread_join(ThreadID[i],<span class="literal">NULL</span>);</span><br><span class="line">        <span class="keyword">if</span>(rec)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;线程阻塞失败！\n&quot;</span>);</span><br><span class="line">            <span class="built_in">abort</span>();</span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查看阻塞效果</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The count is: %d\n&quot;</span>,count);</span><br><span class="line">    pthread_exit(<span class="literal">NULL</span>); <span class="comment">//退出线程</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/c%2B%2B%20pthread/pthread3.PNG" width="600" hegiht="400" >pthread_study3 运行结果</center><p>&emsp;&emsp;可以看到线程阻塞后，按照子线程ID的顺序执行任务。当子线程任务执行完后，才开始执行主线程任务。</p><div class="note info">            <p>&emsp;&emsp;在默认情况下通过pthread_create函数创建的线程是非分离属性的，由pthread_create函数的第二个参数决定，在非分离的情况下，当一个线程结束的时候，它所占用的系统资源并没有完全真正的释放，也没有真正终止。只有在pthread_join函数返回时，该线程才会释放自己的资源。或者是设置在分离属性的情况下，一个线程结束会立即释放它所占用的资源。<br>&emsp;&emsp;通常是主线程使用pthread_create()创建子线程以后，一般可以调用<strong>pthread_detach(threadid)**分离刚刚创建的子线程，这里的threadid是指子线程的threadid；如此以来，该子线程止时底层资源立即被回收；被创建的子线程也可以自己分离自己，子线程调用</strong>pthread_detach(pthread_self())**就是分离自己，因为pthread_self()这个函数返回的就是自己本身的线程ID。</p>          </div><h2 id="线程执行的互斥和同步"><a href="#线程执行的互斥和同步" class="headerlink" title="线程执行的互斥和同步"></a>线程执行的互斥和同步</h2><p>未完待续</p><h2 id="信号量控制线程的执行顺序"><a href="#信号量控制线程的执行顺序" class="headerlink" title="信号量控制线程的执行顺序"></a>信号量控制线程的执行顺序</h2><p>未完待续</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://blog.csdn.net/Primeprime/article/details/79697083">C/C++ pthread_mutex_init等多线程函数的使用详解</a></li><li><a href="https://blog.csdn.net/weibo1230123/article/details/81410241?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase">linux中pthread_join()与pthread_detach()详解</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 实习项目 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Opencv学习2：指定图像读取</title>
      <link href="/2020/05/16/Opencv%E5%AD%A6%E4%B9%A02%EF%BC%9A%E5%9B%BE%E5%83%8F%E8%AF%BB%E5%8F%96/"/>
      <url>/2020/05/16/Opencv%E5%AD%A6%E4%B9%A02%EF%BC%9A%E5%9B%BE%E5%83%8F%E8%AF%BB%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;此次图像读取学习，所有程序都是在opencv_learning功能包下编译完成的。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/opencv%E5%AD%A6%E4%B9%A0/%E8%AF%BB%E5%8F%96%E6%8C%87%E5%AE%9A%E5%9B%BE%E7%89%87/1.jpg?imageView2/1/w/600/h/400" width="600" hegiht="460"></center><a id="more"></a><h2 id="创建功能包opencv-learning"><a href="#创建功能包opencv-learning" class="headerlink" title="创建功能包opencv_learning"></a>创建功能包opencv_learning</h2><h3 id="创建功能包"><a href="#创建功能包" class="headerlink" title="创建功能包"></a>创建功能包</h3><p>&emsp;&emsp;打开终端，创建功能包opencv_learning</p><pre><code>$ cs$ catkin_create_pkg opencv_learning std_msgs roscpp rospy cv_bridge image_transport sensor_msgs$ cm</code></pre><h3 id="添加OpenCV库"><a href="#添加OpenCV库" class="headerlink" title="添加OpenCV库"></a>添加OpenCV库</h3><p>&emsp;&emsp;修改功能包下CMakeLists.txt文件</p><figure class="highlight diff"><figcaption><span>CMakeLists.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">find_package(catkin REQUIRED COMPONENTS</span><br><span class="line"><span class="addition">+  OpenCV</span></span><br><span class="line">  cv_bridge</span><br><span class="line">  image_transport</span><br><span class="line">  sensor_msgs</span><br><span class="line">  std_msgs</span><br><span class="line">  roscpp</span><br><span class="line">  rospy</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">include_directories(</span><br><span class="line">  include $&#123;catkin_INCLUDE_DIRS&#125;</span><br><span class="line"># include</span><br><span class="line">  $&#123;catkin_INCLUDE_DIRS&#125;</span><br><span class="line"><span class="addition">+  $&#123;OpenCV_INCLUDE_DIRS&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="读取指定图片"><a href="#读取指定图片" class="headerlink" title="读取指定图片"></a>读取指定图片</h2><h3 id="添加图片"><a href="#添加图片" class="headerlink" title="添加图片"></a>添加图片</h3><p>图片路径：<code>/home/tao/opencv/1.jpg</code></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/opencv%E5%AD%A6%E4%B9%A0/%E8%AF%BB%E5%8F%96%E6%8C%87%E5%AE%9A%E5%9B%BE%E7%89%87/1.jpg?imageView2/1/w/600/h/400" width="600" hegiht="460">1.jpg</center><h3 id="c-程序"><a href="#c-程序" class="headerlink" title="c++程序"></a>c++程序</h3><ul><li>新建程序</li></ul><figure class="highlight c++"><figcaption><span>read_image_c.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ros/ros.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/imgproc/imgproc.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//创建一个Mat对象cv_image，它将存储加载的图像的数据</span></span><br><span class="line">    cv::Mat cv_image = cv::imread(<span class="string">&quot;/home/tao/opencv/1.jpg&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(cv_image.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            ROS_ERROR(<span class="string">&quot;Read the picture failed!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">//创建窗口，显示图像</span></span><br><span class="line">    cv::namedWindow(<span class="string">&quot;Display Image&quot;</span>,cv::WINDOW_NORMAL);</span><br><span class="line">    cv::resizeWindow(<span class="string">&quot;Display Image&quot;</span>, <span class="number">640</span>, <span class="number">480</span>);</span><br><span class="line">    cv::imshow(<span class="string">&quot;Display Image&quot;</span>, cv_image);</span><br><span class="line">    cv::waitKey(<span class="number">0</span>);</span><br><span class="line">    cv::destroyAllWindows();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>修改功能包下CMakeLists.txt文件,添加以下内容</li></ul><figure class="highlight c"><figcaption><span>CMakeLists.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add_executable(read_image_c</span><br><span class="line">  src/read_image_c.cpp</span><br><span class="line">)</span><br><span class="line">add_dependencies(read_image_c $&#123;$&#123;PROJECT_NAME&#125;_EXPORTED_TARGETS&#125; $&#123;catkin_EXPORTED_TARGETS&#125;)</span><br><span class="line">target_link_libraries(read_image_c</span><br><span class="line">  $&#123;catkin_LIBRARIES&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li>编译运行</li></ul><pre><code>$ cm$ rosrun opencv_learning read_image_c</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/opencv%E5%AD%A6%E4%B9%A0/%E8%AF%BB%E5%8F%96%E6%8C%87%E5%AE%9A%E5%9B%BE%E7%89%87/%E8%AF%BB%E5%8F%96%E6%8C%87%E5%AE%9A%E5%9B%BE%E7%89%87c%2B%2B.JPG" width="600" hegiht="460">c++程序运行结果</center><h3 id="python程序"><a href="#python程序" class="headerlink" title="python程序"></a>python程序</h3><figure class="highlight python"><figcaption><span>read_image_p.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_image</span>():</span></span><br><span class="line">    img = cv2.imread(<span class="string">&#x27;/home/tao/opencv/1.jpg&#x27;</span>,cv2.IMREAD_COLOR)</span><br><span class="line">    cv2.namedWindow(<span class="string">&#x27;image&#x27;</span>,cv2.WINDOW_NORMAL)</span><br><span class="line">    cv2.resizeWindow(<span class="string">&quot;image&quot;</span>, <span class="number">640</span>, <span class="number">480</span>);</span><br><span class="line">    cv2.imshow(<span class="string">&#x27;image&#x27;</span>, img)</span><br><span class="line">    cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">    cv2.destroyAllWindows()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    read_image()</span><br></pre></td></tr></table></figure><ul><li>添加权限并运行</li></ul><pre><code>$ cs$ cd opencv_learning/src/$ chmod +x read_image_p.py $ rosrun opencv_learning read_image_p.py</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/opencv%E5%AD%A6%E4%B9%A0/%E8%AF%BB%E5%8F%96%E6%8C%87%E5%AE%9A%E5%9B%BE%E7%89%87/%E8%AF%BB%E5%8F%96%E6%8C%87%E5%AE%9A%E5%9B%BE%E7%89%87python.JPG" width="600" hegiht="460">python程序运行结果</center>]]></content>
      
      
      <categories>
          
          <category> Opencv学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Opencv学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Opencv学习1：Ubuntu下安装与配置</title>
      <link href="/2020/05/15/Opencv%E5%AD%A6%E4%B9%A01%EF%BC%9AUbuntu%E4%B8%8B%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/"/>
      <url>/2020/05/15/Opencv%E5%AD%A6%E4%B9%A01%EF%BC%9AUbuntu%E4%B8%8B%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> Opencv学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Opencv学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>土管项目总结7：IDEA和Tomcat配置手机服务端</title>
      <link href="/2020/05/15/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%937%EF%BC%9ATomcat%E9%85%8D%E7%BD%AE%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF/"/>
      <url>/2020/05/15/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%937%EF%BC%9ATomcat%E9%85%8D%E7%BD%AE%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;<a href="https://www.jetbrains.com/idea/">IDEA</a> 全称 IntelliJ IDEA，是java编程语言开发的集成环境。<a href="http://tomcat.apache.org/">Tomcat</a>服务器是一个免费的开放源代码的Web应用服务器，属于轻量级应用服务器。</p><p>&emsp;&emsp;手机服务端的配置，需要IDEA软件将服务端项目编译出war包，然后放到服务器中通过Tomcat部署，这样手机端才能连接服务器上的数据库。</p><a id="more"></a><h2 id="安装IDEA和Tomcat"><a href="#安装IDEA和Tomcat" class="headerlink" title="安装IDEA和Tomcat"></a>安装IDEA和Tomcat</h2><ul><li><a href="https://www.jetbrains.com/idea/download/#section=windows">IntelliJ IDEA</a></li><li><a href="https://tomcat.apache.org/download-70.cgi">Apache Tomcat 7.0.103 Released</a></li></ul><h3 id="安装IntelliJ-IDEA-2020-1-1"><a href="#安装IntelliJ-IDEA-2020-1-1" class="headerlink" title="安装IntelliJ IDEA 2020.1.1"></a>安装IntelliJ IDEA 2020.1.1</h3><p>（1）选择版本下载，使用旗舰版试用即可。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/idea%E7%89%88%E6%9C%AC%E9%80%89%E6%8B%A9.PNG" width="600" hegiht="460"></center><ul><li><p><strong>Ultimate</strong>即为旗舰版，功能全面，插件丰富，但是收费，按年收费。如果非要比较的话类似于myEclipse。</p></li><li><p><strong>Community</strong>即为社区版，免费试用，功能相对而言不是很丰富，但是不影响开发使用。如果非要比较的话类似于eclipse。</p></li></ul><p>（2）安装IDEA，安装界面选择如下：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E5%AE%89%E8%A3%85idea.PNG" width="400" hegiht="460"></center><h3 id="安装-Apache-Tomcat-7-0-103-Released"><a href="#安装-Apache-Tomcat-7-0-103-Released" class="headerlink" title="安装 Apache Tomcat 7.0.103 Released"></a>安装 Apache Tomcat 7.0.103 Released</h3><p>（1）下载 Apache Tomcat 7.0.103 Released，选择 <code>64-bit Windows zip (pgp, sha512)</code>。下载完成，将解压后的<code>apache-tomcat-7.0.103</code>文件夹放到合适位置（任意位置）。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E4%B8%8B%E8%BD%BDtomcat7.PNG" width="500" hegiht="460"></center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E8%A7%A3%E5%8E%8B%E5%90%8Etomcat7.PNG" width="500" hegiht="460"></center><p>（2)进入<code>apache-tomcat-7.0.103/bin</code>文件夹，双击启动<code>startup.bat</code>文件。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E5%90%AF%E5%8A%A8tomcat.PNG" width="500" hegiht="460"></center><p>&emsp;&emsp;输入网址<code> http://localhost:8080/</code>，能看到运行成功的界面。当然这一步需要在服务器上进行，这里先演示启动tomcat7的流程。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E5%90%AF%E5%8A%A8tomcat2.PNG" width="600" hegiht="460"></center><h2 id="导入服务端项目"><a href="#导入服务端项目" class="headerlink" title="导入服务端项目"></a>导入服务端项目</h2><h3 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h3><p>参考：<a href="https://blog.csdn.net/LJH_laura_li/article/details/103916804">在IDEA环境下创建Java Web项目:配置tomcat和war包的生成</a></p><p>（1）新建web项目<br>&emsp;&emsp;IDEA安装完成后，选择<code>Creat New Project</code>新建项目</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E5%88%9B%E5%BB%BA%E6%96%B0web%E9%A1%B9%E7%9B%AE.PNG" width="500" hegiht="460"></center><div class="note warning">            <p>注意：要跟我选的一样。</p>          </div><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E5%88%9B%E5%BB%BA%E6%96%B0web%E9%A1%B9%E7%9B%AE2.PNG" width="500" hegiht="460"></center><p>(2) 创建classes和lib文件夹</p><ul><li>打开项目中选择在<code>WEB-INF</code>文件夹下创建两个文件夹(右键<code>New</code>  → <code>Directory</code>)：</li></ul><pre><code>classes文件夹：用来存放编译后的java文件；lib文件夹：用来存放java类库文件(*.jar)</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9classes%E5%92%8Clib.PNG" width="600" hegiht="460"></center><ul><li>打开<code>File</code> → <code>Project Settings</code> → <code>Modules</code>，修改Path路径，选择新创建的classes文件夹。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E4%BF%AE%E6%94%B9path.PNG" width="600" hegiht="460"></center><ul><li>打开<code>File</code> → <code>Project Settings</code> → <code>Modules</code>，修改Dependencies路径。点击右侧<code>+</code>号，选择<code>1 JARS...</code>,选择新创建的lib文件夹。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E4%BF%AE%E6%94%B9lib.PNG" width="600" hegiht="460"></center><ul><li>配置完成，点击<code>Apply</code>进行应用，再点击<code>OK</code>。</li></ul><p>（3）导入手机服务端项目</p><pre><code>- 将手机服务端下`src`文件夹，复制到新的项目同样路径下。- 将手机服务端下`WEB-INF/lib`文件夹，复制到新的项目同样路径下。- 将手机服务端下`WEB-INF/web.xml`文件夹，复制到新的项目同样路径下。</code></pre><h3 id="修改服务器连接"><a href="#修改服务器连接" class="headerlink" title="修改服务器连接"></a>修改服务器连接</h3><p>&emsp;&emsp;导入项目后，不要直接进行编译，还需要修改服务器连接地址。选择手机服务端项目下<code>src\com.LandMS</code>文件夹，分别修改<code>DButils.java</code>文件、<code>Loginservlet.java</code>文件和<code>SqltestServlet.java</code>文件。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E4%BF%AE%E6%94%B9%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%93%BE%E6%8E%A5%E5%9C%B0%E5%9D%80.PNG" width="800" hegiht="460"></center><p>&emsp;&emsp;将三个文件的相关内容，修改为当前的服务器数据库地址和密码，如下所示：</p><pre><code>String dbURL = &quot;jdbc:sqlserver://62.234.214.152:1433; DatabaseName=Kangsoft.HRMS&quot;;  String userName = &quot;sa&quot;;  String userPwd = &quot;Ahau306306306&quot;;  </code></pre><h3 id="重新编译"><a href="#重新编译" class="headerlink" title="重新编译"></a>重新编译</h3><p>&emsp;&emsp;选择工具栏<code>Build</code> → <code>Rebuild Project</code>,重新编译整个项目。没有错误提示，但会出现年份获取函数过时警告（我没有进行处理，可能需要你来完成）：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E7%BC%96%E8%AF%91%E8%AD%A6%E5%91%8A.PNG" width="400" hegiht="460"></center><p>解决方法可参考：<a href="https://blog.csdn.net/Janson_Lin/article/details/99410519">Java Date日期类中的getMonth()与getYear()提示过时警告</a></p><p>此外注意查看WEB-INF/classes文件夹是否生成对应的class文件。如果没问题，可以进行下一步。</p><h2 id="IDEA生成war包"><a href="#IDEA生成war包" class="headerlink" title="IDEA生成war包"></a>IDEA生成war包</h2><h3 id="进行相关配置"><a href="#进行相关配置" class="headerlink" title="进行相关配置"></a>进行相关配置</h3><p>&emsp;&emsp;首先打开<code>File</code> → <code>Project Settings</code> → <code>Artifacts</code>进行配置。<br>（1）可以看到<code>Web Application:Exploded</code>已经创建了。右下角如果出现提示，则<code>Fix</code>选择第一个。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/war%20exploded.png" width="600" hegiht="460"></center><p>(2)选择中间<code>+</code>号 → <code>Web Application:Archive</code> → <code>For LandMsystem:war exploded</code>，Name改为LandMsystem，其它默认设置即可。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/war%20archive.png" width="600" hegiht="460"></center><p>配置完成，点击<code>Apply</code>进行应用，再点击<code>OK</code>。</p><h3 id="生成war包"><a href="#生成war包" class="headerlink" title="生成war包"></a>生成war包</h3><p>&emsp;&emsp;选择工具栏<code>Build</code> → <code>Build Artifacts</code>→ <code>All Artifacts</code>→ <code>Build </code>。可以看到默认的<code>\LandMsystem\out\artifacts\LandMsystem</code>文件夹下已经创建<code>LandMsystem.war</code>包。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/tomcat%20webapps.PNG" hegiht="460"></center><h2 id="Tomcat部署-war包"><a href="#Tomcat部署-war包" class="headerlink" title="Tomcat部署 war包"></a>Tomcat部署 war包</h2><h3 id="前提准备"><a href="#前提准备" class="headerlink" title="前提准备"></a>前提准备</h3><p>（1）服务器上先安装以下两个软件，这在前面都有介绍。</p><ul><li><a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html">jdk-8u251-windows-x64</a> (别忘了JDK环境变量配置)</li><li><a href="https://tomcat.apache.org/download-70.cgi">Apache Tomcat 7.0.103 Released</a></li></ul><p>（2）如何将本地文件上传到服务器，下面通过远程桌面进行配置：</p><div class="tabs" id="上传到服务器"><ul class="nav-tabs"><li class="tab active"><a href="#上传到服务器-1">启动远程桌面</a></li><li class="tab"><a href="#上传到服务器-2">本地资源</a></li><li class="tab"><a href="#上传到服务器-3">选择盘符</a></li><li class="tab"><a href="#上传到服务器-4">服务器显示</a></li></ul><div class="tab-content"><div class="tab-pane active" id="上传到服务器-1"><ul><li>选择<code>显示选项</code></li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E5%90%AF%E5%8A%A8.PNG" width="400" hegiht="400" ></div><div class="tab-pane" id="上传到服务器-2"><ul><li>选择<code>本地资源</code></li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%AC%E5%9C%B0%E8%B5%84%E6%BA%90.PNG" width="400" hegiht="400" ></div><div class="tab-pane" id="上传到服务器-3"><ul><li>选择<code>本地资源</code>，选择本地电脑上的一个驱动盘，如我的D盘。</li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E9%80%89%E6%8B%A9%E7%9B%98.PNG" width="400" hegiht="400" ></div><div class="tab-pane" id="上传到服务器-4"><ul><li>启动远程桌面，可以看到已经出现本地的D盘，可以将里面的文件复制到服务器上。</li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%98%BE%E7%A4%BA.PNG" width="600" hegiht="400" ></div></div></div><h3 id="部署war包"><a href="#部署war包" class="headerlink" title="部署war包"></a>部署war包</h3><ul><li>将war包 <code>landwar20200516 archive.war</code>复制到<code>\apache-tomcat-7\webapps</code>文件夹下。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/out%E6%96%87%E4%BB%B6%E5%A4%B9war.PNG" width="500" hegiht="460"></center><ul><li>进入<code>apache-tomcat-7.0.103/bin</code>文件夹，双击启动<code>startup.bat</code>文件，启动 Tomcat。会自动解压war包，部署Web应用。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/tomcat%20webapps.PNG" width="500" hegiht="460"></center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/tomcat%20%E5%90%AF%E5%8A%A8.PNG" width="500" hegiht="460"></center><h2 id="连接测试"><a href="#连接测试" class="headerlink" title="连接测试"></a>连接测试</h2><ul><li>本地电脑上访问 <a href="http://62.234.214.152:8080/LandMsystem/loginServlet?user=admin&password=MQ==">http://62.234.214.152:8080/LandMsystem/loginServlet?user=admin&amp;password=MQ==</a>，如果看到以下内容，说明手机服务端与数据库连接没有问题。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E8%BF%9E%E6%8E%A5%E6%B5%8B%E8%AF%95%20%E7%BD%91%E9%A1%B5.PNG" width="500" hegiht="460"></center><ul><li>打开手机端，输入账号密码。能看到以下界面，说明手机端已正常连接服务器。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%8B%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/%E8%BF%9E%E6%8E%A5%E6%B5%8B%E8%AF%95%20%E6%89%8B%E6%9C%BA%E7%AB%AF.jpg" width="400" hegiht="460"></center><p>&emsp;&emsp;到此，土地管理项目网页和手机端配置基本完成,都能够连接数据库修改数据。整个配置过程中学到新的知识不少,在此留个记录。</p>]]></content>
      
      
      <categories>
          
          <category> 土管项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 土管项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>土管项目总结6：Eclipse 实现手机端APK打包</title>
      <link href="/2020/05/15/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%936%EF%BC%9A%E6%89%93%E5%8C%85APK/"/>
      <url>/2020/05/15/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%936%EF%BC%9A%E6%89%93%E5%8C%85APK/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;上一步已经完成Android相关的环境配置，此次使用<a href="https://www.eclipse.org/downloads/packages/release/kepler/sr2/eclipse-ide-java-ee-developers">Eclipse IDE for Java EE Developers</a> 2020‑03版本实现手机端的APK打包。</p><a id="more"></a><h2 id="导入手机端项目"><a href="#导入手机端项目" class="headerlink" title="导入手机端项目"></a>导入手机端项目</h2><h3 id="导入手机端项目-1"><a href="#导入手机端项目-1" class="headerlink" title="导入手机端项目"></a>导入手机端项目</h3><p>&emsp;&emsp;启动Eclipse软件, 打开<code>File</code> → <code>Import</code> → <code>Android</code> → <code>Existing Android Code Into Workspace</code>。选择<code>\夏老师土地管理项目\土地管理\LandMSystem手机端</code>，点击<code>Finish</code>。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%93%E5%8C%85apk/%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE.PNG" width="500" hegiht="460"></center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%93%E5%8C%85apk/%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE2.PNG" width="500" hegiht="460"></center><h3 id="修改服务器地址"><a href="#修改服务器地址" class="headerlink" title="修改服务器地址"></a>修改服务器地址</h3><p>&emsp;&emsp;选择项目下src文件夹，打开<code>com.LandMS</code> → <code>BaseApi.java</code>文件，修改为当前的服务器地址。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%93%E5%8C%85apk/%E4%BF%AE%E6%94%B9%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80.PNG" width="600" hegiht="460"></center><div class="note warning">            <p>注意：服务器后面8080不要丢弃。</p>          </div><h2 id="打包apk"><a href="#打包apk" class="headerlink" title="打包apk"></a>打包apk</h2><ul><li><p>右键项目<code>LandMsystem</code>，选择<code>Android Tools</code> → <code>Export Signed ApplicationPackage...</code>,导出带签名的apk。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%93%E5%8C%85apk/%E5%90%AF%E5%8A%A8ADT.png" width="600" hegiht="460"></center></li><li><p>选择导出项目</p></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%93%E5%8C%85apk/%E6%89%93%E5%8C%85apk2.PNG" width="400" hegiht="460"></center><ul><li>第一次需要创建签名，后面再导出的话只需要账号密码。</li></ul><p>&emsp;&emsp; &emsp;&emsp; 选择文件名和创建密码：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%93%E5%8C%85apk/%E5%88%9B%E5%BB%BA%E7%AD%BE%E5%90%8D.PNG" width="400" hegiht="460"></center><p>&emsp;&emsp; &emsp;&emsp; 创建姓名和密码，有效期可选择0~1000年：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%93%E5%8C%85apk/%E5%88%9B%E5%BB%BA%E7%AD%BE%E5%90%8D2.PNG" width="400" hegiht="460"></center><ul><li>选择apk名称和路径，点击Finish就能打包apk</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E6%89%93%E5%8C%85apk/%E6%89%93%E5%8C%85apk3.PNG" width="400" hegiht="460"></center><p>可以在自己设定的路径上看到打包好的手机apk。</p><div class="note warning">            <p>将apk发送到手机上进行安装，</p><blockquote><p>账号：admin &emsp;&emsp; 密码：MQ==</p></blockquote><p>这时候是登陆不进去的，因为没有在服务器上运行手机的服务端，无法连接数据库，所以下一步需要进行手机服务端的配置。</p>          </div>]]></content>
      
      
      <categories>
          
          <category> 土管项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 土管项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>土管项目总结5：配置Android开发环境</title>
      <link href="/2020/05/15/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%935%EF%BC%9A%E9%85%8D%E7%BD%AEAndroid%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
      <url>/2020/05/15/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%935%EF%BC%9A%E9%85%8D%E7%BD%AEAndroid%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><a href="https://developer.android.google.cn/">Android</a>开发环境常用的有：</p><ul><li><a href="https://developer.android.google.cn/studio">Android Studio</a></li><li><a href="https://www.eclipse.org/downloads/packages/release/kepler/sr2/eclipse-ide-java-ee-developers">Eclipse IDE for Java EE Developers</a></li></ul><p>&emsp;&emsp;我使用的是<a href="https://www.eclipse.org/downloads/packages/release/kepler/sr2/eclipse-ide-java-ee-developers">Eclipse IDE for Java EE Developers</a> 2020‑03版本，由于它的<code>Android SDK Manager</code>无法访问<code>dl-ssl.google.com</code>去下载Android SDK 和Android Tool。网上查了很多教程都，但都已经失效，没办法，最后发现可以移植<a href="https://developer.android.google.cn/studio">Android Studio</a>中下载的Android SDK 和Android Tool，解决这一问题。所以，我两个软件都安装了。如果你会<a href="https://developer.android.google.cn/studio">Android Studio</a>打包APK，就不需要移植操作了，直接使用<a href="https://developer.android.google.cn/studio">Android Studio</a>即可。</p><a id="more"></a><h2 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h2><ul><li>JDK官网：<a href="https://www.oracle.com/java/technologies/javase-downloads.html">https://www.oracle.com/java/technologies/javase-downloads.html</a></li><li><a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html">Java SE Development Kit 8 Downloads</a></li></ul><p>&emsp;&emsp;我选择<a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html">jdk-8u251-windows-x64</a>版本，安装完成后，默认安装路径下有两个文件夹，分别是<code>C:\Program Files\Java\jdk1.8.0_251</code>和<code>C:\Program Files\Java\jre1.8.0_251</code></p><p><strong>配置环境变量</strong></p><p>（1）右键<code>此电脑</code> → <code>高级系统设置</code> → <code>高级</code> → <code>环境变量</code></p><ul><li>新建变量<code>JAVA_HOME</code>和<code>CLASSPATH</code></li></ul><pre><code>变量名： JAVA_HOME变量值： C:\Program Files\Java\jdk1.8.0_251变量名： CLASSPATH变量值：.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/%E6%96%B0%E5%BB%BAJAVA%E5%8F%98%E9%87%8F.PNG" width="500" hegiht="460"></center><ul><li>编辑<code>Path</code>变量，新建<code>%JAVA_HOME%\bin</code></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/path%E5%8F%98%E9%87%8F.PNG" width="500" hegiht="460"></center><p>（2）启动Eclipse软件, 然后在菜单栏上选择<code>Window</code> → <code>Preferences</code></p><ul><li>在<code>Java</code> → <code>Installed JREs</code>, 添加<code>jre1.8.0_251</code>路径</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/eclipse%E9%85%8D%E7%BD%AEjre.PNG" width="500" hegiht="460"></center><ul><li>在<code>Java</code> → <code>Compiler</code>, 选择<code>1.8</code></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/eclipse%E9%85%8D%E7%BD%AEjdk1.8.PNG" width="500" hegiht="460"></center><h2 id="安装ADT工具"><a href="#安装ADT工具" class="headerlink" title="安装ADT工具"></a>安装ADT工具</h2><p>Eclipse可以通过两种方式安装ADT插件，在线安装、离线安装(需要先下载ADT插件包)。这里推荐使用离线安装，比较方便快速。</p><ul><li><p>先下载<a href="https://dl.google.com/android/ADT-23.0.6.zip">ADT-23.0.6.zip</a>,不需要解压</p></li><li><p>启动Eclipse,然后在菜单栏上选择 <code>Help</code>  →  <code>Install New Software</code></p></li><li><p>单击<code>Add</code>按钮，在”Add Repository”对话框，输入以下内容。取消勾选<code>Contact all update sites during instaall to find required software</code>,否则更新会花费很长时间。</p></li></ul><pre><code>Name: ADT PluginArchive: 选择下载的ADT-23.0.6.zip文件</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/%E5%AE%89%E8%A3%85ADT.PNG" width="500" hegiht="460"></center><ul><li>在软件对话框中,选中”Developer Tools”复选框,然后点击”Next”；在下一个窗口中，您会看到一个要下载的工具列表。单击“Next”,阅读并接受许可协议，然后单击“Finish”，安装完成后，重新启动Eclipse。</li></ul><h2 id="安装Android-SDK"><a href="#安装Android-SDK" class="headerlink" title="安装Android SDK"></a>安装Android SDK</h2><p>下载<a href="http://dl.google.com/android/android-sdk_r24.0.2-windows.zip">android-sdk_r24.0.2-windows.zip</a></p><p><strong>解压后的目录如下：</strong></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/SDK%E7%9B%AE%E5%BD%95.PNG" width="500" hegiht="460"></center><p>（1）启动Eclipse,选择<code>windows</code>&gt;<code>preferences</code>&gt;<code>android</code><br>（2）在选项卡中选择”Browse”,选择解压后的目录,点击确定</p><p><strong>启动SDK Manager</strong><br>启动SDK Manager，可能会出现以下错误，在网上查了很多教程，发现都已经失效，无法使用。最后通过移植<a href="https://developer.android.google.cn/studio">Android Studio</a>中下载的Android SDK 和Android Tool等文件夹，解决这一问题。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/%E9%94%99%E8%AF%AF%E6%8F%90%E7%A4%BA.PNG" width="500" hegiht="460"></center><h2 id="安装Android-studio"><a href="#安装Android-studio" class="headerlink" title="安装Android studio"></a>安装Android studio</h2><p>&emsp;&emsp;可以去<a href="https://developer.android.google.cn/">Android</a>官网下载<a href="https://developer.android.google.cn/studio">Android Studio</a>。安装时注意可以取消勾选<code>Android Virtual Decevice</code>,节省很多时间。如下：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/%E5%AE%89%E8%A3%85android%20studio.PNG" width="400" hegiht="460"></center><h3 id="下载Android-SDK和编译工具"><a href="#下载Android-SDK和编译工具" class="headerlink" title="下载Android SDK和编译工具"></a>下载Android SDK和编译工具</h3><p>&emsp;&emsp;启动<code>Android studio</code> → <code>File</code> → <code>Settings</code> → <code>Apperance&amp; Behavior</code> → <code>Android SDK</code></p><ul><li><strong>SDK Platforms:</strong> 选择安装<code>Android 10.0（API 29）</code>和<code>Android 4.4（API 19）</code> </li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/%E5%AE%89%E8%A3%85android%2029%2019.PNG" width="600" hegiht="460"></center><ul><li><strong>SDK Tool:</strong> 选择安装A<code>ndroid SDK Build-Tools</code> 和 <code>Android SDK Platform-Tools</code></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/%E5%AE%89%E8%A3%85build%20tool.PNG" width="600" hegiht="460"></center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/%E5%AE%89%E8%A3%85android%2029%20%E7%AD%89.PNG" width="600" hegiht="460"></center><p>&emsp;&emsp;然后全部项目选择<code>Accept</code>进行安装，可以看到下载速度很快，没有出现无网速问题。</p><h3 id="移植文件"><a href="#移植文件" class="headerlink" title="移植文件"></a>移植文件</h3><p>上一步安装完成后，将下载的一些文件夹复制到<code>android-sdk_r24.0.2-windows/android-sdk-windows</code>文件夹下，如下所示：</p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/%E7%A7%BB%E6%A4%8D%E6%96%87%E4%BB%B6.PNG" width="500" hegiht="460"></center><p>&emsp;&emsp;再次启动Eclipse,选择<code>windows</code>&gt;<code>preferences</code>&gt;<code>android</code>，再次进行选择<code>android-sdk_r24.0.2-windows/android-sdk-windows</code>文件夹。这样就将android SDK和编译环境搭建完成。</p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AEAndroid/%E7%A7%BB%E6%A4%8D%E6%96%87%E4%BB%B62.PNG" width="600" hegiht="460"></center><div class="note warning">            <p>至此，Android的编译环境基本配置完成。选择<code>Android 10.0（API 29）</code>是为了以后更新app预先配置的，目前的手机APP编译环境还是采用<code>Android 4.4（API 19）</code>。</p>          </div>]]></content>
      
      
      <categories>
          
          <category> 土管项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 土管项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实习项目经验总结3：c++ 使用总结探讨</title>
      <link href="/2020/05/05/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%933%EF%BC%9Ac++%20%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93%E6%8E%A2%E8%AE%A8/"/>
      <url>/2020/05/05/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%933%EF%BC%9Ac++%20%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93%E6%8E%A2%E8%AE%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;记录c++一些实用方法和经验总结，不涉及保密项目。</p><a id="more"></a><h2 id="int-main-int-argc-char-argv"><a href="#int-main-int-argc-char-argv" class="headerlink" title="int main(int argc, char **argv)"></a>int main(int argc, char **argv)</h2><ul><li>argc是命令行总的参数个数</li><li>argv[]是字符型数组，其中argv[0]是程序的全名，argv[1]、argv[2]、argv[3]…..为用户输入的参数。</li></ul><p>以ROS服务客户端为例，部分代码如下：</p><figure class="highlight c++"><figcaption><span>client_test.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ros::init(argc, argv, <span class="string">&quot;srv_client&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;argv[0]: %s\n&quot;</span>,argv[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;argv[1]: %s\n&quot;</span>,argv[<span class="number">1</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;argv[2]: %s\n&quot;</span>,argv[<span class="number">2</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>终端运行结果：</p><pre><code>tao@ubuntu:~$ rosrun ros_learning client_test 3 8argv[0]: /home/tao/catkin_ws/devel/lib/ros_learning/client_testargv[1]: 3argv[2]: 8</code></pre><p><a href="https://blog.csdn.net/u011068702/article/details/52588455">char** argv与char *argv[]区别</a></p><h2 id="cstdlib-头文件"><a href="#cstdlib-头文件" class="headerlink" title="cstdlib 头文件"></a>cstdlib 头文件</h2><ul><li><a href="http://www.cplusplus.com/reference/cstdlib/">cstdlib</a></li><li><a href="https://blog.csdn.net/Chnyac/article/details/82745298">C++：cstdlib 头文件详解</a></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/c%2B%2B%20%E4%BD%BF%E7%94%A8/stdlib.h%20C%2B%2B.png" width="600" hegiht="460">stdlib.h</center>]]></content>
      
      
      <categories>
          
          <category> 实习项目 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>实习项目经验总结2：Git 安装与使用</title>
      <link href="/2020/05/04/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%932%EF%BC%9AGit%20%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"/>
      <url>/2020/05/04/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%932%EF%BC%9AGit%20%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;实习项目需要使用git进行仓库管理，在此记录git的使用方法。</p><ul><li><a href="https://git-scm.com/downloads">Git Downloads</a> </li><li><a href="https://www.runoob.com/git/git-install-setup.html">Git 安装配置</a></li></ul><a id="more"></a><h2 id="ubuntu-16-04-安装git"><a href="#ubuntu-16-04-安装git" class="headerlink" title="ubuntu 16.04 安装git"></a>ubuntu 16.04 安装git</h2><p>参考<a href="https://git-scm.com/download/linux">git官网教程</a></p><pre><code>tao@ubuntu:~$ sudo apt-get install gittao@ubuntu:~$ git --versiongit version 2.7.4</code></pre><h2 id="Git-工作流程"><a href="#Git-工作流程" class="headerlink" title="Git 工作流程"></a>Git 工作流程</h2><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/git/git-process.png" width="500" hegiht="460">Git 工作流程</center><h2 id="Git-使用"><a href="#Git-使用" class="headerlink" title="Git 使用"></a>Git 使用</h2><h3 id="Git-创建仓库"><a href="#Git-创建仓库" class="headerlink" title="Git 创建仓库"></a>Git 创建仓库</h3><p>&emsp;&emsp;Git 使用 git init 命令来初始化一个 Git 仓库，Git 的很多命令都需要在 Git 的仓库中运行，所以 git init 是使用 Git 的第一个命令。</p><pre><code>tao@ubuntu:~/hrg_ws$ git init初始化空的 Git 仓库于 /home/tao/hrg_ws/.git/</code></pre><p>&emsp;&emsp;在执行完成 git init 命令后，Git 仓库会生成一个 .git 目录（<code>ctrl+h 显示和隐藏</code>），该目录包含了资源的所有元数据，所有 Git 需要的数据和资源都存放在这个目录中。</p><h3 id="git-clone"><a href="#git-clone" class="headerlink" title="git clone"></a>git clone</h3><p>&emsp;&emsp;我们使用 git clone 从现有 Git 仓库中拷贝项目，以<a href="https://github.com/litten/hexo-theme-yilia">hexo-theme-yilia</a>为例</p><pre><code>tao@ubuntu:~/hrg_ws$ git clone https://github.com/litten/hexo-theme-yilia.git正克隆到 &#39;hexo-theme-yilia&#39;...remote: Enumerating objects: 1, done.remote: Counting objects: 100% (1/1), done.remote: Total 2037 (delta 0), reused 0 (delta 0), pack-reused 2036接收对象中: 100% (2037/2037), 10.52 MiB | 207.00 KiB/s, 完成.处理 delta 中: 100% (1093/1093), 完成.检查连接... 完成。tao@ubuntu:~/hrg_ws$ ls -a.  ..  .git  hexo-theme-yilia</code></pre><h2 id="Git-远程仓库-Github"><a href="#Git-远程仓库-Github" class="headerlink" title="Git 远程仓库(Github)"></a>Git 远程仓库(Github)</h2><h3 id="配置SSH"><a href="#配置SSH" class="headerlink" title="配置SSH"></a>配置SSH</h3><p>由于你的本地 Git 仓库和 GitHub 仓库之间的传输是通过SSH加密的，所以我们需要配置验证信息。</p><p>（1）使用以下命令生成 SSH Key：</p><pre><code>$ ssh-keygen -t rsa -C &quot;xiaoxiaotaoya@gmail.com&quot;</code></pre><p>后面的为Github账号注册的邮箱，之后会要求确认路径和输入密码，我们这使用默认的一路回车就行。成功的话终端会显示.ssh路径（<code>ctrl+h 显示和隐藏</code>），复制<code>id_rsa.pub</code>里面的全部内容。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/git/%E9%85%8D%E7%BD%AEssh.PNG" width="600" hegiht="460">ubuntu 生成 SSH Key</center><p>（2）github：进入 <code>Account</code> =&gt; <code>Settings</code>（账户配置) =&gt; <code>SSH and GPG keys</code>。然后点击 <code>New SSH key</code> 按钮,<code>Title</code>：可以随便填；<code>Key</code>：粘贴<code>id_rsa.pub</code>里面的全部内容</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/git/github%20ssh%E9%85%8D%E7%BD%AE.PNG" width="800" hegiht="460">Github 配置SSH</center><p>（3）为了验证是否成功，输入以下命令：</p><pre><code>tao@ubuntu:~/hrg_ws$ ssh -T git@github.comHi xxty847! You&#39;ve successfully authenticated, but GitHub does not provide shell access.</code></pre><p>以上命令说明我们已成功连上 Github。</p><h3 id="创建新仓库"><a href="#创建新仓库" class="headerlink" title="创建新仓库"></a>创建新仓库</h3><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/git/%E5%88%9B%E5%BB%BA%E6%96%B0%E4%BB%93%E5%BA%93.PNG" width="600" hegiht="460">创建新仓库</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/git/%E6%96%B0%E4%BB%93%E5%BA%93%E7%95%8C%E9%9D%A2.png" width="700" hegiht="460">新仓库界面</center><p>&emsp;&emsp;可以看到有两种选择，创建新的仓库或者上传本地项目。</p><h3 id="第一次提交"><a href="#第一次提交" class="headerlink" title="第一次提交"></a>第一次提交</h3><p>&emsp;&emsp;由于git已经初始化，省略了这一步。第一次提交过程中可能出现验证邮箱用户名和登录提示，按照说明进行即可。</p><pre><code>$ cd hrg_ws/// $ git init$ echo &quot;# Git 测试&quot; &gt;&gt; README.md     # 创建 README.md 文件并写入内容$ git add README.md$ git commit -m &quot;添加 README.md 文件&quot;    # 提交并备注信息$ git remote add origin https://github.com/xxty847/hrg.git$ git push -u origin master</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/git/git%E6%8F%90%E4%BA%A4%E4%BB%93%E5%BA%93.PNG" width="500" hegiht="460">git 提交文档</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/git/%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E4%BC%A0%E6%96%87%E6%A1%A3.PNG" width="700" hegiht="460">第一次上传文档</center><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://www.runoob.com/git/git-remote-repo.html">Git 远程仓库(Github)</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 实习项目 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习8：常用命令与工具</title>
      <link href="/2020/05/04/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A08%EF%BC%9A%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%8E%E5%B7%A5%E5%85%B7/"/>
      <url>/2020/05/04/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A08%EF%BC%9A%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%8E%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>记录ROS常用命令与工具使用</p><a id="more"></a><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E5%91%BD%E4%BB%A4%E4%B8%8E%E5%B7%A5%E5%85%B7/ros%20shell%20%E5%91%BD%E4%BB%A4.PNG" width="600" hegiht="460">ROS shell命令</center><pre><code>roscd [功能包名称]rosls [功能包名称]rosed [功能包名称] [文件名称]</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E5%91%BD%E4%BB%A4%E4%B8%8E%E5%B7%A5%E5%85%B7/ROS%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4.PNG" width="600" hegiht="460">ROS 执行命令</center><pre><code>roscore [选项]rosrun [功能包名称] [节点名称]roslaunch [功能包名称] [launch文件名]rosclean [选项]</code></pre><blockquote><p>注意：<br>当运行roscore时，如果显示以下警告信息，则意味着日志文件超过1GB，如果用户觉得会让系统不堪重负，请使用rosclean命令将其删除。<br>$ WARNING: disk usage in log directory [/xxx/.ros/log] is over 1GB.<br>$ rosclean check        检查日志使用情况<br>$ rosclean purge        删除ROS日志存储库</p></blockquote><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E5%91%BD%E4%BB%A4%E4%B8%8E%E5%B7%A5%E5%85%B7/ros%E4%BF%A1%E6%81%AF%E5%91%BD%E4%BB%A4.PNG" width="600" hegiht="460">ROS信息命令</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E5%91%BD%E4%BB%A4%E4%B8%8E%E5%B7%A5%E5%85%B7/ros%20catin%20%E5%91%BD%E4%BB%A4.PNG" width="600" hegiht="460">ROS catkin命令</center><pre><code>catkin_create_pkg [功能包名称] [依赖性功能包1] [依赖性功能包2] ...catkin_make [选项]catkin_find [功能包名称]</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E5%91%BD%E4%BB%A4%E4%B8%8E%E5%B7%A5%E5%85%B7/ros%E5%8A%9F%E8%83%BD%E5%8C%85%E5%91%BD%E4%BB%A4.PNG" width="600" hegiht="460">ROS功能包命令</center><pre><code>rospack [选项] [功能包名称]rosdep [选项]roslocate [选项] [功能包名称]</code></pre><h2 id="ROS消息命令"><a href="#ROS消息命令" class="headerlink" title="ROS消息命令"></a>ROS消息命令</h2><h3 id="rosnode"><a href="#rosnode" class="headerlink" title="rosnode"></a>rosnode</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tao@ubuntu:~$ rosnode -h</span><br><span class="line">rosnode is a command-line tool for printing information about ROS Nodes.</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">rosnode pingtest connectivity to node</span><br><span class="line">rosnode listlist active nodes</span><br><span class="line">rosnode infoprint information about node</span><br><span class="line">rosnode machinelist nodes running on a particular machine or list machines</span><br><span class="line">rosnode killkill a running node</span><br><span class="line">rosnode cleanuppurge registration information of unreachable nodes</span><br><span class="line"></span><br><span class="line">Type rosnode &lt;command&gt; -h for more detailed usage, e.g. &#39;rosnode ping -h&#39;</span><br></pre></td></tr></table></figure><pre><code>rosnode list 查看活动的节点列表rosnode ping [节点名称] 与指定的节点进行连接测试rosnode info [节点名称] 查看指定节点的信息rosnode machine [PC名称或IP] 查看该PC中运行的节点列表rosnode kill [节点名称] 停止指定节点的运行rosnode cleanup 删除失连节点的注册信息</code></pre><h3 id="rostopic"><a href="#rostopic" class="headerlink" title="rostopic"></a>rostopic</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">tao@ubuntu:~$ rostopic -h</span><br><span class="line">rostopic is a command-line tool for printing information about ROS Topics.</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">rostopic bwdisplay bandwidth used by topic</span><br><span class="line">rostopic delaydisplay delay of topic from timestamp in header</span><br><span class="line">rostopic echoprint messages to screen</span><br><span class="line">rostopic findfind topics by type</span><br><span class="line">rostopic hzdisplay publishing rate of topic    </span><br><span class="line">rostopic infoprint information about active topic</span><br><span class="line">rostopic listlist active topics</span><br><span class="line">rostopic pubpublish data to topic</span><br><span class="line">rostopic typeprint topic or field type</span><br><span class="line"></span><br><span class="line">Type rostopic &lt;command&gt; -h for more detailed usage, e.g. &#x27;rostopic echo -h&#x27;</span><br></pre></td></tr></table></figure><pre><code>rostopic list 显示活动的话题目录rostopic echo [话题名称] 实时显示指定话题的消息内容rostopic find [类型名称] 显示使用指定类型的消息的话题rostopic type [话题名称] 显示指定话题的消息类型rostopic bw [话题名称] 显示指定话题的消息带宽（bandwidth）rostopic hz [话题名称] 显示指定话题的消息数据发布周期rostopic info [话题名称] 显示指定话题的信息rostopic pub [话题名称] [消息类型] [参数] 用指定的话题名称发布消息</code></pre><h3 id="rosservice"><a href="#rosservice" class="headerlink" title="rosservice"></a>rosservice</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tao@ubuntu:~$ rosservice -h</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">rosservice argsprint service arguments</span><br><span class="line">rosservice callcall the service with the provided args</span><br><span class="line">rosservice findfind services by service type</span><br><span class="line">rosservice infoprint information about service</span><br><span class="line">rosservice listlist active services</span><br><span class="line">rosservice typeprint service type</span><br><span class="line">rosservice uriprint service ROSRPC uri</span><br><span class="line"></span><br><span class="line">Type rosservice &lt;command&gt; -h for more detailed usage, e.g. &#39;rosservice call -h&#39;</span><br></pre></td></tr></table></figure><pre><code>rosservice list 显示活动的服务信息rosservice info [服务名称] 显示指定服务的信息rosservice type [服务名称] 显示服务类型rosservice find [服务类型] 查找指定服务类型的服务rosservice uri [服务名称] 显示ROSRPC URI服务rosservice args [服务名称] 显示服务参数rosservice call [服务名称] [参数] 用输入的参数请求服务</code></pre><h3 id="rosparam"><a href="#rosparam" class="headerlink" title="rosparam"></a>rosparam</h3><p>&emsp;&emsp;rosparam使得我们能够存储并操作ROS 参数服务器（Parameter Server）上的数据。参数服务器能够存储整型、浮点、布尔、字符串、字典和列表等数据类型。<br>&emsp;&emsp;rosparam使用YAML标记语言的语法。一般而言，YAML的表述很自然：1 是整型, 1.0 是浮点型, one是字符串, true是布尔, [1, 2, 3]是整型列表, {a: b, c: d}是字典. rosparam有很多指令可以用来操作参数，如下所示:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tao@ubuntu:~$ rosparam -h</span><br><span class="line">rosparam is a command-line tool for getting, setting, and deleting parameters from the ROS Parameter Server.</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">rosparam setset parameter</span><br><span class="line">rosparam getget parameter</span><br><span class="line">rosparam loadload parameters from file</span><br><span class="line">rosparam dumpdump parameters to file</span><br><span class="line">rosparam deletedelete parameter</span><br><span class="line">rosparam listlist parameter names</span><br></pre></td></tr></table></figure><pre><code>rosparam list 查看参数列表rosparam get [参数名称] 获取参数值rosparam set [参数名称] 设置参数值rosparam dump [文件名称] 将参数保存到指定文件rosparam load [文件名称] 获取保存在指定文件中的参数rosparam delete [参数名称] 删除参数</code></pre><h3 id="rosmsg"><a href="#rosmsg" class="headerlink" title="rosmsg"></a>rosmsg</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tao@ubuntu:~$ rosmsg -h</span><br><span class="line">rosmsg is a command-line tool for displaying information about ROS Message types.</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">rosmsg showShow message description</span><br><span class="line">rosmsg infoAlias for rosmsg show</span><br><span class="line">rosmsg listList all messages</span><br><span class="line">rosmsg md5Display message md5sum</span><br><span class="line">rosmsg packageList messages in a package</span><br><span class="line">rosmsg packagesList packages that contain messages</span><br><span class="line"></span><br><span class="line">Type rosmsg &lt;command&gt; -h for more detailed usage</span><br></pre></td></tr></table></figure><pre><code>rosmsg list 显示所有消息rosmsg show [消息名称] 显示指定消息rosmsg md5 [消息名称] 显示md5sumrosmsg package [功能包名称] 显示用于指定功能包的所有消息rosmsg packages 显示使用消息的所有功能包</code></pre><h3 id="rossrv"><a href="#rossrv" class="headerlink" title="rossrv"></a>rossrv</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tao@ubuntu:~$ rossrv -h</span><br><span class="line">rossrv is a command-line tool for displaying information about ROS Service types.</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">rossrv showShow service description</span><br><span class="line">rossrv infoAlias for rossrv show</span><br><span class="line">rossrv listList all services</span><br><span class="line">rossrv md5Display service md5sum</span><br><span class="line">rossrv packageList services in a package</span><br><span class="line">rossrv packagesList packages that contain services</span><br><span class="line"></span><br><span class="line">Type rossrv &lt;command&gt; -h for more detailed usage</span><br></pre></td></tr></table></figure><pre><code>rossrv list 显示所有服务rossrv show [服务名称] 显示指定的服务信息rossrv md5 [服务名称] 显示md5sumrossrv package [功能包名称] 显示指定的功能包中用到的所有服务rossrv packages 显示使用服务的所有功能包</code></pre><h3 id="rosbag"><a href="#rosbag" class="headerlink" title="rosbag"></a>rosbag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">tao@ubuntu:~$ rosbag -h</span><br><span class="line">Usage: rosbag &lt;subcommand&gt; [options] [args]</span><br><span class="line"></span><br><span class="line">A bag is a file format in ROS for storing ROS message data. The rosbag command can record, replay and manipulate bags.</span><br><span class="line"></span><br><span class="line">Available subcommands:</span><br><span class="line">   check  Determine whether a bag is playable in the current system, or if it can be migrated.</span><br><span class="line">   compress  Compress one or more bag files.</span><br><span class="line">   decompress  Decompress one or more bag files.</span><br><span class="line">   filter  Filter the contents of the bag.</span><br><span class="line">   fix  Repair the messages in a bag file so that it can be played in the current system.</span><br><span class="line">   help  </span><br><span class="line">   info  Summarize the contents of one or more bag files.</span><br><span class="line">   play  Play back the contents of one or more bag files in a time-synchronized fashion.</span><br><span class="line">   record  Record a bag file with the contents of specified topics.</span><br><span class="line">   reindex  Reindexes one or more bag files.</span><br><span class="line"></span><br><span class="line">For additional information, see http:&#x2F;&#x2F;wiki.ros.org&#x2F;rosbag</span><br></pre></td></tr></table></figure><pre><code>rosbag record [选项] [话题名称] 将指定话题的消息记录到bag文件rosbag info [文件名称] 查看bag文件的信息rosbag play [文件名称] 回放指定的bag文件rosbag compress [文件名称] 压缩指定的bag文件rosbag decompress [文件名称] 解压指定的bag文件rosbag filter [输入文件] [输出文件] [选项] 生成一个删除了指定内容的新的bag文件rosbag reindex bag [文件名称] 刷新索引rosbag check bag [文件名称] 检查指定的bag文件是否能在当前系统中回放rosbag fix [输入文件] [输出文件] [选项] 将由于版本不同而无法回放的bag文件修改成可以回放的文件</code></pre><h2 id="QT工具箱"><a href="#QT工具箱" class="headerlink" title="QT工具箱"></a>QT工具箱</h2><p>&emsp;&emsp;ROS提供一个qt架构的后台图形化工具套件<a href="https://wiki.ros.org/rqt_common_plugins">rqt_common_plugins</a>，便于可视化调试和分析。</p><p><strong>安装QT工具箱</strong></p><pre><code>$ sudo apt-get install ros-kinetic-rqt$ sudo apt-get install ros-kinetic-rqt-common-plugins</code></pre><p><strong>常用QT工具</strong></p><ul><li><a href="https://wiki.ros.org/rqt_console?distro=melodic">rqt_console 日志输出工具</a></li><li><a href="https://wiki.ros.org/rqt_graph?distro=melodic">rqt_graph 计算图可视化工具</a></li><li><a href="https://wiki.ros.org/rqt_image_view?distro=melodic">rqt_image_view 图形可视化工具</a></li><li><a href="https://wiki.ros.org/rqt_plot?distro=melodic">rqt_plot 数据绘图工具</a></li><li><a href="https://wiki.ros.org/rqt_reconfigure?distro=melodic">rqt_reconfigure 动态参数配置工具</a></li><li><a href="https://wiki.ros.org/rqt_bag?distro=melodic">rqt_bag 数据记录与回放</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实习项目经验总结1：函数参数和数据类型</title>
      <link href="/2020/05/04/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%931%EF%BC%9A%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E5%92%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>/2020/05/04/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%931%EF%BC%9A%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E5%92%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;5.6正式开始实习阶段，在此记录下实习过程中的经验。</p>    <div id="aplayer-kIJaEmJt" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="001g7xQV0FYa7D" data-server="tencent" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#555"    ></div><a id="more"></a><h2 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h2><p>项目一般使用多种数据类型，不同数据类型作为函数参数如下：</p><h3 id="数组作为函数参数"><a href="#数组作为函数参数" class="headerlink" title="数组作为函数参数"></a>数组作为函数参数</h3><p>参考<a href="https://www.runoob.com/cplusplus/cpp-passing-arrays-to-functions.html">C++ 传递数组给函数</a></p><figure class="highlight c++"><figcaption><span>举例</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 函数声明</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getAverage</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> size)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// 带有 5 个元素的整型数组</span></span><br><span class="line">   <span class="keyword">int</span> balance[<span class="number">5</span>] = &#123;<span class="number">1000</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">17</span>, <span class="number">50</span>&#125;;</span><br><span class="line">   <span class="keyword">double</span> avg;</span><br><span class="line"> </span><br><span class="line">   <span class="comment">// 传递一个指向数组的指针作为参数</span></span><br><span class="line">   avg = getAverage( balance, <span class="number">5</span> ) ;</span><br><span class="line"> </span><br><span class="line">   <span class="comment">// 输出返回值</span></span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;平均值是：&quot;</span> &lt;&lt; avg &lt;&lt; <span class="built_in">endl</span>; </span><br><span class="line">    </span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>运行结果：</strong></p><pre><code>平均值是： 214.4</code></pre><h3 id="结构作为函数参数"><a href="#结构作为函数参数" class="headerlink" title="结构作为函数参数"></a>结构作为函数参数</h3><p>参考<a href="https://www.runoob.com/cplusplus/cpp-data-structures.html">C++ 数据结构</a></p><figure class="highlight c++"><figcaption><span>举例</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printBook</span><span class="params">( struct Books book )</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 声明一个结构体类型 Books </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Books</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">char</span>  title[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  author[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  subject[<span class="number">100</span>];</span><br><span class="line">   <span class="keyword">int</span>   book_id;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">( )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   Books Book1;        <span class="comment">// 定义结构体类型 Books 的变量 Book1</span></span><br><span class="line">   Books Book2;        <span class="comment">// 定义结构体类型 Books 的变量 Book2</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Book1 详述</span></span><br><span class="line">   <span class="built_in">strcpy</span>( Book1.title, <span class="string">&quot;C++ 教程&quot;</span>);</span><br><span class="line">   <span class="built_in">strcpy</span>( Book1.author, <span class="string">&quot;Runoob&quot;</span>); </span><br><span class="line">   <span class="built_in">strcpy</span>( Book1.subject, <span class="string">&quot;编程语言&quot;</span>);</span><br><span class="line">   Book1.book_id = <span class="number">12345</span>;</span><br><span class="line"> </span><br><span class="line">   <span class="comment">// Book2 详述</span></span><br><span class="line">   <span class="built_in">strcpy</span>( Book2.title, <span class="string">&quot;CSS 教程&quot;</span>);</span><br><span class="line">   <span class="built_in">strcpy</span>( Book2.author, <span class="string">&quot;Runoob&quot;</span>);</span><br><span class="line">   <span class="built_in">strcpy</span>( Book2.subject, <span class="string">&quot;前端技术&quot;</span>);</span><br><span class="line">   Book2.book_id = <span class="number">12346</span>;</span><br><span class="line"> </span><br><span class="line">   <span class="comment">// 输出 Book1 信息</span></span><br><span class="line">   printBook( Book1 );</span><br><span class="line"> </span><br><span class="line">   <span class="comment">// 输出 Book2 信息</span></span><br><span class="line">   printBook( Book2 );</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printBook</span><span class="params">( struct Books book )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书标题 : &quot;</span> &lt;&lt; book.title &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书作者 : &quot;</span> &lt;&lt; book.author &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书类目 : &quot;</span> &lt;&lt; book.subject &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书 ID : &quot;</span> &lt;&lt; book.book_id &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>运行结果：</strong></p><pre><code>书标题 : C++ 教程书作者 : Runoob书类目 : 编程语言书 ID : 12345书标题 : CSS 教程书作者 : Runoob书类目 : 前端技术书 ID : 12346</code></pre><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="ROS数据类型"><a href="#ROS数据类型" class="headerlink" title="ROS数据类型"></a>ROS数据类型</h3><p>ROS标准数据类型<a href="http://wiki.ros.org/std_msgs">std_msgs</a><br>ROS文档：<a href="http://docs.ros.org/">http://docs.ros.org/</a></p><h3 id="c-数据类型"><a href="#c-数据类型" class="headerlink" title="c++数据类型"></a>c++数据类型</h3><p><a href="https://www.runoob.com/cplusplus/cpp-data-types.html">C++ 数据类型</a></p><h2 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h2><ol><li>在ROS中，如何将自定义消息msg作为函数参数，目前还没有掌握具体的方法，有待解决！</li></ol>]]></content>
      
      
      <categories>
          
          <category> 实习项目 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>土管项目总结4：VS 2013编译发布web项目</title>
      <link href="/2020/04/24/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%934%EF%BC%9AVS%202013%E7%BC%96%E8%AF%91%E5%8F%91%E5%B8%83web%E9%A1%B9%E7%9B%AE/"/>
      <url>/2020/04/24/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%934%EF%BC%9AVS%202013%E7%BC%96%E8%AF%91%E5%8F%91%E5%B8%83web%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%90%AF%E5%8A%A8%E7%BD%91%E7%AB%99.PNG" width="600" hegiht="460">启动网站(账号：51aspx 密码：1)</center><a id="more"></a><h2 id="安装Visual-Studio-2013"><a href="#安装Visual-Studio-2013" class="headerlink" title="安装Visual Studio 2013"></a>安装Visual Studio 2013</h2><h2 id="打开项目"><a href="#打开项目" class="headerlink" title="打开项目"></a>打开项目</h2><ul><li>Visual Studio 2013选择<code>文件</code> →  <code>打开</code> →  <code>项目/解决方案</code> →  选择 <code>Kangsoft.HRMS.sln</code></li></ul><pre><code>文件路径: `夏老师-土地管理项目源码\OA\OA\Kangsoft.HRMS.sln`</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE.png" width="600" hegiht="460">打开项目</center><ul><li>修改数据库连接地址</li></ul><figure class="highlight xml"><figcaption><span>Web.config</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">connectionStrings</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--服务器IP地址，数据库连接为混合模式的账号密码--&gt;</span></span><br><span class="line">-   <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;default&quot;</span> <span class="attr">connectionString</span>=<span class="string">&quot;Data Source=00.000.000.000;database=Kangsoft.HRMS;uid=sa;pwd=Ahau306306306;&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--本地IP地址，数据库连接为混合模式的账号密码--&gt;</span></span><br><span class="line">+  <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;default&quot;</span> <span class="attr">connectionString</span>=<span class="string">&quot;Data Source=.;database=Kangsoft.HRMS;uid=sa;pwd=1213;&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">connectionStrings</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>选择<code>WeiTe.Web</code>，然后<code>右键</code>，先<code>生成</code>，后<code>发布</code>。、</li></ul><div class="tabs" id="发布web"><ul class="nav-tabs"><li class="tab active"><a href="#发布web-1">发布web：配置文件</a></li><li class="tab"><a href="#发布web-2">发布web：连接</a></li><li class="tab"><a href="#发布web-3">发布web：设置</a></li><li class="tab"><a href="#发布web-4">发布web：预览</a></li></ul><div class="tab-content"><div class="tab-pane active" id="发布web-1"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%8F%91%E5%B8%83web%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.PNG" width="400" hegiht="400" ></div><div class="tab-pane" id="发布web-2"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%8F%91%E5%B8%83web%20%E8%BF%9E%E6%8E%A5.PNG" width="400" hegiht="400" ></div><div class="tab-pane" id="发布web-3"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%8F%91%E5%B8%83web%20%E8%AE%BE%E7%BD%AE.PNG" width="400" hegiht="400" ></div><div class="tab-pane" id="发布web-4"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%8F%91%E5%B8%83web%20%E9%A2%84%E8%A7%88.PNG" width="400" hegiht="400" ></div></div></div><h2 id="IIS添加网站并部署"><a href="#IIS添加网站并部署" class="headerlink" title="IIS添加网站并部署"></a>IIS添加网站并部署</h2><ul><li>打开<code>Internet Information Services (IIS)管理器</code>，右键<code>添加网站</code></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E6%B7%BB%E5%8A%A0%E7%BD%91%E7%AB%99.png" width="600" hegiht="460">打开IIS</center><ul><li>添加网站配置</li></ul><div class="tabs" id="添加网站"><ul class="nav-tabs"><li class="tab active"><a href="#添加网站-1">网站名称和物理路径</a></li><li class="tab"><a href="#添加网站-2">设置特定用户</a></li><li class="tab"><a href="#添加网站-3">连接测试</a></li><li class="tab"><a href="#添加网站-4">选择端口</a></li></ul><div class="tab-content"><div class="tab-pane active" id="添加网站-1"><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E7%89%B9%E5%AE%9A%E7%94%A8%E6%88%B7.PNG" width="400" hegiht="460"></center><div class="note warning">            <p>网站名称：可以随便填写<br>物理路径：为VS2013发布的路径</p>          </div></div><div class="tab-pane" id="添加网站-2"><p> <code>连接为</code>添加<code>特定用户</code>，windows系统用户和密码</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E7%89%B9%E5%AE%9A%E7%94%A8%E6%88%B72.PNG" width="400" hegiht="460"></center></div><div class="tab-pane" id="添加网站-3"><p>选择测试设置，看看是否已授权</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E6%B5%8B%E8%AF%95%E9%93%BE%E6%8E%A5.PNG" width="400" hegiht="460"></center></div><div class="tab-pane" id="添加网站-4"><p> 这里选择<code>8088端口</code></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E6%B7%BB%E5%8A%A0%E7%BD%91%E7%AB%992.PNG" width="400" hegiht="460">添加网站</center></div></div></div><ul><li>端口设置好后，启动网站<a href="http://localhost:8088/">http://localhost:8088/</a></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%90%AF%E5%8A%A8%E7%BD%91%E7%AB%99.PNG" width="600" hegiht="460">启动网站(账号：51aspx 密码：1)</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E8%BF%9B%E5%85%A5%E5%9C%9F%E7%AE%A1%E7%BD%91%E7%AB%99.PNG" width="600" hegiht="460">进入网站</center><h2 id="容易出现的错误"><a href="#容易出现的错误" class="headerlink" title="容易出现的错误"></a>容易出现的错误</h2><h3 id="网站连接SQL出错"><a href="#网站连接SQL出错" class="headerlink" title="网站连接SQL出错"></a>网站连接SQL出错</h3><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E7%BD%91%E7%AB%99%E8%BF%9E%E6%8E%A5sql%E5%87%BA%E9%94%99.PNG" width="600" hegiht="460">网站连接SQL</center><p>这是因为SQL server 未启动，<strong>解决方法：</strong></p><p>&emsp;&emsp;启动<code>SQL Server 配置管理器</code>，主要是下面这两项，查看是否都<code>正在运行</code>：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%BC%80%E5%90%AFsql%E6%9C%8D%E5%8A%A1.PNG" width="400" hegiht="460"></center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%BC%80%E5%90%AFsql%E6%9C%8D%E5%8A%A12.PNG" width="400" hegiht="460"></center><p>如果使用的是服务器，还需要配置防火墙端口和腾讯云服务器安全组</p><p><strong>配置防火墙端口</strong></p><p>查看腾讯云文档<a href="https://cloud.tencent.com/document/product/215/37891">服务器常用端口</a>，可以看到以下内容：</p><blockquote><p>1433端口，是 SQL Server 默认的端口，SQL Server 服务使用两个端口：TCP-1433、UDP-1434。其中1433用于供 SQL Server 对外提供服务，1434用于向请求者返回 SQL Server 使用了哪个 TCP/IP 端口。</p></blockquote><ul><li>启动<code>SQL Server 配置管理器</code></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E4%BF%AE%E6%94%B9TCP.PNG" width="600" hegiht="460">修改TCP端口</center><ul><li>控制面板 → 系统和安全 → windows防火墙 → 高级设置</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E6%96%B0%E5%BB%BA%E5%87%BA%E7%AB%99%E8%A7%84%E5%88%99.PNG" width="600" hegiht="460">新建出站规则</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E9%80%89%E6%8B%A9%E7%89%B9%E5%AE%9A%E7%AB%AF%E5%8F%A3.PNG" width="600" hegiht="460">选择特定端口1433</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%85%81%E8%AE%B8%E9%93%BE%E6%8E%A5.PNG" width="600" hegiht="460">允许链接</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.PNG" width="600" hegiht="460">配置文件</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E5%87%BA%E7%AB%99%E7%AB%AF%E5%8F%A3%E5%90%8D%E7%A7%B0.PNG" width="600" hegiht="460">出站端口名称</center><p><strong>腾讯云服务器安全组</strong></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E6%89%93%E5%BC%80%E5%AE%89%E5%85%A8%E7%BB%84.png" width="600" hegiht="460">打开安全组</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%8F%91%E5%B8%83web/%E6%94%BE%E9%80%9A%E7%AB%AF%E5%8F%A3.png" width="600" hegiht="460">放通端口</center>]]></content>
      
      
      <categories>
          
          <category> 土管项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 土管项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>土管项目总结3：安装Microsoft SQL Server 2012</title>
      <link href="/2020/04/24/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%933%EF%BC%9A%E5%AE%89%E8%A3%85Microsoft%20SQL%20Server%202012/"/>
      <url>/2020/04/24/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%933%EF%BC%9A%E5%AE%89%E8%A3%85Microsoft%20SQL%20Server%202012/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;Microsoft SQL Server 数据库引擎为关系型数据和结构化数据提供了更安全可靠的存储功能。</p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%99%84%E5%8A%A0%E6%88%90%E5%8A%9F.PNG" width="600" hegiht="400" ><a id="more"></a><h2 id="下载-microsoft-sql-server-2012"><a href="#下载-microsoft-sql-server-2012" class="headerlink" title="下载 microsoft sql server 2012"></a>下载 microsoft sql server 2012</h2><p>&emsp;&emsp;打开<a href="https://www.microsoft.com/zh-cn/download/details.aspx?id=29062">Microsoft® SQL Server® 2012 Express</a>官网，一般选择<a href="https://download.microsoft.com/download/3/6/E/36E9CA26-CC2C-4600-8D25-A152F9498FA1/CHS/x64/SQLEXPRADV_x64_CHS.exe">64位</a>下载</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/%E5%AE%89%E8%A3%85sql%202012.PNG" width="600" hegiht="460"></center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/%E9%80%89%E6%8B%A9%E4%B8%8B%E8%BD%BD%E7%A8%8B%E5%BA%8F.PNG" width="600" hegiht="460"></center><div class="note info">            <p>下载工具建议使用<code>破解版IDM</code><br>如果下载缓慢，也可到<a href="https://msdn.itellyou.cn/">MSDN, 我告诉你</a>下载</p>          </div><h2 id="安装-microsoft-sql-server-2012"><a href="#安装-microsoft-sql-server-2012" class="headerlink" title="安装 microsoft sql server 2012"></a>安装 microsoft sql server 2012</h2><div class="tabs" id="安装-microsoft-sql-server-2012"><ul class="nav-tabs"><li class="tab active"><a href="#安装-microsoft-sql-server-2012-1">产品更新</a></li><li class="tab"><a href="#安装-microsoft-sql-server-2012-2">功能选择</a></li><li class="tab"><a href="#安装-microsoft-sql-server-2012-3">★数据库引擎配置★</a></li></ul><div class="tab-content"><div class="tab-pane active" id="安装-microsoft-sql-server-2012-1"><ul><li>选择全新安装</li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/1%20%E5%AE%89%E8%A3%85%E4%B8%AD%E5%BF%83.PNG" width="400" hegiht="400" ><ul><li>可选择产品更新<img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/2%20%E4%BA%A7%E5%93%81%E6%9B%B4%E6%96%B0.PNG" width="400" hegiht="400" ></li></ul></div><div class="tab-pane" id="安装-microsoft-sql-server-2012-2"><ul><li>一般默认设置即可</li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/3%20%E5%8A%9F%E8%83%BD%E9%80%89%E6%8B%A9.png" width="600" hegiht="400" ><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/4%20%E5%AE%9E%E4%BE%8B%E9%85%8D%E7%BD%AE.png" width="600" hegiht="400" ><div class="note info">            <p><strong>注意：</strong>此处应选择默认实例</p>          </div><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/5%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE.png" width="600" hegiht="400" ></div><div class="tab-pane" id="安装-microsoft-sql-server-2012-3"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/6%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%95%E6%93%8E%E9%85%8D%E7%BD%AE.png" width="600" hegiht="400" ><div class="note info">            <p><strong>注意：</strong>此处应选择混合模式<br>    账号：sa (默认)<br>    密码：1213 (自定义设置)</p>          </div><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/7%20%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F.png" width="600" hegiht="400" ></div></div></div><h2 id="Microsoft-SQL-Server-2012-附加数据库"><a href="#Microsoft-SQL-Server-2012-附加数据库" class="headerlink" title="Microsoft SQL Server 2012 附加数据库"></a>Microsoft SQL Server 2012 附加数据库</h2><ul><li>打开 <code>SQL Server Management Studio</code></li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/%E9%80%89%E6%8B%A9SQL.png" width="600" hegiht="400" ><ul><li>连接sql，此时可使用<code>账号：sa 密码：1213</code>进行登录</li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/sql%E8%BF%9E%E6%8E%A5.PNG" width="600" hegiht="400" ><ul><li>数据库附加</li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/%E9%80%89%E6%8B%A9%E9%99%84%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%BA%93.png" width="600" hegiht="400" ><p>MDF文件路径：<code>夏老师-土地管理项目源码\hanshandb\Kangsoft.HRMS</code></p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/%E9%99%84%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%BA%932.PNG" width="600" hegiht="400" ><p>此时可能出现以下错误：</p><div class="tabs" id="附加数据库出错"><ul class="nav-tabs"><li class="tab active"><a href="#附加数据库出错-1">附加数据库出错</a></li><li class="tab"><a href="#附加数据库出错-2">修改权限</a></li><li class="tab"><a href="#附加数据库出错-3">附加数据库</a></li></ul><div class="tab-content"><div class="tab-pane active" id="附加数据库出错-1"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/%E9%99%84%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%BA%E9%94%99.PNG" width="600" hegiht="400" ><p><strong>解决方法：</strong></p><p>&emsp;&emsp;修改目录下两个文件的权限</p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/mdf%E6%96%87%E4%BB%B6.PNG" width="600" hegiht="400" ></div><div class="tab-pane" id="附加数据库出错-2"><ul><li><p>找到要添加数据库的<code>Kangsoft.HRMS.mdf</code>文件，点击右键，选择<code>属性</code>；</p></li><li><p>在<code>属性</code>页面点击<code>安全</code>，单击<code>编辑</code>，选择<code>Authenticated　Users</code>；</p></li><li><p><code>Authenticated　Users</code>权限中选择<code>完全控制</code>，一路点击<code>确定</code>即可。</p></li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90.PNG" width="600" hegiht="400" ><p>按照上述步骤，对<code>Kangsoft.HRMS_log.ldf</code>文件同样修改权限</p></div><div class="tab-pane" id="附加数据库出错-3"><p>再一次附加数据库，可以看到Kangsoft.HRMS数据库附加成功</p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85SQL/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%99%84%E5%8A%A0%E6%88%90%E5%8A%9F.PNG" width="600" hegiht="400" ></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 土管项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 土管项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>土管项目总结2：安装 IIS（互联网信息服务）</title>
      <link href="/2020/04/24/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%932%EF%BC%9A%E5%AE%89%E8%A3%85%20IIS%EF%BC%88%E4%BA%92%E8%81%94%E7%BD%91%E4%BF%A1%E6%81%AF%E6%9C%8D%E5%8A%A1%EF%BC%89/"/>
      <url>/2020/04/24/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%932%EF%BC%9A%E5%AE%89%E8%A3%85%20IIS%EF%BC%88%E4%BA%92%E8%81%94%E7%BD%91%E4%BF%A1%E6%81%AF%E6%9C%8D%E5%8A%A1%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;Internet Information Services（IIS，互联网信息服务），是由微软公司提供的基于运行Microsoft Windows的互联网基本服务。<br>&emsp;&emsp;本章主要介绍从Windows 10和Windows Server 2012 R2服务器两处安装 IIS。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/windows10%20%E6%9C%AC%E5%9C%B0%E6%B5%8F%E8%A7%88IIS.PNG" width="600" hegiht="460"></center><a id="more"></a><h2 id="Windows-10-安装-IIS"><a href="#Windows-10-安装-IIS" class="headerlink" title="Windows 10 安装 IIS"></a>Windows 10 安装 IIS</h2><ul><li>打开<code>控制面板</code>→<code>程序</code>→<code>程序和功能</code>→<code>启用或关闭windows功能</code></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/win10%20%E5%90%AF%E7%94%A8%E6%96%B0%E5%8A%9F%E8%83%BD.PNG" width="600" hegiht="460"></center><ul><li>对话框里选中<code>Internet Information Services</code>,如果不知道选哪些，可以跟我一样，全部都选择。此外，还要安装 <code>.NET Framework 3.5</code>。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/win10%20%E5%90%AF%E7%94%A8IIS.PNG" width="300" hegiht="460"></center><p>&emsp;&emsp;点击<code>确定</code>后，Windows功能开始下载并安装你要的功能的程序，直到出现<code>Windows已完成请求的更改</code>，点击重启电脑。</p><ul><li>在浏览器输入<code>http://localhost/</code>,能打开，就代表安装成功了！</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/windows10%20%E6%9C%AC%E5%9C%B0%E6%B5%8F%E8%A7%88IIS.PNG" width="600" hegiht="460"></center><h2 id="Windows-Server-2012-R2服务器安装-IIS"><a href="#Windows-Server-2012-R2服务器安装-IIS" class="headerlink" title="Windows Server 2012 R2服务器安装 IIS"></a>Windows Server 2012 R2服务器安装 IIS</h2><h3 id="连接服务器"><a href="#连接服务器" class="headerlink" title="连接服务器"></a>连接服务器</h3><div class="tabs" id="连接服务器"><ul class="nav-tabs"><li class="tab active"><a href="#连接服务器-1">查看服务器地址</a></li><li class="tab"><a href="#连接服务器-2">打开win 10 远程桌面连接</a></li></ul><div class="tab-content"><div class="tab-pane active" id="连接服务器-1"><p>&emsp;&emsp;打开腾讯云控制台，查看云服务器地址：</p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80.PNG" width="800" hegiht="400" ><p>可以看到，公网IP为：<code>**.***.***.***</code></p></div><div class="tab-pane" id="连接服务器-2"><ul><li><p>打开win 10 自带的<code>远程桌面连接</code></p>  <img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5.png" width="400" hegiht="400" ></li><li><p>输入IP地址，输入账号密码，连接服务器。</p></li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A52.PNG" width="400" hegiht="400" ></div></div></div><h3 id="安装IIS"><a href="#安装IIS" class="headerlink" title="安装IIS"></a>安装IIS</h3><ul><li>打开<code>服务器管理器</code>，选择<code>添加角色和功能向导</code></li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/%E6%89%93%E5%BC%80%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%99%A8.PNG" width="800" hegiht="600" ><ul><li>一直<code>下一步</code>，选择 <code>web服务器</code>；<code>下一步</code> 选择 <code>.NET Framework 3.5</code></li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/web%E6%9C%8D%E5%8A%A1%E5%99%A8.PNG" width="800" hegiht="600" ><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/.net%203.5.PNG" width="800" hegiht="600" ><ul><li>安装成功后，可以看到以下界面，在浏览器输入<code>http://localhost/</code>,能打开，就代表安装成功了！</li></ul><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/ISS%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F.PNG" width="800" hegiht="600" ><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/%E6%9C%8D%E5%8A%A1%E5%99%A8%20%E6%9C%AC%E5%9C%B0%E6%B5%8F%E8%A7%88IIS.PNG" width="800" hegiht="600" ><h2 id="查看IIS功能"><a href="#查看IIS功能" class="headerlink" title="查看IIS功能"></a>查看IIS功能</h2><p>打开 <code>Internet Information Services (IIS)管理器</code></p><div class="note info">            <p><strong>windows 10：</strong> Windows 管理工具 → Internet Information Services (IIS)管理器<br><strong>服务器：</strong>开始界面 → 已安装**个新应用 → Internet Information Services (IIS)管理器</p>          </div><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/IIS%E7%AE%A1%E7%90%86%E5%99%A8.PNG" width="800" hegiht="600" ><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E5%AE%89%E8%A3%85IIS/IIS%E7%AE%A1%E7%90%86%E5%99%A8%E7%95%8C%E9%9D%A2.PNG" width="800" hegiht="600" ><p>&emsp;&emsp;可以看到，IIS默认的web网站使用的是<code>:80</code>端口。</p>]]></content>
      
      
      <categories>
          
          <category> 土管项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 土管项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>土管项目总结1：项目框架介绍</title>
      <link href="/2020/04/23/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%931%EF%BC%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/"/>
      <url>/2020/04/23/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%931%EF%BC%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;老师的<code>土地管理项目</code>涉及到很多未学过的内容，写这篇文章主要是整理和总结<code>怎么附加SQL数据库</code>、<code>IIS发布web网站</code>、<code>打包手机APK和配置手机服务端</code>、<code>服务器使用</code>等等。其中涉及到的软件和开发环境如下：</p><ul><li><p><strong><a href="https://cloud.tencent.com/">腾讯云服务器</a></strong></p><ul><li><a href="https://www.microsoft.com/en-us/licensing/product-licensing/windows-server-2012-r2?activetab=windows-server-2012-r2-pivot:primaryr2">Windows Server 2012 R2</a></li></ul></li><li><p><strong>网站部分：</strong></p><ul><li><a href="https://www.microsoft.com/zh-cn/download/details.aspx?id=29062">Microsoft SQL Server 2012</a>：提供数据库服务</li><li><a href="https://visualstudio.microsoft.com/zh-hans/vs/older-downloads/">Visual Studio 2013</a>：发布web</li><li><a href="https://www.iis.net/">IIS</a>：部署web网站</li></ul></li><li><p><strong>手机端部分：</strong></p><ul><li><a href="https://www.eclipse.org/downloads/packages/release/kepler/sr2/eclipse-ide-java-ee-developers">Eclipse IDE for Java EE Developers</a> + <a href="https://developer.android.google.cn/studio">Android Studio</a>：编译打包手机APK</li><li><a href="https://tomcat.apache.org/">tomcat 7.0</a> 和 <a href="https://www.oracle.com/java/technologies/javase-jdk8-downloads.html">JDK 8 </a>：部署手机服务端</li></ul></li></ul><a id="more"></a><h2 id="项目框架介绍"><a href="#项目框架介绍" class="headerlink" title="项目框架介绍"></a>项目框架介绍</h2><h3 id="源文件目录"><a href="#源文件目录" class="headerlink" title="源文件目录"></a>源文件目录</h3><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6.PNG" width="400" hegiht="460">项目源码</center><p>可以看到源码分为两个部分：</p><ul><li><code>土地管理</code>：手机客户端和手机服务端</li><li><code>夏老师-土地管理项目源码</code>：web网站和数据库</li></ul><h3 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h3><p>&emsp;&emsp;看了下代码介绍，代码是基于<a href="http://www.51aspx.com/Code/KangSoftSystem">康软人力资源管理系统源码</a>进行修改，源码介绍如下：</p><figure class="highlight c"><figcaption><span>康软人力资源管理系统源码</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">源码描述：</span><br><span class="line">     康软企业人力资源管理系统是一个典型的信息管理系统，本系统是为适应企业管理部门管理人员（目前有在<span class="number">2000</span>多人的大型集团企业正常使用），针对企业信息进行管理的需要而设计开发的软件系统。其主要任务是将企业人力资源管理流程纳入信息化管理，其中信息查询与输出模块是用来实现信息的查询和打印输出功能。在课题研究过程中，对信息查询与输出模块进行了详尽的分析，并描述了设计和编码的实现过程。</span><br><span class="line"></span><br><span class="line">一、运行环境：vs2010+SQL2008</span><br><span class="line">二、浏览器兼容：用的Jquery EasyUI 火狐下测试通过（支持IE，遨游，<span class="number">360</span>等多种浏览器）</span><br><span class="line">三、系统框架：EasyUI+JQuery</span><br><span class="line">四、技术特点：EasyUI,JQuery，Lodop打印控件，微软Chart图表控件,统一权限管理系统（aspx页面完成显示 ashx处理所有请求）</span><br><span class="line"><span class="number">1</span>、采用主流框架：jQuery+EasyUI。（jQuery EasyUI是一组基于jQuery的UI插件集合，而jQuery EasyUI的目标就是帮助web开发者更轻松的打造出功能丰富并且美观的UI界面。开发者不需要编写复杂的javascript，也不需要对css样式有深入的了解，开发者需要了解的只有一些简单的html标签。）</span><br><span class="line"><span class="number">2</span>、Lodop打印控件</span><br><span class="line">目前流行的WEB控件，即可裁剪输出网页内容，也可用JS语句直接打印：</span><br><span class="line"><span class="number">1</span>）用CSS+HTML当指令自由打印，用table快速报表、可按页小计或汇总；</span><br><span class="line"><span class="number">2</span>）用LODOP套打时，操作者可自行拖拽位置、调整样式,自行本地保存调整结果；</span><br><span class="line"><span class="number">3</span>）控件<span class="number">100</span>%安装成功,适应IE、Firefox、Chrome、Opera、Safari等任何浏览器；</span><br><span class="line"><span class="number">4</span>）曾在大型WEB工程中有出色表现，是国内几大软件公司常用工具；</span><br><span class="line"><span class="number">5</span>）下载包很小但有大量样例，含设计界面，可轻松上手；</span><br><span class="line"><span class="number">3</span>、微软Chart图表控件</span><br><span class="line">    Chart控件是公开事件的图表对象，可以绑定到数据。向工作表中添加图表时，Visual Studio Tools <span class="keyword">for</span> Office将创建一个 Chart对象，可以直接对此对象进行编程，而不必遍历 Microsoft Office Excel对象模型。</span><br><span class="line"><span class="number">4</span>、开放的系统平台架构，完善的二次开发支持，无限扩展功能（可联系进行二次开发：叶先生QQ：<span class="number">253769973</span>；李先生QQ :<span class="number">346758561</span>）</span><br><span class="line">五、功能特点</span><br><span class="line"><span class="number">1</span>、系统采用的dao对象使用SQLUtility SQL语句工具类，可根据对象创建SQL语句，对数据的增删改操作不在写繁杂的SQL语句，使开发效率大大提高，增强代码的可用性。</span><br><span class="line"><span class="number">2</span>、权限管理控制模块可通用到其他系统中，是个比较完善的公共权限控制模块，权限控制按角色进行控制，页面权限可控制到按钮。</span><br><span class="line"><span class="number">3</span>、员工档案打印，系统采用Lodop打印控件，可在线打印员工档案信息，打印速度快。并可以进行员工档案的连打（可用时打印多个员工档案信息）。</span><br><span class="line"><span class="number">4</span>、报表统计功能采用主流的微软Chart控件，按照部门进行不同的统计，并进行在线打印。</span><br><span class="line">六、功能模块</span><br><span class="line">康软企业人力资源管理系统</span><br><span class="line"><span class="number">1</span>、人事管理（<span class="number">1.</span>职工管理；<span class="number">2.</span>职工社保；<span class="number">3.</span>奖罚登记；<span class="number">4.</span>职工调动；<span class="number">5.</span>证书管理；<span class="number">6.</span>实习生管理；<span class="number">7.</span>请假管理；<span class="number">8.</span>职工生日）</span><br><span class="line"><span class="number">2</span>、培训管理（<span class="number">1.</span>课程管理；<span class="number">2.</span>内部培训；<span class="number">3.</span>一线工培训）</span><br><span class="line"><span class="number">3</span>、薪酬管理（<span class="number">1.</span>薪酬级别；<span class="number">2.</span>加班标准；<span class="number">3.</span>水电费登记；<span class="number">4.</span>加班登记；<span class="number">5.</span>计件工资；<span class="number">6.</span>计时工资；<span class="number">7.</span>工资档案；<span class="number">8.</span>工资发放）</span><br><span class="line"><span class="number">4</span>、公共查询（<span class="number">1.</span>职工查询；职工查找；通知打印）</span><br><span class="line"><span class="number">5</span>、报表统计（<span class="number">1.</span>性别统计；<span class="number">2.</span>学历比率统计；<span class="number">3.</span>工龄统计；<span class="number">4.</span>年龄比率统计；<span class="number">5.</span>离职率统计；<span class="number">6.</span>添加人员统计；<span class="number">7.</span>人员辞职统计；<span class="number">8.</span>人员统计）</span><br><span class="line"><span class="number">6</span>、系统设置（<span class="number">1.</span>社保比例；<span class="number">2.</span>导航菜单；<span class="number">3.</span>角色管理；<span class="number">4.</span>用户管理；<span class="number">5.</span>系统权限；<span class="number">6.</span>组织结构；<span class="number">7.</span>数据字典；<span class="number">8.</span>社保比例）</span><br><span class="line">注意：</span><br><span class="line">    开发环境为Visual Studio <span class="number">2010</span>,数据库为SQL Server <span class="number">2008</span>，数据库文件在DB_51aspx文件夹中附加就行。</span><br><span class="line">    管理员用户名密码均是:<span class="number">51</span>aspx</span><br><span class="line"></span><br><span class="line">作者：hnkangsoft</span><br><span class="line"></span><br><span class="line">源码下载及讨论地址：http:<span class="comment">//www.51aspx.com/Code/KangSoftSystem</span></span><br></pre></td></tr></table></figure><h2 id="土地管理项目总结"><a href="#土地管理项目总结" class="headerlink" title="土地管理项目总结"></a>土地管理项目总结</h2><pre><code>（1）Windows 10和服务器安装 IIS（互联网信息服务）（2）Windows 10和服务器安装 Microsoft SQL Server 2012（3）Microsoft SQL Server 2012 附加数据库 Kangsoft.HRMS（4）Visual Studio 2013 编译发布web项目（5）IIS部署发布web项目 (6) 配置Android开发环境（7）Eclipse EE 和 Android Studio 打包手机APK (8) tomcat 7.0 和 JDK 8 部署手机服务端 (9) 容易出现的错误及解决方法</code></pre><h2 id="项目存在问题"><a href="#项目存在问题" class="headerlink" title="项目存在问题"></a>项目存在问题</h2><ul><li>项目源码手机客户端基于<code>Android SDK 19</code>制作，而 Android 目前已经更新到<code>Android SDK 29</code>， 版本稍显落后。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%9C%9F%E7%AE%A1%E9%A1%B9%E7%9B%AE/%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D/Android%20SDK.PNG" width="600" hegiht="460">Android SDK 版本</center><ul><li><a href="http://www.c-lodop.com/faq/pp2.html">Lodop页面总提示”未安装”或”请升级”的可能原因</a></li></ul><p>&emsp;&emsp;按照官网说法，可能是因为Chrome、IE等主流浏览器经过多次版本升级，高版本的火狐谷歌不再支持np插件方式，需要修改源码。<br>&emsp;&emsp;此外源码<a href="http://www.c-lodop.com/index.html">Lodop打印控件</a>使用打印和导出表格两种功能，所以两者目前都出现问题。</p><ul><li>源码日期获取函数出现过时警告，需要使用新函数代替。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 土管项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 土管项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Docker安装MySQL、Tomcat</title>
      <link href="/2020/04/19/%E4%BD%BF%E7%94%A8Docker%E5%AE%89%E8%A3%85MySQL%E3%80%81Tomcat/"/>
      <url>/2020/04/19/%E4%BD%BF%E7%94%A8Docker%E5%AE%89%E8%A3%85MySQL%E3%80%81Tomcat/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;使用Docker安装MySQL、Tomcat</p>    <div id="aplayer-coEFsvFW" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="002tl5JZ2FERxL" data-server="tencent" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#555"    ></div><a id="more"></a><h2 id="修改Docker镜像源"><a href="#修改Docker镜像源" class="headerlink" title="修改Docker镜像源"></a>修改Docker镜像源</h2><p>在执行Dockerfile时出现<code>Get https://registry-1.docker.io/v2/</code>错误的解决方案</p><p><strong>解决方案：</strong></p><p>创建daemon.json文件</p><pre><code>$ vim /etc/docker/daemon.json</code></pre><p>写入自定义Docker镜像源</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;registry-mirrors&quot;:[&quot;https:&#x2F;&#x2F;docker.mirrors.ustc.edu.cn&quot;]</span><br><span class="line">或者</span><br><span class="line">&quot;registry-mirrors&quot;:[&quot;https:&#x2F;&#x2F;6kx4zyno.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重启docker</p><pre><code>$ systemctl daemon-reload $ systemctl restart docker</code></pre><h2 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h2><p>Linux上一般会安装Open JDK,关于<a href="http://www.cnblogs.com/sxdcgaq8080/p/7487369.html">OpenJDK和JDK的区别</a></p><p><a href="https://www.oracle.com/java/technologies/javase-jdk14-downloads.html">Java SE Development Kit 14</a></p><h2 id="安装MySQL容器"><a href="#安装MySQL容器" class="headerlink" title="安装MySQL容器"></a>安装MySQL容器</h2><pre><code>$ docker search mysql$ docker pull mysql</code></pre><h2 id="安装Tomcat容器"><a href="#安装Tomcat容器" class="headerlink" title="安装Tomcat容器"></a>安装Tomcat容器</h2><p><a href="https://tomcat.apache.org/download-90.cgi">Tomcat 9.0.34</a></p><p><strong>安装Tomcat容器</strong></p><pre><code>$ docker search tomcat$ docker pull tomcat</code></pre><p><strong>启动Tomcat容器</strong></p><pre><code>$ docker run -d -p 8081:8080 --name tomcat_web --restart=always tomcat</code></pre><h2 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h2><pre><code>$ docker ps        # 查看正在运行容器列表$ docker ps -a    # 查看所有容器列表$ docker stop  容器的id    # 停止运行中的容器$ docker rm 容器id        # 删除一个容器$ docker stop $(docker ps -q) &amp; docker rm $(docker ps -aq)    # 停用并删除全部容器</code></pre>]]></content>
      
      
      <categories>
          
          <category> Centos </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Centos </tag>
            
            <tag> LINUX </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>虚拟机Centos：开启SSH</title>
      <link href="/2020/04/19/%E8%99%9A%E6%8B%9F%E6%9C%BACentos%EF%BC%9A%E5%BC%80%E5%90%AFSSH/"/>
      <url>/2020/04/19/%E8%99%9A%E6%8B%9F%E6%9C%BACentos%EF%BC%9A%E5%BC%80%E5%90%AFSSH/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;虚拟机采用桥接方式固定Centos7 的IP地址。</p><ul><li>虚拟机Centos7 IP：<code>192.168.0.100</code></li><li>主机IP：<code>192.168.0.103</code></li></ul><a id="more"></a><h2 id="查看IP"><a href="#查看IP" class="headerlink" title="查看IP"></a>查看IP</h2><pre><code>$ ifconfig    # Centos 7查看IP$ ipconfig    # 主机查看IP</code></pre><h2 id="安装SSH"><a href="#安装SSH" class="headerlink" title="安装SSH"></a>安装SSH</h2><pre><code>$ yum install openssh-server</code></pre><h3 id="配置ssh"><a href="#配置ssh" class="headerlink" title="配置ssh"></a>配置ssh</h3><pre><code>$ vi /etc/ssh/sshd_config# 监听端口、地址的配置Port 22ListenAddress 0.0.0.0ListenAddress ::# 远程登陆PermitRootLogin yes# 允许用户名密码连接PasswordAuthentication yes# 不配置可能导致远程连接很慢才成功UseDNS no</code></pre><div class="note info">            <p>vi 简单操作</p><ul><li><code>i</code> 进入编辑模式</li><li><code>ESC</code> 回到一般命令模式</li><li><code>↑</code> <code>↓</code> <code>←</code> <code>→</code> 控制光标移动一个字符</li><li><code>:wq</code> 保存并退出</li></ul>          </div><h3 id="开启sshd"><a href="#开启sshd" class="headerlink" title="开启sshd"></a>开启sshd</h3><pre><code>$ sudo service sshd start</code></pre><h3 id="检查ssh是否开启成功"><a href="#检查ssh是否开启成功" class="headerlink" title="检查ssh是否开启成功"></a>检查ssh是否开启成功</h3><pre><code>$ ps -e | grep sshd</code></pre><h3 id="配置开机启动ssh"><a href="#配置开机启动ssh" class="headerlink" title="配置开机启动ssh"></a>配置开机启动ssh</h3><pre><code>$ systemctl enable sshd</code></pre>]]></content>
      
      
      <categories>
          
          <category> Centos </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Centos </tag>
            
            <tag> LINUX </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>虚拟机VMware 15.5安装Centos</title>
      <link href="/2020/04/19/%E8%99%9A%E6%8B%9F%E6%9C%BAVMware%2015.5%E5%AE%89%E8%A3%85Centos/"/>
      <url>/2020/04/19/%E8%99%9A%E6%8B%9F%E6%9C%BAVMware%2015.5%E5%AE%89%E8%A3%85Centos/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="安装Centos-7"><a href="#安装Centos-7" class="headerlink" title="安装Centos 7"></a>安装Centos 7</h2><h2 id="安装Centos-8"><a href="#安装Centos-8" class="headerlink" title="安装Centos 8"></a>安装Centos 8</h2>]]></content>
      
      
      <categories>
          
          <category> Centos </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Centos </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>激光SLAM建图1：激光雷达驱动功能包rplidar_ros</title>
      <link href="/2020/04/10/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE1%EF%BC%9A%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE%E9%A9%B1%E5%8A%A8%E5%8A%9F%E8%83%BD%E5%8C%85/"/>
      <url>/2020/04/10/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE1%EF%BC%9A%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE%E9%A9%B1%E5%8A%A8%E5%8A%9F%E8%83%BD%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp; ROS小车使用的激光雷达为国产思岚<a href="http://www.slamtec.com/cn/Lidar/A1">激光雷达RPLIDAR A1</a>，可360°扫描测距，其测量范围为12米半径，能够完成二维SLAM地图构建。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE/Rplidar%20A1.PNG" width="300" hegiht="400" >（图）思岚激光雷达RPLIDAR A1 </center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE/rplidar_A1.png" width="400" hegiht="400" >（图）坐标关系 </center><ul><li>技术资料：<a href="http://www.slamtec.com/cn/Support#rplidar-a-series">http://www.slamtec.com/cn/Support#rplidar-a-series</a></li><li>ROS包：<a href="https://github.com/slamtec/rplidar_ros">https://github.com/slamtec/rplidar_ros</a></li><li>固件升级：<a href="https://wiki.slamtec.com/pages/viewpage.action?pageId=16154735">https://wiki.slamtec.com/pages/viewpage.action?pageId=16154735</a></li></ul><a id="more"></a><h2 id="扫描测试"><a href="#扫描测试" class="headerlink" title="扫描测试"></a>扫描测试</h2><p><strong>首先查看串口</strong></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE/%E6%9F%A5%E7%9C%8B%E7%AB%AF%E5%8F%A3.PNG" width="600" hegiht="400" >（图）查看串口 </center><p><strong>方法一：</strong><a href="https://github.com/Slamtec/rplidar_sdk/releases">frame_grabber.exe</a>软件测试</p><ul><li>打开<a href="https://github.com/Slamtec/rplidar_sdk/releases">frame_grabber</a>软件，选择串口<code>COM3</code>，波特率<code>57600</code></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE/%E6%89%AB%E6%8F%8F%E6%B5%8B%E8%AF%952.PNG" width="600" hegiht="400" >（图）frame_grabber扫描测试 </center><p><strong>方法二：</strong><a href="http://www.slamtec.com/cn/RoboStudio">RoboStudio</a>软件测试</p><ul><li>打开<a href="http://www.slamtec.com/cn/RoboStudio">RoboStudio</a>软件，手动连接激光雷达</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE/%E6%89%AB%E6%8F%8F%E6%B5%8B%E8%AF%95.PNG" width="600" hegiht="400" >（图）RoboStudio扫描测试 </center><h2 id="功能包rplidar-ros"><a href="#功能包rplidar-ros" class="headerlink" title="功能包rplidar_ros"></a>功能包rplidar_ros</h2><h3 id="安装功能包rplidar-ros"><a href="#安装功能包rplidar-ros" class="headerlink" title="安装功能包rplidar_ros"></a>安装功能包rplidar_ros</h3><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE/rplidar_ros%E5%8A%9F%E8%83%BD%E5%8C%85.PNG" width="600" hegiht="400" >（图）功能包rplidar_ros</center><p><strong>方法一：</strong> 二进制形式安装</p><pre><code>$ sudo apt-get install ros-kinetic-rplidar-ros</code></pre><p><strong>方法二：</strong> 源码形式安装</p><pre><code>$ cs$ git clone https://github.com/Slamtec/rplidar_ros.git$ cm</code></pre><h3 id="运行功能包rplidar-ros"><a href="#运行功能包rplidar-ros" class="headerlink" title="运行功能包rplidar_ros"></a>运行功能包rplidar_ros</h3><p><strong>查看串口</strong></p><pre><code>$ lsusb</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE/lsusb%E6%9F%A5%E7%9C%8B.PNG" width="600" hegiht="400" >（图）lsusb查看串口 </center><p><strong>驱动激光雷达</strong></p><pre><code>$ roslaunch rplidar_ros rplidar.launch        //驱动激光雷达</code></pre><figure class="highlight c"><figcaption><span>rplidar.launch</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">  &lt;node name=<span class="string">&quot;rplidarNode&quot;</span>          pkg=<span class="string">&quot;rplidar_ros&quot;</span>  type=<span class="string">&quot;rplidarNode&quot;</span> output=<span class="string">&quot;screen&quot;</span>&gt;</span><br><span class="line">  &lt;param name=<span class="string">&quot;serial_port&quot;</span>         type=<span class="string">&quot;string&quot;</span> value=<span class="string">&quot;/dev/ttyUSB0&quot;</span>/&gt;</span><br><span class="line">  &lt;param name=<span class="string">&quot;serial_baudrate&quot;</span>     type=<span class="string">&quot;int&quot;</span>    value=<span class="string">&quot;115200&quot;</span>/&gt;&lt;!--A1/A2 --&gt;</span><br><span class="line">  &lt;!--param name=<span class="string">&quot;serial_baudrate&quot;</span>     type=<span class="string">&quot;int&quot;</span>    value=<span class="string">&quot;256000&quot;</span>--&gt;&lt;!--A3 --&gt;</span><br><span class="line">  &lt;param name=<span class="string">&quot;frame_id&quot;</span>            type=<span class="string">&quot;string&quot;</span> value=<span class="string">&quot;laser&quot;</span>/&gt;</span><br><span class="line">  &lt;param name=<span class="string">&quot;inverted&quot;</span>            type=<span class="string">&quot;bool&quot;</span>   value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">  &lt;param name=<span class="string">&quot;angle_compensate&quot;</span>    type=<span class="string">&quot;bool&quot;</span>   value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">  &lt;/node&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></table></figure><p>可以看到节点<code>rplidarNode</code>；串口<code>/dev/ttyUSB0</code>；波特率<code>115200</code>；坐标系<code>laser</code>。</p><p><strong>Rviz显示</strong></p><pre><code>$ roslaunch rplidar_ros view_rplidar.launch        //Rviz显示</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE/%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE%E6%98%BE%E7%A4%BA.PNG" width="600" hegiht="400" >（图）Rviz显示 </center><p><strong>查看发布话题</strong></p><pre><code>$ rostopic list$ rostopic echo /scan</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM%E5%BB%BA%E5%9B%BE/scan%E6%89%AB%E6%8F%8F%E6%95%B0%E6%8D%AE.PNG" width="600" hegiht="400" >（图）查看激光雷达扫描数据 </center>]]></content>
      
      
      <categories>
          
          <category> ROS小车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 激光SLAM建图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>嵌入式开发板学习：超声波</title>
      <link href="/2020/03/31/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF%E5%AD%A6%E4%B9%A0%EF%BC%9A%E8%B6%85%E5%A3%B0%E6%B3%A2/"/>
      <url>/2020/03/31/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF%E5%AD%A6%E4%B9%A0%EF%BC%9A%E8%B6%85%E5%A3%B0%E6%B3%A2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;人们可以听到的声音的频率为2Hz~20KHz，20KHz以上的声音称为超声波 (Ultrasound)。超声波可以在气体、液体及固体中传播，其传播速度不同。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF/%E8%B6%85%E5%A3%B0%E6%B3%A2/%E8%B6%85%E5%A3%B0%E6%B3%A2%E9%A2%91%E7%8E%87%E5%88%86%E5%B8%83.webp" width="400" hegiht="300" >（图）超声波频率分布</center><p>&emsp;&emsp;本次实验采用的<a href="https://www.yahboom.com/study_module/CSB">超声波传感器</a>如下：</p><div class="tabs" id="超声波传感器"><ul class="nav-tabs"><li class="tab active"><a href="#超声波传感器-1">超声波传感器</a></li><li class="tab"><a href="#超声波传感器-2">超声波传感器主要参数</a></li></ul><div class="tab-content"><div class="tab-pane active" id="超声波传感器-1"><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF/%E8%B6%85%E5%A3%B0%E6%B3%A2/%E8%B6%85%E5%A3%B0%E6%B3%A2%E6%A8%A1%E5%9D%97.jpg" width="300" hegiht="300" ></center></div><div class="tab-pane" id="超声波传感器-2"><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF/%E8%B6%85%E5%A3%B0%E6%B3%A2/%E4%B8%BB%E8%A6%81%E5%8F%82%E6%95%B0.png" width="500" hegiht="300" ></center></div></div></div><a id="more"></a><h2 id="超声波测距原理"><a href="#超声波测距原理" class="headerlink" title="超声波测距原理"></a>超声波测距原理</h2><p>&emsp;&emsp;<strong>超声波测距原理：</strong>超声波是一种频率比较高的声音,指向性强.超声波测距的原理是利用超声波在空气中的传播速度为已知，测量声波在发射后遇到障碍物反射回来的时间，根据发射和接收的时间差计算出发射点到障碍物的实际距离。由此可见，超声波测距原理与雷达原理是一样的。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF/%E8%B6%85%E5%A3%B0%E6%B3%A2/%E8%B6%85%E5%A3%B0%E6%B3%A2%E6%B5%8B%E8%B7%9D%E5%8E%9F%E7%90%86.jpg" width="400" hegiht="300" >（图）超声波测距原理</center><p>&emsp;&emsp;测距的公式表示为：<strong>L=C×T</strong></p><pre><code>式中    L 为测量的距离长度；        C 为超声波在空气中的传播速度；        T 为测量距离传播的时间差(T 为发射到接收时间数值的一半)。已知超声波速度C=344m/s (20℃室温)</code></pre><p>&emsp;&emsp;超声波传播速度误差超声波的传播速度受空气的密度所影响，空气的密度越高则超声波的传播速度就越快，而空气的密度又与温度有着密切的关系。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF/%E8%B6%85%E5%A3%B0%E6%B3%A2/%E6%B8%A9%E5%BA%A6%E5%BD%B1%E5%93%8D.webp" width="400" hegiht="300" >（图）温度影响</center><p>&emsp;&emsp;近似公式为：<strong>C=C0+0.607×T℃</strong> </p><pre><code>式中：C0为零度时的声波速度332m/s；T为实际温度(℃)。</code></pre><h2 id="Arduino"><a href="#Arduino" class="headerlink" title="Arduino"></a>Arduino</h2><figure class="highlight c"><figcaption><span>ultrasonic.ino</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> Echo = <span class="number">40</span>;  </span><br><span class="line"><span class="keyword">int</span> Trig = <span class="number">42</span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Serial.begin(<span class="number">9600</span>);     <span class="comment">// 初始化串口</span></span><br><span class="line">  <span class="comment">//初始化超声波引脚  </span></span><br><span class="line">  pinMode(Trig, OUTPUT);   <span class="comment">// 定义超声波输出脚</span></span><br><span class="line">  digitalWrite(Trig, LOW);</span><br><span class="line">  pinMode(Echo, INPUT);    <span class="comment">// 定义超声波输入脚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">float</span> Fdistance, Distance ;</span><br><span class="line">  </span><br><span class="line">  digitalWrite(Trig, HIGH);  <span class="comment">// 给触发脚高电平10μs，这里至少是10μs</span></span><br><span class="line">  delayMicroseconds(<span class="number">10</span>);</span><br><span class="line">  digitalWrite(Trig, LOW);    <span class="comment">// 持续给触发脚低电</span></span><br><span class="line">  </span><br><span class="line">  Fdistance = pulseIn(Echo, HIGH);  <span class="comment">// 读取高电平时间(单位：微秒)</span></span><br><span class="line">  </span><br><span class="line">  Fdistance= Fdistance/<span class="number">58.14</span>;       <span class="comment">//为什么除以58.14等于厘米，  Y米=（X秒*344）/2</span></span><br><span class="line">  <span class="comment">// X秒=（ 2*Y米）/344 ==》X秒=0.0058*Y米 ==》厘米=微秒/58</span></span><br><span class="line">  Distance = Fdistance;</span><br><span class="line">  </span><br><span class="line">    Serial.print(<span class="string">&quot;Distance:&quot;</span>);      <span class="comment">//输出距离（单位：厘米）</span></span><br><span class="line">    Serial.print(Distance);         <span class="comment">//显示距离</span></span><br><span class="line">    Serial.println(<span class="string">&quot;cm&quot;</span>);        <span class="comment">//显示</span></span><br><span class="line"></span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://www.elecfans.com/d/653672.html">超声波传感器测距方法详解</a><br><a href="https://mp.weixin.qq.com/s?src=11&timestamp=1585658939&ver=2250&signature=g75jAUuTnCEYiCvJTLOxmgOmP0McDPTGiohp583oiBaffC7xds6OpKA1FMFEMXCd8Ggf1jzG2JGm48U0jgmrL8u4wLiQ3QdFOJUtQUpVHWAVaVNVkcCoeVSUcu4Y7Jsv&new=1">超声波测距原理与超声测距传感器知识简介</a></p>]]></content>
      
      
      <categories>
          
          <category> 嵌入式开发板学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式开发板 </tag>
            
            <tag> 超声波 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS小车：通过IP地址SSH实现多机通信</title>
      <link href="/2020/03/29/ROS%E5%B0%8F%E8%BD%A6%EF%BC%9A%E9%80%9A%E8%BF%87IP%E5%9C%B0%E5%9D%80SSH%E5%AE%9E%E7%8E%B0%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/"/>
      <url>/2020/03/29/ROS%E5%B0%8F%E8%BD%A6%EF%BC%9A%E9%80%9A%E8%BF%87IP%E5%9C%B0%E5%9D%80SSH%E5%AE%9E%E7%8E%B0%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;ROS采用分布式框架将节点通过松散耦合方式结合起来。节点可分布在不同平台上，通过话题和服务进行通信。对于多个平台，ROS只能存在一个<strong>ROS Master</strong>（即ROS主机),但可存在多个从机。ROS从机可通过局域网不同IP地址SSH方式与主机取得联系。</p><a id="more"></a><h2 id="前提准备"><a href="#前提准备" class="headerlink" title="前提准备"></a>前提准备</h2><ul><li>ROS主机：<strong>虚拟机Vmware</strong>（Ubuntu版本: 16.04 ROS版本: kinect）</li><li>ROS从机：<strong>树莓派3B</strong>（Ubuntu版本: 16.04 ROS版本: kinect）</li></ul><h3 id="虚拟机VMware固定IP地址"><a href="#虚拟机VMware固定IP地址" class="headerlink" title="虚拟机VMware固定IP地址"></a>虚拟机VMware固定IP地址</h3><div class="tabs" id="固定ip地址"><ul class="nav-tabs"><li class="tab active"><a href="#固定ip地址-1">一、查看电脑网卡</a></li><li class="tab"><a href="#固定ip地址-2">二、Vmware选择电脑网卡</a></li><li class="tab"><a href="#固定ip地址-3">三、选择桥接模式</a></li></ul><div class="tab-content"><div class="tab-pane active" id="固定ip地址-1"><p>&emsp;&emsp;电脑网卡信息可从右键<code>计算机或此电脑</code> →  <code>管理</code> 里查看。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/%E7%BD%91%E5%8D%A1.PNG" width="600" hegiht="400">（图）查看网卡</center></div><div class="tab-pane" id="固定ip地址-2"><p>&emsp;&emsp;打开Vmware左上角工具栏 <code>编辑</code> → <code>虚拟网络编辑器</code> → <code>更改设置</code> → <code>选择电脑网卡</code></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/%E5%9B%BA%E5%AE%9AIP1.PNG" width="500" hegiht="200">（图）虚拟网络编辑器</center></div><div class="tab-pane" id="固定ip地址-3"><p>&emsp;&emsp;Ubuntu首页<code>编辑虚拟机设置</code> → <code>网络适配器</code> → <code>桥接模式</code></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/hexo/ROS%E5%B0%8F%E8%BD%A6/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/%E5%9B%BA%E5%AE%9AIP2.PNG" width="500" hegiht="200">（图）编辑虚拟机设置</center></div></div></div><h3 id="安装SSH"><a href="#安装SSH" class="headerlink" title="安装SSH"></a>安装SSH</h3><p>&emsp;&emsp;分别在ROS主机和ROS从机安装SSH，并设置开机自启。</p><pre><code>SSH安装$ sudo apt-get install openssh-serverSSH启动$ service ssh start设置SSH开机自启$ update-rc.d ssh enable</code></pre><h2 id="设置IP地址和主机名"><a href="#设置IP地址和主机名" class="headerlink" title="设置IP地址和主机名"></a>设置IP地址和主机名</h2><h3 id="查看IP地址和主机名"><a href="#查看IP地址和主机名" class="headerlink" title="查看IP地址和主机名"></a>查看IP地址和主机名</h3><pre><code>$ ifconfig    查看IP地址    $ hostname    查看主机名</code></pre><div class="tabs" id="查看ip地址"><ul class="nav-tabs"><li class="tab active"><a href="#查看ip地址-1">PC电脑</a></li><li class="tab"><a href="#查看ip地址-2">树莓派3B</a></li></ul><div class="tab-content"><div class="tab-pane active" id="查看ip地址-1"><p>查看IP地址和主机名<br><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/tao%20ip.PNG" width="500" hegiht="200"></p><p>可以看到：</p><ul><li><strong>IP地址:</strong> <code>192.168.1.114</code></li><li><strong>主机名:</strong> <code>ubuntu</code></li></ul></div><div class="tab-pane" id="查看ip地址-2"><p>查看IP地址和主机名<br><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/pi%20ip.PNG" width="500" hegiht="200"></p><p>可以看到：</p><ul><li><strong>IP地址:</strong> <code>192.168.1.138</code></li><li><strong>主机名:</strong> <code>pi-3b</code></li></ul></div></div></div><h3 id="添加对方-IP地址和主机名"><a href="#添加对方-IP地址和主机名" class="headerlink" title="添加对方 IP地址和主机名"></a>添加对方 IP地址和主机名</h3><ul><li>分别在/etc/hosts文件中添加对方 IP地址和主机名：</li></ul><pre><code>$ sudo gedit /etc/hosts或$ sudo vim /etc/hosts</code></pre><div class="tabs" id="添加对方-ip地址和主机名"><ul class="nav-tabs"><li class="tab active"><a href="#添加对方-ip地址和主机名-1">PC电脑</a></li><li class="tab"><a href="#添加对方-ip地址和主机名-2">树莓派3B</a></li></ul><div class="tab-content"><div class="tab-pane active" id="添加对方-ip地址和主机名-1"><p>添加对方 IP地址和主机名</p><figure class="highlight c"><figcaption><span>/etc/hosts</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># pi-3b</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.138</span>  pi<span class="number">-3b</span></span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="添加对方-ip地址和主机名-2"><p>添加对方 IP地址和主机名</p><figure class="highlight c"><figcaption><span>/etc/hosts</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># ubuntu</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.114</span>  ubuntu</span><br></pre></td></tr></table></figure></div></div></div><ul><li>ping 一下对方，测试网络是否连通：</li></ul><div class="tabs" id="测试连通性"><ul class="nav-tabs"><li class="tab active"><a href="#测试连通性-1">PC电脑</a></li><li class="tab"><a href="#测试连通性-2">树莓派3B</a></li></ul><div class="tab-content"><div class="tab-pane active" id="测试连通性-1"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/ping%20pi.PNG" width="500" hegiht="200"></div><div class="tab-pane" id="测试连通性-2"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/ping%20ubuntu.PNG" width="500" hegiht="200"></div></div></div><p>可以看出，双向网络畅通，说明底层网络通信没有问题。</p><h3 id="使用SSH连接"><a href="#使用SSH连接" class="headerlink" title="使用SSH连接"></a>使用SSH连接</h3><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/SSH%20pi.PNG" width="500" hegiht="200">（图）SSH 连接树莓派3B </center><h2 id="设置-ROS-URI"><a href="#设置-ROS-URI" class="headerlink" title="设置 ROS URI"></a>设置 ROS URI</h2><p>ROS中只存在一个MASTER，可以使用终端命令将设置加入配置文件<code>~/.bashrc</code>中。</p><div class="tabs" id="设置-ros-uri"><ul class="nav-tabs"><li class="tab active"><a href="#设置-ros-uri-1">PC电脑</a></li><li class="tab"><a href="#设置-ros-uri-2">树莓派3B</a></li></ul><div class="tab-content"><div class="tab-pane active" id="设置-ros-uri-1"><p>设置 ROS URI</p><pre><code>$ echo &quot;export ROS_HOSTNAME=ubuntu&quot; &gt;&gt; ~/.bashrc$ echo &quot;export ROS_MASTER_URI=http://ubuntu:11311&quot; &gt;&gt; ~/.bashrc$ source ~/.bashrc</code></pre></div><div class="tab-pane" id="设置-ros-uri-2"><p>设置 ROS URI</p><pre><code>$ echo &quot;export ROS_HOSTNAME=pi-3b&quot; &gt;&gt; ~/.bashrc$ echo &quot;export ROS_MASTER_URI=http://ubuntu:11311&quot; &gt;&gt; ~/.bashrc$ source ~/.bashrc</code></pre></div></div></div><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="设置时间同步"><a href="#设置时间同步" class="headerlink" title="设置时间同步"></a>设置时间同步</h3><p>&emsp;&emsp;在ROS网络中，坐标变换和消息类型都标上了消息戳，因此多机通信时间同步往往很关键。对此将ROS主机和从机都跟互联网服务器上时钟保持一致即可实现数据同步。ROS主机和从机都安装chrony即可。</p><pre><code>$ sudo apt-get install chrony</code></pre><h3 id="安装-turtlesim-功能包"><a href="#安装-turtlesim-功能包" class="headerlink" title="安装 turtlesim 功能包"></a>安装 turtlesim 功能包</h3><p>以乌龟例程为例，测试ROS主机和从机之间是否实现多机通信。</p><pre><code>$ sudo apt-get install ros-kinetic-turtlesim</code></pre><p><strong>PC电脑:</strong></p><pre><code>$ roscore$ rosrun turtlesim turtlesim_node</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/%E4%B9%8C%E9%BE%9F1.PNG" width="500" hegiht="200">（图）乌龟例程</center><p><strong>树莓派3B:</strong></p><p><strong>查看话题：</strong></p><pre><code>$ rostopic list</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/topic.PNG" width="500" hegiht="200">（图）rostopic</center><p><strong>发布Twist命令：</strong></p><pre><code>发布Twist命令一次，控制乌龟行走：$ rostopic pub -1 /turtle1/cmd_vel geometry_msgs/Twist -- &#39;[2,0,0]&#39; &#39;[0,0,1.8]&#39;循环发布Twist命令，控制乌龟行走：$ rostopic pub /turtle1/cmd_vel geometry_msgs/Twist -r 1 -- &#39;[2.0, 0.0, 0.0]&#39; &#39;[0.0, 0.0, -1.8]&#39;</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/pub-r.PNG" width="500" hegiht="200">（图）Twist命令</center><p>测试一下：</p><div class="tabs" id="发布twist命令"><ul class="nav-tabs"><li class="tab active"><a href="#发布twist命令-1">发布Twist命令一次</a></li><li class="tab"><a href="#发布twist命令-2">循环发布Twist命令</a></li></ul><div class="tab-content"><div class="tab-pane active" id="发布twist命令-1"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/%E5%91%BD%E4%BB%A4%201%E6%AC%A1.PNG" width="400" hegiht="200"></div><div class="tab-pane" id="发布twist命令-2"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/%E5%91%BD%E4%BB%A4%20n%E6%AC%A1.PNG" width="400" hegiht="200"></div></div></div><p>当然也可以通过按键控制控制乌龟行走：</p><pre><code>$ rosrun turtlesim turtle_teleop_key</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%A4%9A%E6%9C%BA%E9%80%9A%E4%BF%A1/turtle_teleop_key.PNG" width="500" hegiht="200">（图）turtle_teleop_key</center><p>至此，ROS多机通信配置完成。ROS主机运行乌龟节点<code>turtlesim_node</code>，从机上也能看到发布的话题以及通过命令控制主机上的乌龟行走。</p>]]></content>
      
      
      <categories>
          
          <category> ROS小车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 多机通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>嵌入式开发板学习：流水灯</title>
      <link href="/2020/03/28/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF%E5%AD%A6%E4%B9%A0%EF%BC%9A%E6%B5%81%E6%B0%B4%E7%81%AF/"/>
      <url>/2020/03/28/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF%E5%AD%A6%E4%B9%A0%EF%BC%9A%E6%B5%81%E6%B0%B4%E7%81%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;LED(light-emitting diode)，即发光二极管，俗称 LED 小灯。板子上一般用的是普通的贴片发光二极管，具有单向导电性。工作电流一般在 1mA～20mA 之间，电流越大LED小灯会越亮，若电流过大，会烧坏LED小灯。因此需要串联一个电阻，达到限流作用，这个电阻通常称为“限流电阻”。发光二极管通常又分为<strong>直插式</strong>（<code>长脚为阳极，短脚为阴极</code>）和<strong>贴片式</strong>（<code>彩色标记一端为阴极</code>）两种。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF/LED/%E4%BA%8C%E6%9E%81%E7%AE%A1%E7%A7%8D%E7%B1%BB.PNG" width="400" hegiht="300" >（图）发光二极管</center><a id="more"></a><h2 id="LED灯点亮原理"><a href="#LED灯点亮原理" class="headerlink" title="LED灯点亮原理"></a>LED灯点亮原理</h2><p>&emsp;&emsp;以<code>清翔QX-mini51开发板</code>为例，流水灯模块为8个贴片LED灯。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF/LED/QX-mini51%E5%8A%9F%E8%83%BD%E6%8F%8F%E8%BF%B0.jpg" width="400" hegiht="300" >（图）QX-mini51功能描述</center><p>&emsp;&emsp;根据提供的原理图可以看出，8个LED灯左侧接电源VCC（5V或3.3V），右侧接排阻和单片机<code>P10~P17</code>引脚。因为<strong>单片机是可以编程控制的</strong>，如果让 <code>P10</code>这个引脚输出一个<strong>高电平（1）</strong>，则<code>LED1</code>左右两侧电压相同，没有电压差就不会产生电流，所以<code>LED1</code>小灯就不会亮；如果让<code>P10</code>这个引脚输出一个<strong>低电平（0）</strong>，电路导通就会有电流通过，<code>LED1</code>小灯因为有了电流通过，所以就会直接发光。其它LED等同理。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E6%9D%BF/LED/%E6%B5%81%E6%B0%B4%E7%81%AF%E6%A8%A1%E5%9D%97.PNG" width="600" hegiht="300" >（图）LED流水灯模块 </center><h2 id="点亮LED灯"><a href="#点亮LED灯" class="headerlink" title="点亮LED灯"></a>点亮LED灯</h2><p><strong>单片机编程完成I/O口控制</strong>：</p><ul><li>低电平：<code>0</code>；高电平：<code>1</code>。单片机在一上电时，所有I/O口默认为高电平状态。</li><li><code>P1</code>为8个LED灯全部I/O口，<code>P1^0 ~ P1^7</code> 分别对应<code>LED1 ~ LED8</code>的I/O口。</li><li>可使用十六进制形式控制八个LED灯，例：<code>P1=0xaa（二进制：10101010）</code> 表示LED1、LED3、LED5、LED7灭； LED2、LED4、LED6、LED8亮</li></ul><figure class="highlight c"><figcaption><span>led.c</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*********************************************************************************</span></span><br><span class="line"><span class="comment">* 【实验平台】： 清翔QX-mini51开发板</span></span><br><span class="line"><span class="comment">* 【外部晶振】： 11.0592mhz</span></span><br><span class="line"><span class="comment">* 【主控芯片】： STC89C52RC</span></span><br><span class="line"><span class="comment">* 【编译环境】： Keil μVisio4</span></span><br><span class="line"><span class="comment">* 【程序功能】： 第一个LED灯闪烁                  </span></span><br><span class="line"><span class="comment">* 【使用说明】： 注意先用跳线冒将J2短接，使用跑马灯模块</span></span><br><span class="line"><span class="comment">*  P1为8个全部LED灯，P1^0 ~ P1^7 分别对应LED1 ~ LED8</span></span><br><span class="line"><span class="comment">**********************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;reg51.h&gt;   //此文件中定义了51的一些特殊功能寄存器</span></span></span><br><span class="line">sbit LED = P1^<span class="number">0</span> ;  <span class="comment">// 声明单片机P10引脚 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">()</span></span>;  <span class="comment">//声明延时函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*******主函数*************/</span> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">  LED = <span class="number">0</span>; <span class="comment">//置P0口为低电平(0或0x00)  </span></span><br><span class="line">  delay(); <span class="comment">// 调用延时程序</span></span><br><span class="line">  LED = <span class="number">1</span>; <span class="comment">//置P0口为高电平(1或0xff) </span></span><br><span class="line">  delay(); <span class="comment">// 调用延时程序</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******延时函数*************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1000</span>; i &gt; <span class="number">0</span>; i--)   </span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">110</span>; j &gt; <span class="number">0</span>; j--);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="流水灯"><a href="#流水灯" class="headerlink" title="流水灯"></a>流水灯</h2><h3 id="使用位移方法进行流水等控制"><a href="#使用位移方法进行流水等控制" class="headerlink" title="使用位移方法进行流水等控制"></a>使用位移方法进行流水等控制</h3><p><strong>位移操作</strong></p><ul><li><code>&lt;&lt; 左移</code> 最高位丢弃，最低位补0，其余位依次左移 移位前是：11110110，移位后：11011010</li><li><code>&gt;&gt; 右移</code> 最低位丢弃，最高位补0，其余位依次右移 移位前是：11110110，移位后：00111101</li></ul><p><strong>循环位移函数</strong></p><ul><li><code>_cror_（x,y)</code>含义是二进制数x右移动y位</li><li><code>_crol_ 循环左移</code> 最高位移入最低位，其余位依次左移  移位前是：11110110，移位后：11101101</li><li><code>_cror_ 循环右移</code> 最低位移入最高位，其余位依次右移  移位前是：11110110，移位后：01111011</li></ul><p><strong>while(1)循环用法</strong></p><ul><li>C语言中，0为假，非0为真。所以while(1)判断表达式为真，会一直执行循环。</li><li><code>while(1) 后接循环体程序</code> 一直执行循环体程序。</li><li><code>while(1)；放在程序最后</code> 一直执行这条语句且无法跳出循环，从而达到程序停止效果。注意有分号<code>；</code></li></ul><figure class="highlight c"><figcaption><span>流水灯.c</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*********************************************************************************</span></span><br><span class="line"><span class="comment">* 【实验平台】： 清翔QX-mini51开发板</span></span><br><span class="line"><span class="comment">* 【外部晶振】： 11.0592mhz</span></span><br><span class="line"><span class="comment">* 【主控芯片】： STC89C52RC</span></span><br><span class="line"><span class="comment">* 【编译环境】： Keil μVisio4</span></span><br><span class="line"><span class="comment">* 【程序功能】： 8个LED灯依次闪烁（循环左移结束，再循环右移)                  </span></span><br><span class="line"><span class="comment">* 【使用说明】： 注意先用跳线冒将J2短接，使用跑马灯模块</span></span><br><span class="line"><span class="comment">*  P1为8个全部LED灯，P1^0 ~ P1^7 分别对应LED1 ~ LED8</span></span><br><span class="line"><span class="comment">**********************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;reg52.h&gt;   //此文件中定义了51的一些特殊功能寄存器</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;intrins.h&gt;//51自带的移位库函数</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uchar unsigned char</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uint unsigned int</span></span><br><span class="line">uint n;</span><br><span class="line">uchar LED;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">(uint i)</span></span>;  <span class="comment">//声明延时函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*******主函数*************/</span> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">  LED = <span class="number">0xfe</span>; <span class="comment">//1111 1110</span></span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">   P1 = LED;  <span class="comment">// 先点亮LED1</span></span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">0</span>; n &lt; <span class="number">7</span>; n++)&#123;</span><br><span class="line">        P1 = _crol_(P1,<span class="number">1</span>);      <span class="comment">//左移动一位</span></span><br><span class="line">        delay(<span class="number">500</span>); <span class="comment">// 调用延时程序,约500ms</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">0</span>; n &lt; <span class="number">7</span>; n++)&#123;</span><br><span class="line">        P1 = _cror_(P1,<span class="number">1</span>);      <span class="comment">//右移动一位</span></span><br><span class="line">        delay(<span class="number">500</span>); <span class="comment">// 调用延时程序,约500ms</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******延时函数 ms*************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">(uint i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    uint j;</span><br><span class="line">    <span class="keyword">for</span>(i; i &gt; <span class="number">0</span>; i--)   </span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">110</span>; j &gt; <span class="number">0</span>; j--);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 嵌入式开发板学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式开发板 </tag>
            
            <tag> 流水灯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>激光SLAM算法：cartographer</title>
      <link href="/2020/03/24/%E6%BF%80%E5%85%89SLAM%E7%AE%97%E6%B3%95%EF%BC%9Acartographer/"/>
      <url>/2020/03/24/%E6%BF%80%E5%85%89SLAM%E7%AE%97%E6%B3%95%EF%BC%9Acartographer/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><center><img src="https://google-cartographer-ros.readthedocs.io/en/latest/_images/demo_2d.gif" width="800" hegiht="600" ></center><a id="more"></a><h2 id="cartographer功能包"><a href="#cartographer功能包" class="headerlink" title="cartographer功能包"></a>cartographer功能包</h2><h3 id="cartographer安装"><a href="#cartographer安装" class="headerlink" title="cartographer安装"></a>cartographer安装</h3><p>&emsp;&emsp;由于cartographer功能包与ROS集成，但没有提供二进制安装包，需要采用源码安装，可参考<a href="https://google-cartographer-ros.readthedocs.io/en/latest/compilation.html#building-installation">Cartographer</a> 官网安装教程。</p><p><strong>（1）安装工具</strong></p><p>&emsp;&emsp;In order to build Cartographer ROS, we recommend using wstool and rosdep. For faster builds, we also recommend using Ninja.</p><pre><code>$ sudo apt-get update$ sudo apt-get install -y python-wstool python-rosdep ninja-build</code></pre><p><strong>（2）初始化命令空间并安装依赖</strong></p><p>&emsp;&emsp;Create a new cartographer_ros workspace in ‘catkin_ws’.</p><pre><code>$ mkdir catkin_ws$ cd catkin_ws$ wstool init src$ wstool merge -t src https://raw.githubusercontent.com/googlecartographer/cartographer_ros/master/cartographer_ros.rosinstall$ wstool update -t src</code></pre><div class="note warning">            <p>在进行 <code>wstool update -t src</code> 这一步之前，需要替换ceres-solver 源。（Ctrl+h 是否查看隐藏文件）</p><pre><code>$ gedit catkin_ws/src/.rosinstall</code></pre><p>将<code>https://ceres-solver.googlesource.com/ceres-solver.git</code><br>改为<code>https://github.com/ceres-solver/ceres-solver.git</code></p>          </div><p><strong>（3）安装proto3以及相关功能包</strong></p><p>&emsp;&emsp;Install cartographer_ros’ dependencies (proto3 and deb packages). The command ‘sudo rosdep init’ will print an error if you have already executed it since installing ROS. This error can be ignored.</p><pre><code>$ src/cartographer/scripts/install_proto3.sh$ sudo rosdep init$ rosdep update$ rosdep install --from-paths src --ignore-src --rosdistro=$&#123;ROS_DISTRO&#125; -y</code></pre><p>正确安装完成后会出现：<code>#All required rosdeps installed successfully</code>提示。</p><p><strong>（4）编译并安装</strong></p><p>&emsp;&emsp;Build and install.</p><pre><code>$ catkin_make_isolated --install --use-ninja$ source install_isolated/setup.bash</code></pre><div class="note warning">            <p>注意：<code>catkin_make_isolated --install --use-ninja</code>一步可能出现虚拟内存耗尽问题。可扩展 swap 交换空间内存解决。</p>          </div><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="2D-SLAM-demo"><a href="#2D-SLAM-demo" class="headerlink" title="2D SLAM demo"></a>2D SLAM demo</h3><ul><li>Download the 2D backpack example bag.</li></ul><pre><code>$ wget -P ~/Downloads https://storage.googleapis.com/cartographer-public-data/bags/backpack_2d/cartographer_paper_deutsches_museum.bag</code></pre><ul><li>Launch the 2D backpack demo.</li></ul><pre><code>$ roslaunch cartographer_ros demo_backpack_2d.launch bag_filename:=$&#123;HOME&#125;/Downloads/cartographer_paper_deutsches_museum.bag</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM/cartographer/2D%20SLAM%20demo.png" width="600" hegiht="400" >(图) 2D SLAM demo</center><p><strong>map save</strong></p><pre><code>$ cd catkin_ws$ source install_isolated/setup.bash$ rosservice call /finish_trajectory 0$ rosservice call /write_state &quot;&#123;filename: &#39;$&#123;HOME&#125;/Downloads/mymap.pbstream&#39;&#125;&quot;$ rosrun cartographer_ros cartographer_pbstream_to_ros_map -map_filestem=$&#123;HOME&#125;/Downloads/mymap -pbstream_filename=$&#123;HOME&#125;/Downloads/mymap.pbstream -resolution=0.05</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM/cartographer/%E4%BF%9D%E5%AD%98%E5%9C%B0%E5%9B%BE%E7%BB%88%E7%AB%AF.png" width="400" hegiht="400" >(图) 终端显示</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM/cartographer/%E4%BF%9D%E5%AD%98%E5%9C%B0%E5%9B%BE.png" width="400" hegiht="400" >(图) 地图保存</center><h3 id="3D-SLAM-demo"><a href="#3D-SLAM-demo" class="headerlink" title="3D SLAM demo"></a>3D SLAM demo</h3><ul><li>Download the 3D backpack example bag.</li></ul><pre><code>$ wget -P ~/Downloads https://storage.googleapis.com/cartographer-public-data/bags/backpack_3d/with_intensities/b3-2016-04-05-14-14-00.bag</code></pre><ul><li>Launch the 3D backpack demo.</li></ul><pre><code>$ roslaunch cartographer_ros demo_backpack_3d.launch bag_filename:=$&#123;HOME&#125;/Downloads/b3-2016-04-05-14-14-00.bag</code></pre><h3 id="Revo-LDS-demo"><a href="#Revo-LDS-demo" class="headerlink" title="Revo LDS demo"></a>Revo LDS demo</h3><ul><li>Download the Revo LDS backpack example bag.</li></ul><pre><code>$ wget -P ~/Downloads https://storage.googleapis.com/cartographer-public-data/bags/revo_lds/cartographer_paper_revo_lds.bag</code></pre><ul><li>Launch the Revo LDS backpack demo.</li></ul><pre><code>$ roslaunch cartographer_ros demo_revo_lds.launch bag_filename:=$&#123;HOME&#125;/Downloads/cartographer_paper_revo_lds.bag</code></pre><h2 id="安装常见问题"><a href="#安装常见问题" class="headerlink" title="安装常见问题"></a>安装常见问题</h2><h3 id="安装-protobuf-最新版"><a href="#安装-protobuf-最新版" class="headerlink" title="安装 protobuf 最新版"></a>安装 protobuf 最新版</h3><pre><code>$ sudo apt-get install autoconf automake libtool curl make g++ unzip  #安装依赖$ git clone  https://github.com/google/protobuf  #下载protobuf源码$ cd protobuf$ ./autogen.sh$ ./configure$ make  #编译$ make check$ sudo make install$ sudo ldconfig   #用于刷新共享库的缓存的 $ protoc --version  #查看protobuf版本号</code></pre><h3 id="扩展-swap-交换空间内存"><a href="#扩展-swap-交换空间内存" class="headerlink" title="扩展 swap 交换空间内存"></a>扩展 swap 交换空间内存</h3><pre><code>#下面以增加2G空间为例，count表示增加的块数量（文件大小=bs*count）$ dd if =/dev/zero of=/root/swapfile bs=1M count=2048#格式化交换分区文件 $ sudo mkswap /root/swapfile #启用交换分区文件$ sudo swapon /root/swapfile#保存以上配置，重启后仍然有效，需要在文件/etc/fstab中添加下面一行$ /root/swapfile swap swap defaults 0 0</code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://www.digitalocean.com/community/tutorials/how-to-add-swap-space-on-ubuntu-16-04">How To Add Swap Space on Ubuntu 16.04</a></li><li><a href="https://google-cartographer-ros.readthedocs.io/en/latest/index.html">Cartographer ROS</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 激光SLAM算法 </category>
          
          <category> cartographer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 激光SLAM算法 </tag>
            
            <tag> cartographer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>激光SLAM算法：gmapping</title>
      <link href="/2020/03/24/%E6%BF%80%E5%85%89SLAM%E7%AE%97%E6%B3%95%EF%BC%9Agmapping/"/>
      <url>/2020/03/24/%E6%BF%80%E5%85%89SLAM%E7%AE%97%E6%B3%95%EF%BC%9Agmapping/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%BF%80%E5%85%89SLAM/gmapping/gmapping%E5%BB%BA%E5%9B%BE%E6%95%88%E6%9E%9C.png" width="500" hegiht="400" ></center><a id="more"></a><h2 id="gmapping-功能包"><a href="#gmapping-功能包" class="headerlink" title="gmapping 功能包"></a>gmapping 功能包</h2><h3 id="gmapping-安装"><a href="#gmapping-安装" class="headerlink" title="gmapping 安装"></a>gmapping 安装</h3><p><strong>方法一：</strong>github 安装<a href="https://github.com/ros-perception/slam_gmapping">slam_gmapping</a>和<a href="https://github.com/ros-perception/openslam_gmapping">openslam_gmapping</a>并编译</p><pre><code>$ cs$ git clone https://github.com/ros-perception/slam_gmapping$ git clone https://github.com/ros-perception/openslam_gmapping$ cm</code></pre><p><strong>方法二：</strong>ROS 软件源已经集成 gmapping 相关功能包文件，可直接使用命令安装</p><pre><code>$ sudo apt-get install ros-kinetic-gmapping</code></pre><h3 id="gmapping-介绍"><a href="#gmapping-介绍" class="headerlink" title="gmapping 介绍"></a>gmapping 介绍</h3><p>参考 ROS wiki  <a href="http://wiki.ros.org/gmapping?distro=kinetic">gmapping</a></p><p><strong>节点名称：</strong> <a href="http://wiki.ros.org/slam_gmapping?distro=kinetic">slam_gmapping</a></p><p><strong>订阅话题：</strong></p><ul><li>tf (<a href="http://docs.ros.org/api/tf/html/msg/tfMessage.html">tf/tfMessage</a>) 用于/laser /base_link /odom 坐标之间的变换</li><li>scan (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/LaserScan.html">sensor_msgs/LaserScan</a>) 激光雷达扫描数据</li></ul><p><strong>发布话题：</strong></p><ul><li>map_metadata (<a href="http://docs.ros.org/api/nav_msgs/html/msg/MapMetaData.html">nav_msgs/MapMetaData</a>) 发布地图Meta数据</li><li>map (<a href="http://docs.ros.org/api/nav_msgs/html/msg/OccupancyGrid.html">nav_msgs/OccupancyGrid</a>) 发布地图栅格数据</li><li>~entropy (<a href="http://docs.ros.org/api/std_msgs/html/msg/Float64.html">std_msgs/Float64</a>) 估计机器人姿态分布熵（更高的值表示更大的不确定性）。</li></ul><p><strong>服务：</strong></p><ul><li>dynamic_map (<a href="http://docs.ros.org/api/nav_msgs/html/srv/GetMap.html">nav_msgs/GetMap</a>) 获取地图数据</li></ul><p><strong>坐标变换：</strong></p><ul><li><p>Required tf Transforms：<code>laser → base_link → odom</code></p></li><li><p>Provided tf Transforms：<code>map → odom</code></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 激光SLAM算法 </category>
          
          <category> gmapping </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 激光SLAM算法 </tag>
            
            <tag> gmapping </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编程语言基础篇：运算符和表达式</title>
      <link href="/2020/03/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%9A%E8%BF%90%E7%AE%97%E7%AC%A6%E5%92%8C%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2020/03/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%9A%E8%BF%90%E7%AE%97%E7%AC%A6%E5%92%8C%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> 编程语言 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 编程语言 </tag>
            
            <tag> C/C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编程语言基础篇：变量与常量</title>
      <link href="/2020/03/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%9A%E5%8F%98%E9%87%8F%E4%B8%8E%E5%B8%B8%E9%87%8F/"/>
      <url>/2020/03/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%9A%E5%8F%98%E9%87%8F%E4%B8%8E%E5%B8%B8%E9%87%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> 编程语言 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 编程语言 </tag>
            
            <tag> C/C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编程语言基础篇：数据类型</title>
      <link href="/2020/03/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>/2020/03/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E6%8F%90%E9%AB%98/%E6%8F%90%E9%AB%98%E7%AF%87%E8%83%8C%E6%99%AF.jpeg" width="800" hegiht="600" ></center><a id="more"></a><h2 id="标识符与关键字"><a href="#标识符与关键字" class="headerlink" title="标识符与关键字"></a>标识符与关键字</h2><h3 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h3><p>&emsp;&emsp;标识符是用来标识变量、函数，或任何其他用户自定义项目的名称。<code>C 规定，标识符只能是字母(A～Z，a～z)、数字(0～9)、下划线(_)组成的字符串，并且其第一个字符必须是字母或下划线。 </code>下面列出几个有效的标识符：</p><pre><code>mohd       zara    abc   move_name  a_123myname50   _temp   j     a23b9      retVal</code></pre><div class="note warning">            <p>C 是区分大小写的编程语言。因此，在 C 中，Manpower 和 manpower 是两个不同的标识符。<br>标识符虽然可由程序员随意定义，但标识符是用于标识某个量的符号。因此，命名应尽量有相应的意义，以便于阅读理解，作到“顾名思义”。</p>          </div><h3 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h3><p>&emsp;&emsp;关键字是由Ｃ语言规定的具有特定意义的字符串，通常也称为保留字。<code>用户定义的标识符不应与关键字相同。</code>ANSI C 标准有32个关键字，34种运算。下表列出了常见的32个 C 中保留字：</p><table><thead><tr><th align="center">32个关键字</th><th align="center"></th><th align="center"></th><th align="center"></th><th align="center"></th><th align="center"></th><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">auto</td><td align="center">double</td><td align="center">int</td><td align="center">struct</td><td align="center">break</td><td align="center">else</td><td align="center">long</td><td align="center">switch</td></tr><tr><td align="center">case</td><td align="center">enum</td><td align="center">register</td><td align="center">typedef</td><td align="center">char</td><td align="center">extern</td><td align="center">return</td><td align="center">union</td></tr><tr><td align="center">const</td><td align="center">float</td><td align="center">short</td><td align="center">unsigned</td><td align="center">continue</td><td align="center">for</td><td align="center">signed</td><td align="center">void</td></tr><tr><td align="center">default</td><td align="center">goto</td><td align="center">sizeof</td><td align="center">volatile</td><td align="center">do</td><td align="center">if</td><td align="center">while</td><td align="center">static</td></tr></tbody></table><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">C语言数据类型</a></li><li class="tab"><a href="#tab标签列表-2">C++数据类型</a></li><li class="tab"><a href="#tab标签列表-3">Python语言数据类型</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80%E7%AF%87%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/c%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.PNG" width="400" hegiht="400" >(图) C语言数据类型</center><p><strong>注：</strong>其中*为C99增加的</p></div><div class="tab-pane" id="tab标签列表-2"><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80%E7%AF%87%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/c%2B%2B%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.PNG" width="400" hegiht="400" >(图) C++数据类型</center></div><div class="tab-pane" id="tab标签列表-3"><pre><code>标签页3文本内容&lt;img src=&quot;https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/3.jpg&quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></pre></div></div></div><p>&emsp;&emsp;每种数据类型的存储大小、取值范围由编译器自行决定的。对于C语言来说，在Visual C++编译器中取值范围如下：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80%E7%AF%87%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E6%95%B0%E6%8D%AE%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4.png" width="600" hegiht="400" >(图) C语言取值范围</center><p>&emsp;&emsp;在实际应用过程中，有些数据只取正值，需要在数据类型前加上<code>unsigned</code>表示无符号型数据，如学号、年龄等。当然对应的<code>singned</code>表示有符号型数据，二进制最高位代表符号（0为正，1为负）。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80%E7%AF%87%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E6%97%A0%E7%AC%A6%E5%8F%B7%E5%9E%8B%E6%95%B0%E6%8D%AE.PNG" width="600" hegiht="400" >(图) unsigned/signed型数据</center><p>&emsp;&emsp;以整型数据为例，Visual C++为其分配4个字节（1字节=8位，共32位），以补码形式存放在存储单元中。正数的补码为二进制形式；如果是负数，先将此数绝对值的二进制按位取反，再加1。5和-5的补码用两字节形式表示如下：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80%E7%AF%87%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E6%95%B4%E5%9E%8B%E6%95%B0%E6%8D%AE%E8%A1%A5%E7%A0%81.PNG" width="400" hegiht="400" >(图) 整型数据补码</center><p>&emsp;&emsp;对于字符型数据来说，目前普遍采用ANSCII字符集。</p><ul><li>字符’1’的对应的十进制数值为49，二进制为0110001</li><li>字符’A’的对应的十进制数值为65，二进制为1000001</li><li>字符’a’的对应的十进制数值为97，二进制为1100001</li></ul><div class="note warning">            <p>字符’1’和数值1是两种数据形式。</p>          </div><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80%E7%AF%87%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/ANSCII%E5%AD%97%E7%AC%A6%E8%A1%A8.jpg" width="600" hegiht="400" >(图) ANSCII字符表</center><h2 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h2><ul><li><strong>十进制DEC：</strong>采用<code>0，1，2，3，4，5，6，7、8，9</code>，逢10进1。</li><li><strong>二进制BIN：</strong>采用<code>0，1</code>，逢2进1。</li><li><strong>八进制OCT：</strong>采用<code>0，1，2，3，4，5，6，7</code>，逢8进1。</li><li><strong>十六进制HEX：</strong>采用<code>0，1，2，3，4，5，6，7、8、9、0、A、B、C、D、E、F</code>，逢16进1。</li></ul><table><thead><tr><th align="center">十进制DEC</th><th align="center">二进制BIN</th><th align="center">八进制OCT(0c)</th><th align="center">十六进制HEX(0x或0X)</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">0000 0000</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">1</td><td align="center">0000 0001</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="center">2</td><td align="center">0000 0010</td><td align="center">2</td><td align="center">2</td></tr><tr><td align="center">3</td><td align="center">0000 0011</td><td align="center">3</td><td align="center">3</td></tr><tr><td align="center">4</td><td align="center">0000 0100</td><td align="center">4</td><td align="center">4</td></tr><tr><td align="center">5</td><td align="center">0000 0101</td><td align="center">5</td><td align="center">5</td></tr><tr><td align="center">6</td><td align="center">0000 0110</td><td align="center">6</td><td align="center">6</td></tr><tr><td align="center">7</td><td align="center">0000 0111</td><td align="center">7</td><td align="center">6</td></tr><tr><td align="center">8</td><td align="center">0000 1000</td><td align="center">10</td><td align="center">8</td></tr><tr><td align="center">9</td><td align="center">0000 1001</td><td align="center">11</td><td align="center">9</td></tr><tr><td align="center">10</td><td align="center">0000 1010</td><td align="center">12</td><td align="center">A</td></tr><tr><td align="center">11</td><td align="center">0000 1011</td><td align="center">13</td><td align="center">B</td></tr><tr><td align="center">12</td><td align="center">0000 1100</td><td align="center">14</td><td align="center">C</td></tr><tr><td align="center">13</td><td align="center">0000 1101</td><td align="center">15</td><td align="center">D</td></tr><tr><td align="center">14</td><td align="center">0000 1110</td><td align="center">16</td><td align="center">E</td></tr><tr><td align="center">15</td><td align="center">0000 1111</td><td align="center">17</td><td align="center">F</td></tr><tr><td align="center">16</td><td align="center">0001 0000</td><td align="center">20</td><td align="center">10</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 编程语言 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 编程语言 </tag>
            
            <tag> C/C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编程语言基础篇：简单介绍</title>
      <link href="/2020/03/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%9A%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/"/>
      <url>/2020/03/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%9A%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E6%8F%90%E9%AB%98/%E6%8F%90%E9%AB%98%E7%AF%87%E8%83%8C%E6%99%AF.jpeg" width="800" hegiht="600" ></center><a id="more"></a><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h3 id="编程语言发展"><a href="#编程语言发展" class="headerlink" title="编程语言发展"></a>编程语言发展</h3><p>&emsp;&emsp;1967年，剑桥大学Martin Richards对CPL语言进行了简化，产生了BCPL（Basic Combined Programming Language）语言。1970年，美国贝尔实验室的 Ken Thompson，以BCPL语言为基础，设计出B语言，并用它写了第一个UNIX操作系统。1972年，美国贝尔实验室的 D.M.Ritchie 在B语言的基础上最终设计出了一种新的语言：<strong>C语言</strong>（取BCPL的第二个字母）。在C语言基础上，1983年又由贝尔实验室的Bjarne Strou-strup推出了<strong>C++**。C++进一步扩充和完善了C语言，成为一种面向对象的程序设计语言。<br>&emsp;&emsp;**Python</strong>（英国发音：/ˈpaɪθən/美国发音：/ˈpaɪθɑːn/）是著名的“龟叔”Guido van Rossum在1989年圣诞节期间在阿姆斯特丹为了打发无聊的圣诞节而编写的一个脚本解释编程语言。之所以选中Python作为编程的名字，是因为他是一个蒙提·派森的飞行马戏团（Monty Python’s Flying Circus）的爱好者。</p><h3 id="编程语言分类"><a href="#编程语言分类" class="headerlink" title="编程语言分类"></a>编程语言分类</h3><h4 id="编译型语言和解释型语言"><a href="#编译型语言和解释型语言" class="headerlink" title="编译型语言和解释型语言"></a>编译型语言和解释型语言</h4><p>（1）<strong>编译型语言：</strong>在程序执行之前，先会通过编译器对程序执行一个编译的过程，把程序转变成机器语言。运行时就不需要翻译，而直接执行就可以了。最典型的例子就是C语言。</p><p>（2）<strong>解释型语言：</strong>就没有这个编译的过程，而是在程序运行的时候，通过解释器对程序逐行作出解释，然后直接运行，最典型的例子是Ruby。</p><p>&emsp;&emsp;此外，随着Java等基于虚拟机的语言的兴起，我们又不能把语言纯粹地分成解释型和编译型这两种。用Java来举例，Java首先是通过编译器编译成字节码文件，然后在运行时通过解释器给解释成机器文件。所以我们说Java是一种先编译后解释的语言。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80%E7%AF%87%E7%AE%80%E4%BB%8B/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%88%86%E7%B1%BB.png" width="400" hegiht="400" >(图) 编程语言分类</center><p>&emsp;&emsp;计算机是不能够识别高级语言的，所以当我们运行一个高级语言程序的时候，就需要一个“翻译机”来从事把高级语言转变成计算机能读懂的机器语言的过程。这个过程分成两类，第一种是编译，第二种是解释。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80%E7%AF%87%E7%AE%80%E4%BB%8B/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86.png" width="800" hegiht="600" >(图) 编程语言运行原理</center><h4 id="动态语言和静态语言"><a href="#动态语言和静态语言" class="headerlink" title="动态语言和静态语言"></a>动态语言和静态语言</h4><p>通常我们所说的动态语言、静态语言是指动态类型语言和静态类型语言。</p><p>（1）<strong>动态类型语言：</strong>动态类型语言是指在运行期间才去做数据类型检查的语言，也就是说，在用动态类型的语言编程时，永远也不用给任何变量指定数据类型，该语言会在你第一次赋值给变量时，在内部将数据类型记录下来。Python和Ruby就是一种典型的动态类型语言，其他的各种脚本语言如VBScript也多少属于动态类型语言。</p><p>（2）<strong>静态类型语言：</strong>静态类型语言与动态类型语言刚好相反，它的数据类型是在编译其间检查的，也就是说在写程序时要声明所有变量的数据类型，C/C++是静态类型语言的典型代表，其他的静态类型语言还有C#、JAVA等。</p><h3 id="编译器"><a href="#编译器" class="headerlink" title="编译器"></a>编译器</h3><ul><li>C/C++语言学习建议使用微软的<code>VC++6.0</code>或<a href="https://visualstudio.microsoft.com/zh-hans/vs/">visual studio 2010/2013/2015/2017/2019</a>系列软件；</li><li>Python语言学习建议使用<a href="https://www.jetbrains.com/pycharm/">Pycharm</a>软件；</li><li>文本编辑器建议使用<a href="https://notepad-plus-plus.org/">Notepad++</a>软件。</li></ul><div class="note info">            <p>C 程序的源文件通常使用扩展名 “.c”；<br>C++ 程序的源文件通常使用扩展名 “.cpp”；<br>Python 程序的源文件通常使用扩展名 “.py”。</p>          </div><h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World!"></a>Hello World!</h2><h3 id="c"><a href="#c" class="headerlink" title="c"></a>c</h3><figure class="highlight c"><figcaption><span>hello_world.c</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">/* 我的第一个 C 程序 */</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello,C World! \n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>运行结果：</strong></p><pre><code>Hello,C World!</code></pre><h3 id="c-1"><a href="#c-1" class="headerlink" title="c++"></a>c++</h3><figure class="highlight c++"><figcaption><span>hello_world.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// 我的第一个 C++ 程序 </span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello, C++ World!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>运行结果：</strong></p><pre><code>Hello, C++ World!</code></pre><h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><figure class="highlight plain"><figcaption><span>hello_world.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding&#x3D;utf-8</span><br><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"></span><br><span class="line"># 我的第一个Python程序</span><br><span class="line">print(&quot;Hello, Python World&quot;)</span><br></pre></td></tr></table></figure><p><strong>运行结果：</strong></p><pre><code>Hello, Python World</code></pre><h2 id="程序分析"><a href="#程序分析" class="headerlink" title="程序分析"></a>程序分析</h2><h3 id="头文件"><a href="#头文件" class="headerlink" title="头文件"></a>头文件</h3><ul><li>在C/C++语言中，#include为预处理器编译指令，其后包含的stdio.h、iostream分别是C/C++语言的标准头文件。</li></ul><h3 id="主函数"><a href="#主函数" class="headerlink" title="主函数"></a>主函数</h3><ul><li>在C/C++语言中，int main() 是主函数，程序从这里开始执行。</li><li>每一个源程序都必须有，且只能有一个主函数(main函数)</li></ul><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><ul><li>C语言中，注释采用<code>/*  */</code>或<code>//</code></li><li>C++语言中，注释采用<code>/*  */</code>或<code>//</code></li><li>Python语言中，注释采用<code>#</code></li></ul><h3 id="标准输出函数"><a href="#标准输出函数" class="headerlink" title="标准输出函数"></a>标准输出函数</h3><ul><li>C语言中，标准输出函数为 <code>printf(&quot; &quot;);</code></li><li>C++语言中，标准输出函数为 <code>cout &lt;&lt; &quot; &quot; ;</code></li><li>Python语言中，标准输出函数为 <code>print(&quot; &quot;)</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> 编程语言 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 编程语言 </tag>
            
            <tag> C/C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习6-0：理解服务中Server与Client(C++)</title>
      <link href="/2020/03/16/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A06-0%EF%BC%9A%E7%90%86%E8%A7%A3%E6%9C%8D%E5%8A%A1%E4%B8%ADServer%E4%B8%8EClient(C++)/"/>
      <url>/2020/03/16/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A06-0%EF%BC%9A%E7%90%86%E8%A7%A3%E6%9C%8D%E5%8A%A1%E4%B8%ADServer%E4%B8%8EClient(C++)/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;本例程节点放在<code>ros_learning</code>功能包src文件夹下，新建<code>ros_learning</code>功能包(如果已创建则跳过)：</p><pre><code>$ cs$ catkin_create_pkg ros_learning std_msgs rospy roscpp$ cm</code></pre><a id="more"></a><h2 id="动作程序编写"><a href="#动作程序编写" class="headerlink" title="动作程序编写"></a>动作程序编写</h2><h3 id="创建服务端（Server）"><a href="#创建服务端（Server）" class="headerlink" title="创建服务端（Server）"></a>创建服务端（Server）</h3><figure class="highlight c++"><figcaption><span>add_two_ints_server.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ros_learning/AddTwoInts.h&quot;</span></span></span><br><span class="line"><span class="comment">// beginner_tutorials/AddTwoInts.h是由编译系统自动根据我们先前创建的srv文件生成的对应该srv文件的头文件。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这个函数提供两个int值求和的服务，int值从request里面获取，而返回数据装入response内，这些数据类型都定义在srv文件内部，函数返回一个boolean值。</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">add</span><span class="params">(ros_learning::AddTwoInts::Request  &amp;req,</span></span></span><br><span class="line"><span class="function"><span class="params">         ros_learning::AddTwoInts::Response &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// 现在，两个int值已经相加，并存入了response。</span></span><br><span class="line">  res.sum = req.a + req.b;</span><br><span class="line">  ROS_INFO(<span class="string">&quot;request: x=%ld, y=%ld&quot;</span>, (<span class="keyword">long</span> <span class="keyword">int</span>)req.a, (<span class="keyword">long</span> <span class="keyword">int</span>)req.b);</span><br><span class="line">  ROS_INFO(<span class="string">&quot;sending back response: [%ld]&quot;</span>, (<span class="keyword">long</span> <span class="keyword">int</span>)res.sum);</span><br><span class="line">  <span class="comment">// service完成计算后返回true值</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// 创建并初始化节点add_two_ints_server</span></span><br><span class="line">  ros::init(argc, argv, <span class="string">&quot;add_two_ints_server&quot;</span>);</span><br><span class="line">  <span class="comment">// 为这个进程的节点创建一个句柄n</span></span><br><span class="line">  ros::NodeHandle n;</span><br><span class="line">  <span class="comment">// 这里，service已经建立起来，并在ROS内发布出来</span></span><br><span class="line">  ros::ServiceServer service = n.advertiseService(<span class="string">&quot;add_two_ints_c&quot;</span>, add);</span><br><span class="line">  ROS_INFO(<span class="string">&quot;Ready to add two ints.&quot;</span>);</span><br><span class="line">  ros::spin();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建客户端-Client"><a href="#创建客户端-Client" class="headerlink" title="创建客户端(Client)"></a>创建客户端(Client)</h3><figure class="highlight c++"><figcaption><span>add_two_ints_client.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ros_learning/AddTwoInts.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// 创建并初始化节点add_two_ints_client</span></span><br><span class="line">  ros::init(argc, argv, <span class="string">&quot;add_two_ints_client&quot;</span>);</span><br><span class="line">  <span class="comment">// 输入参数异常提醒</span></span><br><span class="line">  <span class="keyword">if</span> (argc != <span class="number">3</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    ROS_INFO(<span class="string">&quot;usage: add_two_ints_client X Y&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 为这个进程的节点创建一个句柄n</span></span><br><span class="line">  ros::NodeHandle n;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 为add_two_ints service创建一个client;ros::ServiceClient对象待会用来调用service</span></span><br><span class="line">  ros::ServiceClient client = n.serviceClient&lt;ros_learning::AddTwoInts&gt;(<span class="string">&quot;add_two_ints_c&quot;</span>);</span><br><span class="line">  <span class="comment">// 实例化一个由ROS编译系统自动生成的service类，并给其request成员赋值</span></span><br><span class="line">  <span class="comment">// 一个service类包含两个成员request和response</span></span><br><span class="line">  ros_learning::AddTwoInts srv;</span><br><span class="line">  srv.request.a = atoll(argv[<span class="number">1</span>]);</span><br><span class="line">  srv.request.b = atoll(argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*** </span></span><br><span class="line"><span class="comment">    调用service;由于service的调用是模态过程（调用的时候占用进程阻止其他代码的执行），一旦调用完成，将返回调用结果</span></span><br><span class="line"><span class="comment">    如果service调用成功，call()函数将返回true，srv.response里面的值将是合法的值</span></span><br><span class="line"><span class="comment">    如果调用失败，call()函数将返回false，srv.response里面的值将是非法的</span></span><br><span class="line"><span class="comment">  ***/</span></span><br><span class="line">  <span class="keyword">if</span> (client.call(srv))</span><br><span class="line">  &#123;</span><br><span class="line">    ROS_INFO(<span class="string">&quot;Sum: %ld&quot;</span>, (<span class="keyword">long</span> <span class="keyword">int</span>)srv.response.sum);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    ROS_ERROR(<span class="string">&quot;Failed to call service add_two_ints_c&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="新建自定义服务"><a href="#新建自定义服务" class="headerlink" title="新建自定义服务"></a>新建自定义服务</h3><ul><li>创建<code>AddTwoInts.srv</code>文件</li></ul><p>自定义服务消息数据格式一般为<code>srv</code>文件，如此次需要创建<code>AddTwoInts.srv</code>文件，一般放在功能包目录下<code>srv</code>文件夹下。</p><p>路径：<code>catkin_ws/src/ros_learning/srv/AddTwoInts.srv</code></p><figure class="highlight c"><figcaption><span>AddTwoInts.srv</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int64 a</span><br><span class="line">int64 b</span><br><span class="line">---</span><br><span class="line">int64 sum</span><br></pre></td></tr></table></figure><p>注：数据域中的内容，请求与应答数据格式之间需要使用<code>---</code>分割。</p><ul><li>修改package.xml文件，添加以下内容</li></ul><figure class="highlight xml"><figcaption><span>package.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build_depend</span>&gt;</span>message_generation<span class="tag">&lt;/<span class="name">build_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build_export_depend</span>&gt;</span>message_generation<span class="tag">&lt;/<span class="name">build_export_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exec_depend</span>&gt;</span>message_runtime<span class="tag">&lt;/<span class="name">exec_depend</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>修改CMakeLists.txt文件，添加以下内容</li></ul><figure class="highlight python"><figcaption><span>CMakeLists.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Find catkin macros and libraries</span></span><br><span class="line"><span class="comment">## if COMPONENTS list like find_package(catkin REQUIRED COMPONENTS xyz)</span></span><br><span class="line"><span class="comment">## is used, also find other catkin packages</span></span><br><span class="line">find_package(catkin REQUIRED COMPONENTS</span><br><span class="line">  roscpp</span><br><span class="line">  rospy</span><br><span class="line">  std_msgs</span><br><span class="line">  message_generation</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Generate services in the &#x27;srv&#x27; folder</span></span><br><span class="line">add_service_files(</span><br><span class="line">   FILES</span><br><span class="line">   AddTwoInts.srv</span><br><span class="line"> )</span><br><span class="line"></span><br><span class="line"><span class="comment">## Generate added messages and services with any dependencies listed here</span></span><br><span class="line"> generate_messages(</span><br><span class="line">   DEPENDENCIES</span><br><span class="line">   std_msgs</span><br><span class="line"> )</span><br><span class="line"></span><br><span class="line">catkin_package(</span><br><span class="line"><span class="comment">#  INCLUDE_DIRS include</span></span><br><span class="line"><span class="comment">#  LIBRARIES ros_learning</span></span><br><span class="line">  CATKIN_DEPENDS roscpp rospy std_msgs message_generation</span><br><span class="line"><span class="comment">#  DEPENDS system_lib</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="添加配置"><a href="#添加配置" class="headerlink" title="添加配置"></a>添加配置</h3><p>方法一：可执行文件添加到CMakeLists.txt末尾位置</p><figure class="highlight txt"><figcaption><span>CMakeLists.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">add_executable(add_two_ints_server</span><br><span class="line">  src/add_two_ints_server.cpp</span><br><span class="line">)</span><br><span class="line">add_dependencies(add_two_ints_server $&#123;$&#123;PROJECT_NAME&#125;_EXPORTED_TARGETS&#125; $&#123;catkin_EXPORTED_TARGETS&#125;)</span><br><span class="line">target_link_libraries(add_two_ints_server</span><br><span class="line">  $&#123;catkin_LIBRARIES&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">add_executable(add_two_ints_client</span><br><span class="line">  src/add_two_ints_client.cpp</span><br><span class="line">)</span><br><span class="line">add_dependencies(add_two_ints_client $&#123;$&#123;PROJECT_NAME&#125;_EXPORTED_TARGETS&#125; $&#123;catkin_EXPORTED_TARGETS&#125;)</span><br><span class="line">target_link_libraries(add_two_ints_client</span><br><span class="line">  $&#123;catkin_LIBRARIES&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>方法二：使用Roboware软件自动创建</p><p>&emsp;&emsp; 右键src文件夹选择<code>新建cpp源文件</code>，然后输入文件名（如<code>add_two_ints_server.cpp</code>），再选择<code>加入新的可执行文件中</code>。可到CMakeLists.txt文件中查看创建结果。</p><h2 id="程序运行"><a href="#程序运行" class="headerlink" title="程序运行"></a>程序运行</h2><ul><li>打开新终端，编译功能包，启动ROS：</li></ul><pre><code>$ cm$ roscore</code></pre><ul><li>打开新终端，运行服务器，可以看出服务在等待客户端请求：</li></ul><pre><code>$ rosrun ros_learning add_two_ints_server</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E6%9C%8D%E5%8A%A1/C%2B%2B/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AD%89%E5%BE%85%E8%AF%B7%E6%B1%82.png" width="400" hegiht="400">（图）服务器等待客户端请求</center><ul><li>打开新终端，运行客户端，可以看出，当发出两个整数相加请求后，服务器计算并返回所求的和：</li></ul><pre><code>$ rosrun ros_learning add_two_ints_client 5 8</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E6%9C%8D%E5%8A%A1/C%2B%2B/%E6%9C%8D%E5%8A%A1%E8%BF%90%E8%A1%8C.png" width="400" hegiht="600">（图）客户端（Client)</center>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习5-0：理解话题中Publier与Subscriber(C++)</title>
      <link href="/2020/03/16/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A05-0%EF%BC%9A%E7%90%86%E8%A7%A3%E8%AF%9D%E9%A2%98%E4%B8%ADPublier%E4%B8%8ESubscriber(C++)/"/>
      <url>/2020/03/16/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A05-0%EF%BC%9A%E7%90%86%E8%A7%A3%E8%AF%9D%E9%A2%98%E4%B8%ADPublier%E4%B8%8ESubscriber(C++)/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;本例程节点放在<code>ros_learning</code>功能包src文件夹下，新建<code>ros_learning</code>功能包(如果已创建则跳过)：</p><pre><code>$ cs$ catkin_create_pkg ros_learning std_msgs rospy roscpp$ cm</code></pre><a id="more"></a><h2 id="话题程序编写"><a href="#话题程序编写" class="headerlink" title="话题程序编写"></a>话题程序编写</h2><h3 id="创建发布者（Publier）"><a href="#创建发布者（Publier）" class="headerlink" title="创建发布者（Publier）"></a>创建发布者（Publier）</h3><figure class="highlight c++"><figcaption><span>talker_c.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;std_msgs/String.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">第一行：ros/ros.h是一个实用的头文件，它引用了ROS系统中大部分常用的头文件，使用它会使得编程很简便。</span></span><br><span class="line"><span class="comment">第二行：引用了std_msgs/String 消息, 它存放在std_msgs package里，是由String.msg文件自动生成的头文件。</span></span><br><span class="line"><span class="comment">***/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// 创建并初始化节点talker_c；注意节点的名称必须唯一。</span></span><br><span class="line">  ros::init(argc, argv, <span class="string">&quot;talker_c&quot;</span>);</span><br><span class="line">  <span class="comment">// 为这个进程的节点创建一个句柄n。</span></span><br><span class="line">  ros::NodeHandle n;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 告诉master我们将要在chatter_c topic上发布一个std_msgs/String的消息;这样master就会告诉所有订阅了chatter_c topic的节点，将要有数据发布。</span></span><br><span class="line">  <span class="comment">// 第二个参数是发布序列的大小;如果我们发布的消息太快，缓冲区中的消息在大于1000个的时候就会开始丢弃先前发布的消息。</span></span><br><span class="line">  ros::Publisher chatter_pub = n.advertise&lt;std_msgs::String&gt;(<span class="string">&quot;chatter_c&quot;</span>, <span class="number">1000</span>);</span><br><span class="line">  <span class="comment">// 指定自循环的频率10Hz</span></span><br><span class="line">  <span class="function">ros::Rate <span class="title">loop_rate</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (ros::ok())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// 创建字符串消息数据msg.data</span></span><br><span class="line">    std_msgs::String msg;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">stringstream</span> ss;</span><br><span class="line">    ss &lt;&lt; <span class="string">&quot;hello world &quot;</span> &lt;&lt; count;</span><br><span class="line">    msg.data = ss.str();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ROS_INFO和类似的函数用来替代printf/cout,发送到终端显示</span></span><br><span class="line">    ROS_INFO(<span class="string">&quot;%s&quot;</span>, msg.data.c_str());</span><br><span class="line">    <span class="comment">// 发布话题消息msg</span></span><br><span class="line">    chatter_pub.publish(msg);</span><br><span class="line">    <span class="comment">// 调用一次回调函数，这个例程没有用的，但如需扩展程序，最好保留。</span></span><br><span class="line">    ros::spinOnce();</span><br><span class="line">    <span class="comment">// 调用ros::Rate对象来休眠一段时间以使得发布频率为10hz</span></span><br><span class="line">    loop_rate.sleep();</span><br><span class="line">    ++count;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建订阅者（Subscriber）"><a href="#创建订阅者（Subscriber）" class="headerlink" title="创建订阅者（Subscriber）"></a>创建订阅者（Subscriber）</h3><figure class="highlight c++"><figcaption><span>listener_c.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;std_msgs/String.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 回调函数，当消息到达chatter topic的时候就会被调用</span></span><br><span class="line"><span class="comment">// 消息是以 boost shared_ptr指针的形式传输，这就意味着你可以存储它而又不需要复制数据</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">chatterCallback</span><span class="params">(<span class="keyword">const</span> std_msgs::String::ConstPtr&amp; msg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ROS_INFO(<span class="string">&quot;I heard: [%s]&quot;</span>, msg-&gt;data.c_str());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// 创建并初始化节点listener_c；注意节点的名称必须唯一。</span></span><br><span class="line">  ros::init(argc, argv, <span class="string">&quot;listener_c&quot;</span>);</span><br><span class="line">  <span class="comment">// 为这个进程的节点创建一个句柄n。</span></span><br><span class="line">  ros::NodeHandle n;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//同样告诉master我们要订阅chatter_c topic上的消息；当有消息到达topic时，ROS就会调用chatterCallback()函数。</span></span><br><span class="line">  ros::Subscriber sub = n.subscribe(<span class="string">&quot;chatter_c&quot;</span>, <span class="number">1000</span>, chatterCallback);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 进入自循环，可以尽可能快的调用消息回调函数</span></span><br><span class="line">  ros::spin();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="添加配置"><a href="#添加配置" class="headerlink" title="添加配置"></a>添加配置</h3><p>方法一：可执行文件添加到CMakeLists.txt末尾位置</p><figure class="highlight txt"><figcaption><span>CMakeLists.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">add_executable(talker_c</span><br><span class="line">  src/talker_c.cpp</span><br><span class="line">)</span><br><span class="line">add_dependencies(talker_c $&#123;$&#123;PROJECT_NAME&#125;_EXPORTED_TARGETS&#125; $&#123;catkin_EXPORTED_TARGETS&#125;)</span><br><span class="line">target_link_libraries(talker_c</span><br><span class="line">  $&#123;catkin_LIBRARIES&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">add_executable(listener_c</span><br><span class="line">  src/listener_c.cpp</span><br><span class="line">)</span><br><span class="line">add_dependencies(listener_c $&#123;$&#123;PROJECT_NAME&#125;_EXPORTED_TARGETS&#125; $&#123;catkin_EXPORTED_TARGETS&#125;)</span><br><span class="line">target_link_libraries(listener_c</span><br><span class="line">  $&#123;catkin_LIBRARIES&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>方法二：使用Roboware软件自动创建</p><p>&emsp;&emsp; 右键src文件夹选择<code>新建cpp源文件</code>，然后输入文件名（如listener_c.cpp），再选择<code>加入新的可执行文件中</code>。可到CMakeLists.txt文件中查看创建结果。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E8%AF%9D%E9%A2%98/c%2B%2B/roboware.png" width="800" hegiht="600">（图）Roboware软件自动创建</center><h2 id="程序运行"><a href="#程序运行" class="headerlink" title="程序运行"></a>程序运行</h2><ul><li>打开新终端，编译功能包，启动ROS：</li></ul><pre><code>$ cm$ roscore</code></pre><ul><li>打开新终端，运行订阅者，此时发布者还没发送消息：再运行发布者节点：</li></ul><pre><code>$ rosrun ros_learning listener_c$ rosrun ros_learning talker_c</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E8%AF%9D%E9%A2%98/c%2B%2B/%E8%8A%82%E7%82%B9%E8%BF%90%E8%A1%8C.png" width="600" hegiht="400">（图）节点运行</center><ul><li>查看节点关系</li></ul><pre><code>$ rqt_graph</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E8%AF%9D%E9%A2%98/c%2B%2B/%E6%9F%A5%E7%9C%8B%E8%8A%82%E7%82%B9%E5%85%B3%E7%B3%BB.png" width="400" hegiht="400">（图）查看节点关系</center>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网站收藏</title>
      <link href="/2020/03/15/%E7%BD%91%E7%AB%99%E6%94%B6%E8%97%8F/"/>
      <url>/2020/03/15/%E7%BD%91%E7%AB%99%E6%94%B6%E8%97%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87/%E7%BD%91%E7%AB%99%E6%94%B6%E8%97%8F%E8%83%8C%E6%99%AF.jpg" width="800" hegiht="600" ></center><a id="more"></a><h2 id="文学类"><a href="#文学类" class="headerlink" title="文学类"></a>文学类</h2><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">常用网站</a></li><li class="tab"><a href="#tab标签列表-2">文学网站</a></li><li class="tab"><a href="#tab标签列表-3">特别网站</a></li><li class="tab"><a href="#tab标签列表-4">出版社</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><ul><li><a href="https://new.shuge.org/">有品格的数字古籍图书馆，书格</a></li><li><a href="https://site.sciping.com/">科塔学术</a></li><li><a href="https://www.wdl.org/zh/">世界数字图书馆</a></li></ul></div><div class="tab-pane" id="tab标签列表-2"><ul><li><a href="https://new.shuge.org/">有品格的数字古籍图书馆，书格</a></li><li><a href="https://www.gushiwen.org/">古诗文网</a></li><li><a href="https://www.allhistory.com/">全历史</a></li><li><a href="https://minghuaji.dpm.org.cn/">故宫名画记</a></li><li><a href="http://www.daizhige.org/">殆知阁</a></li><li><a href="http://www.sidneyluo.net/index.html">汉川草庐</a></li><li><a href="https://www.hytung.cn/">瀚堂典藏</a></li><li><a href="https://www.zdic.net/">汉典</a></li><li><a href="http://gj.zdic.net/">汉典古籍</a></li><li><a href="https://www.wdl.org/zh/">世界数字图书馆</a></li><li><a href="https://ctext.org/zhs">中国哲学电子书计划-需翻墙</a></li><li><a href="https://fzk.szlib.com/book/index">苏州图书馆古籍库</a></li><li><a href="http://www.guoxuedashi.com/">国学大师</a></li></ul></div><div class="tab-pane" id="tab标签列表-3"><ul><li><a href="https://minghuaji.dpm.org.cn/">发现中国-地图类</a></li><li><a href="https://www.lishichelun.com/">历史车轮-人物类</a></li><li><a href="http://www.modernhistory.org.cn/">抗日战争与近代中日关系文献数据库</a></li><li><a href="https://sobooks.cc/">Sobooks</a></li></ul></div><div class="tab-pane" id="tab标签列表-4"><ul><li><a href="http://www.rw-cn.com/">人民文学出版社</a></li><li><a href="http://www.yilin.com/">译林出版社</a></li><li><a href="http://www.hep.com.cn/">高等教育出版社</a></li><li><a href="https://www.ptpress.com.cn/">人民邮电出版社</a></li><li><a href="http://www.tup.tsinghua.edu.cn/index.html">清华大学出版社</a></li><li><a href="http://www.zhbc.com.cn/zhsj/fg/home/home.html">中华书局</a></li><li><a href="http://www.cp.com.cn/">商务印书馆</a></li><li><a href="http://www.yiwen.com.cn/">上海译文出版社</a></li><li><a href="https://www.epubit.com/">异步社区</a></li></ul></div></div></div><h2 id="学习类"><a href="#学习类" class="headerlink" title="学习类"></a>学习类</h2><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">常用网站</a></li><li class="tab"><a href="#tab标签列表-2">C/C++语言</a></li><li class="tab"><a href="#tab标签列表-3">Python语言</a></li><li class="tab"><a href="#tab标签列表-4">ROS学习</a></li><li class="tab"><a href="#tab标签列表-5">英语学习</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><pre><code>标签页1文本内容&lt;img src=&quot;https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/1.jpg&quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></pre></div><div class="tab-pane" id="tab标签列表-2"><pre><code>标签页1文本内容&lt;img src=&quot;https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/1.jpg&quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></pre></div><div class="tab-pane" id="tab标签列表-3"><pre><code>标签页2文本内容&lt;img src=&quot;https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/2.jpg&quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></pre></div><div class="tab-pane" id="tab标签列表-4"><pre><code>标签页3文本内容&lt;img src=&quot;https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/3.jpg&quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></pre></div><div class="tab-pane" id="tab标签列表-5"><p>– <a href="https://www.tianfateng.cn/">田间小站</a></p></div></div></div><h2 id="科普类"><a href="#科普类" class="headerlink" title="科普类"></a>科普类</h2><ul><li><a href="https://www.mvyxws.com/">医学微视</a></li></ul><h2 id="娱乐类"><a href="#娱乐类" class="headerlink" title="娱乐类"></a>娱乐类</h2><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">常用网站</a></li><li class="tab"><a href="#tab标签列表-2">影视下载</a></li><li class="tab"><a href="#tab标签列表-3">Python语言</a></li><li class="tab"><a href="#tab标签列表-4">ROS学习</a></li><li class="tab"><a href="#tab标签列表-5">王祖贤4</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><pre><code>标签页1文本内容&lt;img src=&quot;https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/1.jpg&quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></pre></div><div class="tab-pane" id="tab标签列表-2"><ul><li><a href="http://www.meijuniao.com/">美剧鸟</a></li><li></li></ul></div><div class="tab-pane" id="tab标签列表-3"><pre><code>标签页2文本内容&lt;img src=&quot;https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/2.jpg&quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></pre></div><div class="tab-pane" id="tab标签列表-4"><pre><code>标签页3文本内容&lt;img src=&quot;https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/3.jpg&quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></pre></div><div class="tab-pane" id="tab标签列表-5"><pre><code>标签页4文本内容&lt;img src=&quot;https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/4.jpg&quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></pre></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 网站收藏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站收藏 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>古诗文：庄子·内篇·逍遥游</title>
      <link href="/2020/03/15/%E5%8F%A4%E8%AF%97%E6%96%87%EF%BC%9A%E5%BA%84%E5%AD%90%C2%B7%E5%86%85%E7%AF%87%C2%B7%E9%80%8D%E9%81%A5%E6%B8%B8/"/>
      <url>/2020/03/15/%E5%8F%A4%E8%AF%97%E6%96%87%EF%BC%9A%E5%BA%84%E5%AD%90%C2%B7%E5%86%85%E7%AF%87%C2%B7%E9%80%8D%E9%81%A5%E6%B8%B8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;《逍遥游》是战国时期哲学家、文学家庄周的代表作，被列为道家经典《庄子·内篇》的首篇，在思想上和艺术上都可作为《庄子》一书的代表。</p><center><img src="https://album-1257031621.cos.ap-nanjing.myqcloud.com/read_more_photos/%E9%B2%B2%E9%B9%8F.jpeg" width="600" hegiht="400" ></center><a id="more"></a><center><p><strong>《庄子·内篇·逍遥游》</strong></p></center><blockquote><p>&emsp;&emsp;北冥有鱼，其名为鲲。鲲之大，不知其几千里也。化而为鸟，其名为鹏。鹏之背，不知其几千里也。怒而飞，其翼若垂天之云。是鸟也，海运则将徙于南冥。南冥者，天池也。</p></blockquote><blockquote><p>&emsp;&emsp;《齐谐》者，志怪者也。《谐》之言曰：“鹏之徙于南冥也，水击三千里，抟扶摇而上者九万里，去以六月息者也。”野马也，尘埃也 ，生物之以息相吹也。天之苍苍，其正色邪？其远而无所至极邪？其视下也，亦若是则已矣。</p></blockquote><blockquote><p>&emsp;&emsp;且夫水之积也不厚，则其负大舟也无力。覆杯水于坳堂之上，则芥为之舟。置杯焉则胶，水浅而舟大也。风之积也不厚，则其负大翼也无力。<strong>故九万里则风斯在下矣，而后乃今培风；背负青天而莫之夭阏者，而后乃今将图南。</strong></p></blockquote><blockquote><p>&emsp;&emsp;蜩与学鸠笑之曰：“我決起而飞，抢榆枋而止，时则不至，而控于地而已矣，奚以之九万里而南为？”适莽苍者，三餐而反，腹犹果然；适百里者，宿舂粮；适千里者，三月聚粮。之二虫又何知！</p></blockquote><blockquote><p>&emsp;&emsp;<strong>小知不及大知，小年不及大年。</strong>奚以知其然也？<strong>朝菌不知晦朔，蟪蛄不知春秋</strong>，此小年也。楚之南有冥灵者，以五百岁为春，五百岁为秋；上古有大椿者，以八千岁为春，八千岁为秋，此大年也。而彭祖乃今以久特闻，众人匹之，不亦悲乎！</p></blockquote><blockquote><p>&emsp;&emsp;汤之问棘也是已：<strong>穷发之北，有冥海者，天池也。有鱼焉，其广数千里，未有知其修者，其名为鲲。有鸟焉，其名为鹏，背若泰山，翼若垂天之云，抟扶摇羊角而上者九万里，绝云气，负青天，然后图南，且适南冥也。</strong></p></blockquote><blockquote><p>&emsp;&emsp;斥鴳笑之曰：“彼且奚适也？我腾跃而上，不过数仞而下，翱翔蓬蒿之间，此亦飞之至也，而彼且奚适也？”此小大之辩也。</p></blockquote><blockquote><p>&emsp;&emsp;故夫知效一官，行比一乡，德合一君，而征一国者，其自视也，亦若此矣。而宋荣子犹然笑之。<strong>且举世而誉之而不加劝，举世而非之而 不加沮，定乎内外之分，辩乎荣辱之境，斯已矣。</strong>彼其于世，未数数然也。虽然，犹有未树也。</p></blockquote><blockquote><p>&emsp;&emsp;夫列子御风而行，泠然善也，旬有五日而后反。彼于致福者，未数数然也。此虽免乎行，犹有所待者也。</p></blockquote><blockquote><p>&emsp;&emsp;<strong>若夫乘天地之正，而御六气之辩，以游无穷者，彼且恶乎待哉！故曰：至人无己，神人无功，圣人无名。</strong></p></blockquote><blockquote><p>&emsp;&emsp;尧让天下于许由，曰：“日月出矣，而爝火不息，其于光也，不亦难乎！时雨降矣，而犹浸灌，其于泽也，不亦劳乎！夫子立而天下治 ，而我犹尸之，吾自视缺然。请致天下。”许由曰：“子治天下，天下既已治也，而我犹代子，吾将为名乎？名者，实之宾也，吾将为宾乎？鹪鹩巢于深林，不过一枝；偃鼠饮河，不过满腹。归休乎君，予无所用天下为！庖人虽不治庖，尸祝不越樽俎而代之矣。”</p></blockquote><blockquote><p>&emsp;&emsp;肩吾问于连叔曰：“吾闻言于接舆，大而无当，往而不返。吾惊怖其言犹河汉而无极也，大有径庭，不近人情焉。”连叔曰：“其言谓何哉？”“曰‘<strong>藐姑射之山，有神人居焉。肌肤若冰雪，淖约若处子；不食五谷，吸风饮露；乘云气，御飞龙，而游乎四海之外；其神凝，使物不疵疠而年谷熟。</strong>’吾以是狂而不信也。”连叔曰：“然，瞽者无以与乎文章之观，聋者无以与乎钟鼓之声。岂唯形骸有聋盲哉？ 夫知亦有之。是其言也，犹时女也。之人也，之德也，将旁礴万物以为一，世蕲乎乱，孰弊弊焉以天下为事！之人也，物莫之伤，大浸稽天而不溺，大旱金石流、土山焦而不热。是其尘垢粃糠，将犹陶铸尧舜者也，孰肯以物为事！”</p></blockquote><blockquote><p>&emsp;&emsp;宋人资章甫而适越，越人断发文身，无所用之。</p></blockquote><blockquote><p>&emsp;&emsp;尧治天下之民，平海内之政。往见四子藐姑射之山，汾水之阳，杳然丧其天下焉。</p></blockquote><blockquote><p>&emsp;&emsp;惠子谓庄子曰：“魏王贻我大瓠之种，我树之成而实五石。以盛水浆，其坚不能自举也。剖之以为瓢，则瓠落无所容。非不呺然大也， 吾为其无用而掊之。”庄子曰：“夫子固拙于用大矣。宋人有善为不龟手之药者，世世以洴澼絖为事。客闻之，请买其方百金。聚族而谋之曰：‘我世世为澼絖，不过数金。今一朝而鬻技百金，请与之。’ 客得之，以说吴王。越有难，吴王使之将。冬，与越人水战，大败越人，裂地而封之。能不龟手一也，或以封，或不免于澼絖，则所用之异也。今子有五石之瓠，何不虑以为大樽而浮乎江湖，而忧其瓠落无所容？则夫子犹有蓬之心也夫！”</p></blockquote><blockquote><p>&emsp;&emsp;惠子谓庄子曰：“吾有大树，人谓之樗。其大本臃肿而不中绳墨，其小枝卷曲而不中规矩。立之涂，匠者不顾。今子之言，大而无用，众所同去也。”庄子曰：“子独不见狸狌乎？卑身而伏，以候敖者；东西跳梁，不避高下；中于机辟，死于罔罟。今夫嫠牛，其大若垂天 之云。此能为大矣，而不能执鼠。今子有大树，患其无用，何不树之于无何有之乡，广莫之野，彷徨乎无为其侧，逍遥乎寝卧其下。不夭斤斧，物无害者，无所可用，安所困苦哉！”</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 古文章 </category>
          
          <category> 古诗文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 古文章 </tag>
            
            <tag> 古诗文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Clash科学上网</title>
      <link href="/2020/02/19/%E4%BD%BF%E7%94%A8Clash%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
      <url>/2020/02/19/%E4%BD%BF%E7%94%A8Clash%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><img src="https://album-1257031621.cos.ap-nanjing.myqcloud.com/read_more_photos/bolivia-4919079_1920.jpg"></p><p><strong>Clash 版本</strong></p><ul><li>Clash：一个Go语言开发的多平台代理客户端，<a href="https://github.com/Dreamacro/clash/releases">Github</a></li><li>ClashX：Clash的Mac图形客户端，<a href="https://github.com/yichengchen/clashX/releases">Github</a></li><li>ClashForAndroid：Clash的Android图形客户端，<a href="https://github.com/Kr328/ClashForAndroid">Github</a></li><li>Clash for Windows：Clash的Windows图形客户端，<a href="https://github.com/Fndroid/clash_for_windows_pkg/releases">Github</a></li></ul><a id="more"></a><h2 id="前提条件：VPN代理商"><a href="#前提条件：VPN代理商" class="headerlink" title="前提条件：VPN代理商"></a>前提条件：VPN代理商</h2><p>使用Clash科学上网首先要有可用的VPN代理商，一般都提供clash教程和代理地址。如<a href="https://cordcloud.co/">Cordcloud</a>，提供的Clash地址。</p><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/cordcloud.PNG" width="600" hegiht="600" ></fancybox>（图）Cordcloud </center><h2 id="一、windows使用Clash科学上网"><a href="#一、windows使用Clash科学上网" class="headerlink" title="一、windows使用Clash科学上网"></a>一、windows使用Clash科学上网</h2><h3 id="1-1-Clash-For-Windows-安装"><a href="#1-1-Clash-For-Windows-安装" class="headerlink" title="1.1 Clash For Windows 安装"></a>1.1 Clash For Windows 安装</h3><p>（1） GitHub项目地址:<a href="https://github.com/Fndroid/clash_for_windows_pkg/releases">https://github.com/Fndroid/clash_for_windows_pkg/releases</a><br>下载适合的exe文件,一般个人的64位电脑下载 <code>Clash.for.Windows.Setup.0.9.0.exe </code> 即可。</p><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/Clash%20for%20Windows%20%E4%B8%8B%E8%BD%BD.PNG" width="500" hegiht="600" ></fancybox>（图）clash 下载</center><p>（2）在合适路径下创建Clash安装文件夹，安装过程比较简单。</p><h3 id="1-2-Clash-For-Windows-使用"><a href="#1-2-Clash-For-Windows-使用" class="headerlink" title="1.2 Clash For Windows 使用"></a>1.2 Clash For Windows 使用</h3><p>（1） 打开clash，进行General首页配置，打开System Proxy开关即可。</p><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/Clash%20For%20Windows%20%E9%A6%96%E9%A1%B5%E9%85%8D%E7%BD%AE.PNG" width="500" hegiht="600" ></fancybox>（图）clash 首页配置</center><p>（2）打开Profiles界面，复制VPN代理商提供的Clash地址，进行下载。</p><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/Clash%20For%20Windows%20%E5%9C%B0%E5%9D%80%E9%85%8D%E7%BD%AE.PNG" width="500" hegiht="600" ></fancybox>（图）clash 地址下载</center><p>（3）打开Proxies界面，在Global里面可以看到有很多节点可供选择。使用⚡符号测试节点，选择延迟较低的节点。</p><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/Clash%20For%20Windows%20%E8%8A%82%E7%82%B9%E6%B5%8B%E9%80%9F.PNG" width="500" hegiht="600" ></fancybox>（图）clash 节点测试</center><p>（4）选择好节点后，打开<a href="https://www.youtube.com/">Youtube</a>网页，能打开就可以。</p><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/Youtube%20%E6%B5%8B%E8%AF%95.PNG" width="600" hegiht="600" ></fancybox>（图）Youtube测试</center><h2 id="二、Ubuntu使用Clash科学上网"><a href="#二、Ubuntu使用Clash科学上网" class="headerlink" title="二、Ubuntu使用Clash科学上网"></a>二、Ubuntu使用Clash科学上网</h2><h3 id="2-1-Clash-For-Linux-安装"><a href="#2-1-Clash-For-Linux-安装" class="headerlink" title="2.1 Clash For Linux 安装"></a>2.1 Clash For Linux 安装</h3><p>（1） GitHub项目地址:<a href="https://github.com/Dreamacro/clash/releases">https://github.com/Dreamacro/clash/releases</a><br>下载适合的 Clash 二进制文件,一般个人的64位电脑下载 <code>clash-linux-amd64-v0.17.1.gz</code> 即可。</p><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/clash%20%E4%B8%8B%E8%BD%BD.jpg" width="500" hegiht="600" ></fancybox>（图）clash 下载</center><p>（2）在合适路径下创建Clash文件夹，使用以下命令解压，得到一个可执行文件<code>clash-linux-amd64</code>。</p><pre><code>$ gzip -d clash-linux-amd64-v0.17.1.gz  解压命令</code></pre><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/Clash%E6%96%87%E4%BB%B6%E5%A4%B9.png" width="500" hegiht="300" ></fancybox>（图）clash 文件夹</center><p>（3）将<code>config.yaml</code>、<code>Country.mmdb</code>两个文件存放至 <code>/home/tao/.config/clash</code>文件夹里。（隐藏文件可按 <code>Ctrl+H</code> 显示）</p><blockquote><ul><li>config.yaml 由自己购买的VPN供应商提供，商家一般都会提供Clash托管链接,如将 <a href="https://www.cordcord.xyz/link/IKCkMYSCFM4VTGZS?mu=4">https://www.cordcord.xyz/link/IKCkMYSCFM4VTGZS?mu=4</a> 内容复制到 config.yaml 。</li><li><a href="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/Material%20X/%E5%8D%9A%E6%96%87%E9%85%8D%E5%9B%BE/Ubuntu%20%E4%BD%BF%E7%94%A8%20Clash/Country.mmdb">Country.mmdb</a> 是为了防止出现 <code>Can&#39;t load mmdb: error opening database: invalid MaxMind DB file</code> 错误</li></ul></blockquote><h3 id="2-2-Clash-For-Linux-使用"><a href="#2-2-Clash-For-Linux-使用" class="headerlink" title="2.2 Clash For Linux 使用"></a>2.2 Clash For Linux 使用</h3><p>（1） 使用终端命令运行 clash，再打开网页<a href="http://clash.razord.top/">http://clash.razord.top/</a> 。</p><pre><code>$ sudo ./clash-linux-amd64-v0.17.1</code></pre><p>（2）配置网络代理</p><ul><li>打开clash网页配置，查看地址和端口。</li></ul><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/clash%20%E7%BD%91%E9%A1%B5%E8%AE%BE%E7%BD%AE.png" width="600" hegiht="400" ></fancybox>（图）clash网页配置</center><ul><li>打开系统设置，配置网络代理</li></ul><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86%E8%AE%BE%E7%BD%AE.png" width="500" hegiht="300" ></fancybox>（图）clash网页配置</center><p>（3）策略组选择延迟较低的节点,打开Youtube 测试</p><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/clash%20%E7%BD%91%E9%A1%B5%E4%BB%A3%E7%90%86%E9%80%89%E6%8B%A9.png" width="600" hegiht="400" ></fancybox>（图）clash节点选择</center><center><fancybox><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/Clash%20%E4%BD%BF%E7%94%A8/YouTube.png" width="600" hegiht="400" ></fancybox>（图）Youtube</center><blockquote><p>不想运行时需终端结束clash(ctrl+c)，且将系统代理改为无，否则无法正常上网。<br>而运行Clash上网，则需要再次开启网络代理。</p></blockquote><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="http://yagcn.com/?id=4">Clash for Windows 使用简介</a></li><li><a href="https://www.jianshu.com/p/2906066d2e0a">Clash For Linux 安装及使用</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Liunx系统 </category>
          
          <category> Ubuntu使用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ubuntu使用 </tag>
            
            <tag> Liunx系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>原理篇：机器人常见底盘运动学分析</title>
      <link href="/2020/02/02/%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%9A%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%B8%B8%E8%A7%81%E5%BA%95%E7%9B%98%E8%BF%90%E5%8A%A8%E5%AD%A6%E5%88%86%E6%9E%90/"/>
      <url>/2020/02/02/%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%9A%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%B8%B8%E8%A7%81%E5%BA%95%E7%9B%98%E8%BF%90%E5%8A%A8%E5%AD%A6%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;通常移动机器人依赖电机驱动车轮实现行走功能。机器人底盘结构不同，其运动学也完全不同。根据不同类型车轮，常见的底盘结构差速运动模型、滑移运动模型、阿克曼运动模型、全向轮运动模型等等。</p><ul><li>差速运动模型：2wd、4wd、6wd</li><li>全向轮运动模型：omni_3、omni_4、mecanum</li><li>阿克曼运动模型：ackermann</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%95%E7%9B%98/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%95%E7%9B%98%E7%B1%BB%E5%9E%8B.PNG" width="600" hegiht="600" >（图）机器人常见底盘结构</center><p>&emsp;&emsp;本文仅对两轮差速运动模型、三轮全向运动模型、四轮麦克纳姆轮运动模型三种底盘结构运动学分析。<br>&emsp;&emsp;ROS中运动学分析为正解（Forward kinematics）和逆解（Inverse Kinematics）两种。<strong>正解</strong>是将获得的机器人底盘速度指令/cmd_vel转化为每个车轮的实际速度。<strong>逆解</strong>是根据电机编码器获得的每个车轮速度计算出机器人底盘速度，从而实现航迹推算。</p><a id="more"></a><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>&emsp;&emsp;两轮差速运动模型如<a href="http://www.pirobot.org/">Pirobot</a>、<a href="https://www.turtlebot.com/">Turtlebot</a>等机器人，两个动力轮分别位于底盘左右两侧，通过给定不同速度来实现转向控制，一般会加一到两个的辅助支撑轮。</p><p>&emsp;&emsp;全向轮的独特之处在于其特殊的轮胎。全向轮并不仅仅是一个轮毂，而是由很多轮胎的组合体。其主体为一个大型中心轮，在中心轮周边为中心轴方向垂直于中心轮的小型轮子。根据小型轮子角度不同，常见的主要有麦克纳姆（Mecanum ）轮和连续切换轮两种。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%95%E7%9B%98/%E5%85%A8%E5%90%91%E8%BD%AE.PNG" width="600" hegiht="600" >（图）全向轮结构</center><p>&emsp;&emsp;麦克纳姆轮由轮辐和固定在外周的许多小滚子构成，轮子和滚子之间的夹角通常为45°。典型布置方式为“米”型布置。</p><p>&emsp;&emsp;连续切换轮由一个轮盘和固定在轮盘外周的滚子构成。轮盘轴心同滚子轴心垂直，轮盘绕轴心由电机驱动转动，滚子依次与地面接触，并可绕自身轴心自由转动。典型布置方式为三角形布置和“X”字形布置。</p><h2 id="两轮差速运动模型"><a href="#两轮差速运动模型" class="headerlink" title="两轮差速运动模型"></a>两轮差速运动模型</h2><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%95%E7%9B%98/%E4%B8%A4%E8%BD%AE%E5%B7%AE%E9%80%9F%E9%A9%B1%E5%8A%A8%E8%BF%90%E5%8A%A8%E6%A8%A1%E5%9E%8B_%E7%9C%8B%E5%9B%BE%E7%8E%8B.jpg" width="400" hegiht="400" >两轮差速运动模型</center><p>参考1：<a href="https://blog.csdn.net/xingdou520/article/details/83691951">两轮差速底盘的运动模型分析：运动控制与里程计解算</a><br>参考2：<a href="https://blog.csdn.net/heyijia0327/article/details/47021861">航迹推演（Odometry）</a><br>参考3：<a href="https://blog.csdn.net/heyijia0327/article/details/44983551">机器人局部避障的动态窗口法 (dynamic window approach)</a></p><p><strong>运动学方程</strong></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%95%E7%9B%98/%E4%B8%A4%E8%BD%AE%E5%B7%AE%E9%80%9F%E6%96%B9%E7%A8%8B.PNG" width="400" hegiht="400" ></center><h2 id="三轮全向运动学模型"><a href="#三轮全向运动学模型" class="headerlink" title="三轮全向运动学模型"></a>三轮全向运动学模型</h2><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%95%E7%9B%98/%E4%B8%89%E8%BD%AE%E5%85%A8%E5%90%91%E8%BF%90%E5%8A%A8%E5%AD%A6%E5%88%86%E6%9E%90.jpg" width="400" hegiht="400" >三轮全向运动学模型</center><p>参考1：<a href="https://mp.weixin.qq.com/s?src=3&timestamp=1580622174&ver=1&signature=mUYir5xCcV45GICjXRzD94x1hP2UOmQzFJtGoosiCFr1zIwftUr975xBmIVMOGaK2e9T1hL5uU5TN5UOhZ1rT8XrPqMRwzaAqvjXp6OWKgV-Y4RXRCaknqd4E0V3l1TshMi5vYQxLE-mlb6D-LU3uC8GdYcSDj6dO1g45UzghnU=">三轮全向移动底盘的运动学建模和分析</a><br>参考2：<a href="https://www.cnblogs.com/zxouxuewei/p/5871470.html">3轮全向轮正解—41</a></p><p><strong>运动学方程</strong></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%95%E7%9B%98/%E4%B8%89%E8%BD%AE%E5%85%A8%E5%90%91%E6%96%B9%E7%A8%8B.PNG" width="400" hegiht="400" ></center><h2 id="四轮麦克纳姆轮运动模型"><a href="#四轮麦克纳姆轮运动模型" class="headerlink" title="四轮麦克纳姆轮运动模型"></a>四轮麦克纳姆轮运动模型</h2><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%95%E7%9B%98/Coordinate_System.png" width="600" hegiht="400" >四轮麦克纳姆轮运动模型 </center><p>参考1：<a href="https://seeeddoc.github.io/4WD_Mecanum_Wheel_Robot_Kit_Series/?utm_source=rb-community&utm_medium=robots&utm_campaign=autonomous-navigation-mecanum-wheel-robot">4WD Mecanum Wheel Robot Kit Series</a><br>参考2：<a href="http://robotsforroboticists.com/drive-kinematics/">Drive Kinematics: Skid Steer &amp; Mecanum (ROS Twist included)</a></p><p><strong>运动学方程</strong></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%95%E7%9B%98/%E9%BA%A6%E5%85%8B%E7%BA%B3%E5%A7%86%E8%BD%AE%E6%96%B9%E7%A8%8B.PNG" width="400" hegiht="400" ></center>]]></content>
      
      
      <categories>
          
          <category> 原理篇 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 原理篇 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>原理篇：AB双相增量式编码器计数与测速</title>
      <link href="/2019/12/16/%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%9AAB%E5%8F%8C%E7%9B%B8%E5%A2%9E%E9%87%8F%E5%BC%8F%E7%BC%96%E7%A0%81%E8%AE%A1%E6%95%B0/"/>
      <url>/2019/12/16/%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%9AAB%E5%8F%8C%E7%9B%B8%E5%A2%9E%E9%87%8F%E5%BC%8F%E7%BC%96%E7%A0%81%E8%AE%A1%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;编码器是一种将角位移或者角速度转换成一连串电数字脉冲的旋转式传感 器，我们可以通过编码器测量到底位移或者速度信息。编码器从输出数据类型上 分，可以分为增量式编码器和绝对式编码器。从编码器检测原理上来分，还可以分为光学式、磁式、感应式、电容式。常见的是光电编码器（光学式）和霍尔编码器（磁式）。</p><p>&emsp;&emsp;光电编码器是一种通过光电转换将输出轴上的机械几何位移量转换成脉冲或数字量的传感器。光电编码器是由光码盘和光电检测装置组成。光码盘是在一 定直径的圆板上等分地开通若干个长方形孔。由于光电码盘与电动机同轴，电动机旋转时，检测装置检测输出若干脉冲信号，为判断转向，一般输出两组存在一 定相位差的方波信号。</p><p>&emsp;&emsp;霍尔编码器是一种通过磁电转换将输出轴上的机械几何位移量转换成脉冲或数字量的传感器。霍尔编码器是由霍尔码盘和霍尔元件组成。霍尔码盘是在一 定直径的圆板上等分地布置有不同的磁极。霍尔码盘与电动机同轴，电动机旋转时，霍尔元件检测输出若干脉冲信号，为判断转向，一般输出两组存在一定相位差的方波信号。</p><p>&emsp;&emsp;可以看到两种原理的编码器目的都是获取 AB 相输出的方波信号，其使用方法也是一样，下面是一个简单的示意图。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/AB%E5%8F%8C%E7%9B%B8%E5%A2%9E%E9%87%8F%E5%BC%8F%E7%BC%96%E7%A0%81%E8%AE%A1%E6%95%B0/20181027173309283.png" width="400" hegiht="600" >（图）编码器工作原理示意图</center><a id="more"></a><h2 id="编码计数原理"><a href="#编码计数原理" class="headerlink" title="编码计数原理"></a>编码计数原理</h2><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/AB%E5%8F%8C%E7%9B%B8%E5%A2%9E%E9%87%8F%E5%BC%8F%E7%BC%96%E7%A0%81%E8%AE%A1%E6%95%B0/520%E5%87%8F%E9%80%9F%E7%94%B5%E6%9C%BA.jpg" width="400" hegiht="400" >（图）520减速电机</center><p>&emsp;&emsp;该电机自带的编码器为A/B相霍尔计数编码器，它包含一个磁栅和磁敏检测电路，输出两个通道正交相位角为90度的方波。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/AB%E5%8F%8C%E7%9B%B8%E5%A2%9E%E9%87%8F%E5%BC%8F%E7%BC%96%E7%A0%81%E8%AE%A1%E6%95%B0/%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.gif" width="400" hegiht="600" >（图）编码器工作原理</center><p>&emsp;&emsp;上图中 A 和 B 分别连接到两个传感器单元上，黑白相间的圆环称之为栅格。如果两个信号相位相差90度，则这两个信号称为正交。由于两个信号相位相差90度，因此可以根据两个信号哪个先哪个后来判断方向。</p><p>&emsp;&emsp;<strong>正转</strong>：A相超前B相90度；<br>&emsp;&emsp;<strong>反转</strong>：A相滞后B相90度。</p><p>&emsp;&emsp;在单片机中可通过外部中断判断编码器转向，比如把编码器A相输出到单片机的外部中断输入口，这样就可以通过跳变沿触发中断，然后在对应的外部中断服务函数里面，通过B相的电平来确定正反转。若正向旋转，每个脉冲使计数器+1，若反向旋转，每个脉冲使计数器-1。</p><p>&emsp;&emsp;<strong>正转</strong>：A下降沿触发中断且B为高电平，或者A为上升沿触发中断且B为低电平；<br>&emsp;&emsp;<strong>反转</strong>：A下降沿触发中断且B为低电平，或者A为上升沿触发中断且B为高电平。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8E%9F%E7%90%86%E7%AF%87/AB%E5%8F%8C%E7%9B%B8%E5%A2%9E%E9%87%8F%E5%BC%8F%E7%BC%96%E7%A0%81%E8%AE%A1%E6%95%B0/AB%E7%9B%B8%E8%BE%93%E5%87%BA.jpg" width="400" hegiht="600" >（图）编码计数原理</center><p>&emsp;&emsp;编码器单相每圈脉冲13CPR(Counts Per Revolution，每转脉冲的个数)。再考虑减速比1:30，也就是说编码器旋转30圈，小车的轮子才转一圈。</p><p>（1）单相作用下：小车轮子转一圈，可以计数13×30=390次。<br>（2）双相作用下：小车轮子转一圈，可以计数13×30×2=780次。<br>（3）双相作用下，再考虑上升沿和下降沿变化（四倍频）：小车轮子转一圈，可以计数13×30×2×2=1560次。</p><h2 id="测速原理"><a href="#测速原理" class="headerlink" title="测速原理"></a>测速原理</h2><p>&emsp;&emsp;实际应用中，单片机根据脉冲计数来测量转速的方法有以下三种：</p><p>（1）在规定时间内测量所产生的脉冲个数来获得被测速度，称为M法测速；</p><p>&emsp;&emsp;M法是测量单位时间内的脉数换算成频率，因存在测量时间内首尾的半个脉冲问题，可能会有2个脉的误差。速度较低时，因测量时间内的脉冲数变少，误差所占的比例会变大，所以M法宜测量高速。如要降低测量的速度下限，可以提高编码器线数或加大测量的单位时间，使用一次采集的脉冲数尽可能多。</p><p>（2）测量相邻两个脉冲的时间来测量速度，称为T法测速；</p><p>&emsp;&emsp;T法是测量两个脉冲之间的时间换算成周期，从而得到频率。因存在半个时间单位的问题，可能会有1个时间单位的误差。速度较高时，测得的周期较小，误差所占的比例变大，所以T法宜测量低速。如要增加速度测量的上限，可以减小编码器的脉冲数，或使用更小更精确的计时单位，使一次测量的时间值尽可能大。</p><p>（3）同时测量检测时间和在此时间内脉冲发生器发出的脉冲个数来测量速度，称为M/T法测速。</p><p>&emsp;&emsp;M法、T法各且优劣和适应范围，编码器线数不能无限增加、测量时间也不能太长(得考虑实时性)、计时单位也不能无限小，所以往往候M法、T法都无法胜任全速度范围内的测量。因此产生了M法、T法结合的 M/T 测速法：表现为低速时测周期、高速时测频率。</p><p>&emsp;&emsp;M/T法，在脉冲上升沿开启定时时间计数，在定时时间Tg到达后，继续等待一个上升沿脉冲,时间为Td; 记录在此期间的脉冲数，由脉冲数除以时间，得到准确的频率（速度）。</p><p>&emsp;&emsp;以上三中测速方法中，M法适合于测量较高的速度，能获得较高分辨率（最容易想到）；T法适合于测量较低的速度，这时能获得较高的分辨率；而M/T法则无论高速低速都适合测量。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://www.ncnynl.com/archives/201612/1204.html">搭建ROS小车底盘-第一篇硬件</a></li><li><a href="https://blog.csdn.net/yx1302317313/article/details/80381001">AB相编码器与正交解码，绝对值编码器</a></li><li><a href="https://zhuanlan.zhihu.com/p/20268680">正交编码器的原理与使用</a></li><li><a href="https://www.cnblogs.com/hiram-zhang/p/10403600.html">SLAM+语音机器人DIY系列：（四）差分底盘设计——1.stm32主控硬件设计</a></li><li><a href="https://blog.csdn.net/Terrys0518/article/details/89931546">M/T测速实现</a></li><li><a href="https://blog.csdn.net/qq_42795251/article/details/90057308">Arduino、AB相增量式光电编码器测位移和速度方向</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 原理篇 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 原理篇 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>原理篇：双L298N电机驱动模块</title>
      <link href="/2019/12/15/%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%9A%E5%8F%8CL298N%E7%94%B5%E6%9C%BA%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97/"/>
      <url>/2019/12/15/%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%9A%E5%8F%8CL298N%E7%94%B5%E6%9C%BA%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><a href="https://github.com/xxty847/operating_principle/tree/master/%E5%8F%8CL298N%E8%B5%84%E6%96%99">双L298N电机驱动模块资料</a>已上传Github。</p>]]></content>
      
      
      <categories>
          
          <category> 原理篇 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 原理篇 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器人搭建与调试7：机器人启动功能包 robot_bringup</title>
      <link href="/2019/11/28/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%957%EF%BC%9A%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%90%AF%E5%8A%A8%E5%8A%9F%E8%83%BD%E5%8C%85%20robot_bringup/"/>
      <url>/2019/11/28/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%957%EF%BC%9A%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%90%AF%E5%8A%A8%E5%8A%9F%E8%83%BD%E5%8C%85%20robot_bringup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><img src="https://album-1257031621.cos.ap-nanjing.myqcloud.com/read_more_photos/machine-1776925_1920.jpg"></p><p>&emsp;&emsp;机器人启动功能包 <code>robot_bringup</code>主要整合各类launch启动文件，仅需一个命令就能启动机器人。</p><p>创建 robot_bringup 功能包</p><pre><code>$ catkin_create_pkg robot_bringup std_msgs rospy roscpp</code></pre><a id="more"></a><h2 id="转换里程计消息格式"><a href="#转换里程计消息格式" class="headerlink" title="转换里程计消息格式"></a>转换里程计消息格式</h2><p><strong>arduino/odom</strong> 消息格式为 <a href="http://docs.ros.org/api/nav_msgs/html/msg/Odometry.html">nav_msgs/Odometry</a></p><p><strong>robot_pose_ekf/odom_combined</strong> 消息格式为 <a href="http://docs.ros.org/api/geometry_msgs/html/msg/PoseWithCovarianceStamped.html">geometry_msgs/PoseWithCovarianceStamped</a></p><ul><li>创建<code>robot_bringup/launch/odom_ekf.py</code>文件</li></ul><figure class="highlight python"><figcaption><span>odom_ekf.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> PoseWithCovarianceStamped</span><br><span class="line"><span class="keyword">from</span> nav_msgs.msg <span class="keyword">import</span> Odometry</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OdomEKF</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># Give the node a name</span></span><br><span class="line">        rospy.init_node(<span class="string">&#x27;odom_ekf_node&#x27;</span>, anonymous=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Publisher of type nav_msgs/Odometry</span></span><br><span class="line">        self.ekf_pub = rospy.Publisher(<span class="string">&#x27;output&#x27;</span>, Odometry, queue_size=<span class="number">20</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Wait for the /odom_combined topic to become available</span></span><br><span class="line">        rospy.wait_for_message(<span class="string">&#x27;input&#x27;</span>, PoseWithCovarianceStamped)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Subscribe to the /odom_combined topic</span></span><br><span class="line">        rospy.Subscriber(<span class="string">&#x27;input&#x27;</span>, PoseWithCovarianceStamped, self.pub_ekf_odom)</span><br><span class="line">        </span><br><span class="line">        rospy.loginfo(<span class="string">&quot;Publishing combined odometry on /odom_ekf&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pub_ekf_odom</span>(<span class="params">self, msg</span>):</span></span><br><span class="line">        odom = Odometry()</span><br><span class="line">        odom.header = msg.header</span><br><span class="line">        odom.header.frame_id = <span class="string">&#x27;/odom&#x27;</span></span><br><span class="line">        odom.child_frame_id = <span class="string">&#x27;base_link&#x27;</span></span><br><span class="line">        odom.pose = msg.pose</span><br><span class="line">        </span><br><span class="line">        self.ekf_pub.publish(odom)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        OdomEKF()</span><br><span class="line">        rospy.spin()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><ul><li>创建 <code>robot_bringup/launch/odom_ekf.launch</code> 文件</li></ul><figure class="highlight c"><figcaption><span>odom_ekf.launch</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">  &lt;node pkg=<span class="string">&quot;robot_bringup&quot;</span> type=<span class="string">&quot;odom_ekf.py&quot;</span> name=<span class="string">&quot;odom_ekf&quot;</span> output=<span class="string">&quot;screen&quot;</span>&gt;</span><br><span class="line">    &lt;remap from=<span class="string">&quot;input&quot;</span> to=<span class="string">&quot;/robot_pose_ekf/odom_combined&quot;</span>/&gt;</span><br><span class="line">    &lt;remap from=<span class="string">&quot;output&quot;</span> to=<span class="string">&quot;/odom_ekf&quot;</span>/&gt;</span><br><span class="line">  &lt;/node&gt;</span><br><span class="line">&lt;/launch&gt; </span><br></pre></td></tr></table></figure><h2 id="创建小车启动运行文件"><a href="#创建小车启动运行文件" class="headerlink" title="创建小车启动运行文件"></a>创建小车启动运行文件</h2><ul><li>创建<code>robot_bringup/launch/robot_bringup.launch</code> 文件</li></ul><figure class="highlight c"><figcaption><span>robot_bringup.launch</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--小车运行文件--&gt;</span><br><span class="line"></span><br><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- (<span class="number">1</span>) 加载机器人模型 --&gt;</span><br><span class="line">    &lt;include file=<span class="string">&quot;$(find robot_description)/launch/trobot_xacro.launch&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- (<span class="number">2</span>) 加载 base_controller --&gt;</span><br><span class="line">    &lt;include file=<span class="string">&quot;$(find ros_arduino_python)/launch/arduino.launch&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- (<span class="number">3</span>) 加载 razor_imu --&gt;</span><br><span class="line">    &lt;include file=<span class="string">&quot;$(find razor_imu_9dof)/launch/razor-pub.launch&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- (<span class="number">4</span>) 加载里程计融合 robot_pose_ekf  --&gt;</span><br><span class="line">&lt;node pkg=<span class="string">&quot;robot_pose_ekf&quot;</span> type=<span class="string">&quot;robot_pose_ekf&quot;</span> name=<span class="string">&quot;robot_pose_ekf&quot;</span>&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;output_frame&quot;</span> value=<span class="string">&quot;odom&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;base_footprint_frame&quot;</span> value=<span class="string">&quot;base_link&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;freq&quot;</span> value=<span class="string">&quot;30.0&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;sensor_timeout&quot;</span> value=<span class="string">&quot;1.0&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;odom_used&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;imu_used&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;vo_used&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;debug&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;self_diagnose&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">&lt;remap from=<span class="string">&quot;imu_data&quot;</span> to=<span class="string">&quot;imu&quot;</span> /&gt;</span><br><span class="line">&lt;!-- 将节点订阅的 imu_data 话题改名为 imu,如果 imu 节点发布的话题是 imu_data 就不用修改 --&gt;</span><br><span class="line">&lt;/node&gt;</span><br><span class="line"></span><br><span class="line">   &lt;!-- (<span class="number">5</span>) 加载odom_ekf --&gt;</span><br><span class="line">    &lt;include file=<span class="string">&quot;$(find robot_bringup)/launch/odom_ekf.launch&quot;</span>/&gt; </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ROS小车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 机器人搭建与调试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器人搭建与调试6：里程计信息融合功能包 robot_pose_ekf</title>
      <link href="/2019/11/26/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%956%EF%BC%9A%E9%87%8C%E7%A8%8B%E8%AE%A1%E4%BF%A1%E6%81%AF%E8%9E%8D%E5%90%88%E5%8A%9F%E8%83%BD%E5%8C%85%20robot_pose_ekf/"/>
      <url>/2019/11/26/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%956%EF%BC%9A%E9%87%8C%E7%A8%8B%E8%AE%A1%E4%BF%A1%E6%81%AF%E8%9E%8D%E5%90%88%E5%8A%9F%E8%83%BD%E5%8C%85%20robot_pose_ekf/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;<code>robot_pose_ekf</code>功能包使用带有6D（3D position and 3D orientation）模型信息的扩展卡尔曼滤波器来整合来自轮子里程计，IMU传感器和视觉里程计的数据信息，来估算机器人的3D位姿。其基本思路就是用松耦合方式融合不同传感器信息实现位姿估计。</p><ul><li><p>github: <a href="https://github.com/ros-planning/robot_pose_ekf">https://github.com/ros-planning/robot_pose_ekf</a></p></li><li><p>roswiki:<a href="http://wiki.ros.org/robot_pose_ekf">http://wiki.ros.org/robot_pose_ekf</a></p></li></ul><a id="more"></a><h2 id="robot-pose-ekf-功能包介绍"><a href="#robot-pose-ekf-功能包介绍" class="headerlink" title="robot_pose_ekf 功能包介绍"></a>robot_pose_ekf 功能包介绍</h2><h3 id="订阅话题"><a href="#订阅话题" class="headerlink" title="订阅话题"></a>订阅话题</h3><p>&emsp;&emsp;<code>robot_pose_ekf</code> 默认订阅的topic为：<code>imu_data</code>、<code>odom</code> 和 <code>vo</code>，因此要注意发布消息时topic的名称要对应，否则会起不到滤波作用。不想使用默认名称的话可以用remap元素进行名称重映射。</p><ul><li><strong>odom</strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/Odometry.html">nav_msgs/Odometry</a>)</li></ul><blockquote><p>2D pose (used by wheel odometry): 该2D pose包含了机器人在地面的位置（position）和方位（orientation）信息以及该位姿的协方差（covariance）。用来发送该2D位姿的消息实际上表示了一个3D位姿，只不过把z，pitch和roll分量简单忽略了（平面上的轮式移动机器人）。</p></blockquote><ul><li><strong>imu_data</strong> (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/Imu.html">sensor_msgs/Imu</a>)</li></ul><blockquote><p>3D orientation (used by the IMU): 3D方位提供机器人底座相对于世界坐标系的Roll, Pitch and Yaw偏角。 Roll and Pitch角是绝对角度（因为IMU使用了重力参考），而YAW角是相对角度。 协方差矩阵用来指定方位测量的不确定度。当仅仅收到这个主题消息时，机器人位姿ekf还不会启动，因为它还需要来自主题’vo’或者’odom’的消息。</p></blockquote><ul><li><strong>vo</strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/Odometry.html">nav_msgs/Odometry</a>)</li></ul><blockquote><p>3D pose (used by Visual Odometry): 3D位姿可以完整表示机器人的位置和方位并给出位姿协方差。当用传感器只测量部分3D位姿(e.g. the wheel odometry only measures a 2D pose)时候, 可以给还未真正开始测量的部分3D位姿先简单指定一个大的协方差。</p></blockquote><h3 id="发布话题"><a href="#发布话题" class="headerlink" title="发布话题"></a>发布话题</h3><ul><li><strong>robot_pose_ekf/odom_combined</strong> (<a href="http://docs.ros.org/api/geometry_msgs/html/msg/PoseWithCovarianceStamped.html">geometry_msgs/PoseWithCovarianceStamped</a>)</li></ul><h3 id="TF-变换"><a href="#TF-变换" class="headerlink" title="TF 变换"></a>TF 变换</h3><ul><li><strong>odom_combined → base_footprint</strong></li></ul><div class="note warning">            <p>在ROS小车中</p><ul><li><code>/imu_data</code>话题来自 <code>razor_imu_9dof</code>传感器。</li><li><code>/arduino</code> 发布话题 <code>/odom</code> ，消息格式为 <code>nav_msgs/Odometry</code>；</li><li><code>/robot_pose_ekf</code> 发布话题 <code>robot_pose_ekf/odom_combined</code>， 消息格式为 <code>geometry_msgs/PoseWithCovarianceStamped</code>。两者消息格式不一样，需要转换格式再使用。</li></ul>          </div><h2 id="robot-pose-ekf-功能包使用"><a href="#robot-pose-ekf-功能包使用" class="headerlink" title="robot_pose_ekf 功能包使用"></a>robot_pose_ekf 功能包使用</h2><h3 id="robot-pose-ekf-launch-文件"><a href="#robot-pose-ekf-launch-文件" class="headerlink" title="robot_pose_ekf launch 文件"></a>robot_pose_ekf launch 文件</h3><figure class="highlight c"><figcaption><span>robot_pose_ekf.launch</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;launch&gt;</span><br><span class="line">      &lt;node pkg=<span class="string">&quot;robot_pose_ekf&quot;</span> type=<span class="string">&quot;robot_pose_ekf&quot;</span> name=<span class="string">&quot;robot_pose_ekf&quot;</span>&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;output_frame&quot;</span> value=<span class="string">&quot;odom_combined&quot;</span>/&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;base_footprint_frame&quot;</span> value=<span class="string">&quot;base_footprint&quot;</span>/&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;freq&quot;</span> value=<span class="string">&quot;30.0&quot;</span>/&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;sensor_timeout&quot;</span> value=<span class="string">&quot;1.0&quot;</span>/&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;odom_used&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;imu_used&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;vo_used&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;debug&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;self_diagnose&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line"> &lt;/launch&gt;</span><br></pre></td></tr></table></figure><pre><code>- freq: 滤波器更新和发布频率。注意：频率高仅仅意味着一段时间可以获得更多机器人位姿信息，但是并不表示可以提高每次位姿评估的精度。- sensor_timeout: 当传感器停止向滤波器发送信息时，滤波器在没有传感器的情况下等待多长时间才重新开始工作。- odom_used, imu_used, vo_used: 是否订阅各类数据。</code></pre><h3 id="TF-树维护"><a href="#TF-树维护" class="headerlink" title="TF 树维护"></a>TF 树维护</h3><p>（1）打开终端，运行robot_pose_ekf 节点</p><pre><code>$ roscore$ roslaunch ros_arduino_python arduino.launch （树莓派3B）$ roslaunch razor_imu_9dof razor-pub.launch （树莓派3B）$ roslaunch robot_pose_ekf robot_pose_ekf.launch</code></pre><p>（2）修改程序</p><ul><li>查看tf树</li></ul><pre><code>$ rosrun rqt_tf_tree rqt_tf_tree</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%A1%AC%E4%BB%B6%E6%90%AD%E5%BB%BA/robot_pose_ekf%20%E6%9F%A5%E7%9C%8BTF%E6%A0%91.jfif" width="600" hegiht="400" >（图）修改前的TF树 </center><p>可以看出有两个TF树:</p><pre><code>/odom -&gt; /base_link : /odom 来自 /arduino 节点，/odom_combined -&gt; /base_footprint : /odom_combined 来自 /robot_pose_ekf 节点</code></pre><p>这是因为 <code>ros_arduino_bridge</code> 包下 <code>base_controller.py</code> 文件发布了 <code>/odom</code> ，应该注释掉这一段，使用 <code>/robot_pose_ekf</code> 节点发布的tf。</p><ul><li>修改 <code>base_controller.py</code> 文件</li></ul><figure class="highlight python"><figcaption><span>base_controller.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create the odometry transform frame broadcaster.</span></span><br><span class="line">self.odomBroadcaster.sendTransform(</span><br><span class="line">(self.x, self.y, <span class="number">0</span>), </span><br><span class="line">(quaternion.x, quaternion.y, quaternion.z, quaternion.w),</span><br><span class="line">rospy.Time.now(),</span><br><span class="line">self.base_frame,</span><br><span class="line"><span class="string">&quot;odom&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li>修改 robot_pose_ekf.launch 文件</li></ul><figure class="highlight c"><figcaption><span>robot_pose_ekf.launch</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">&lt;node pkg=<span class="string">&quot;robot_pose_ekf&quot;</span> type=<span class="string">&quot;robot_pose_ekf&quot;</span> name=<span class="string">&quot;robot_pose_ekf&quot;</span>&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;output_frame&quot;</span> value=<span class="string">&quot;odom&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;base_footprint_frame&quot;</span> value=<span class="string">&quot;base_link&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;freq&quot;</span> value=<span class="string">&quot;30.0&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;sensor_timeout&quot;</span> value=<span class="string">&quot;1.0&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;odom_used&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;imu_used&quot;</span> value=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;vo_used&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;debug&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">&quot;self_diagnose&quot;</span> value=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">&lt;remap from=<span class="string">&quot;imu_data&quot;</span> to=<span class="string">&quot;imu&quot;</span> /&gt;</span><br><span class="line">&lt;!-- 将节点订阅的 imu_data 话题改名为 imu,如果 imu 节点发布的话题是 imu_data 就不用修改 --&gt;</span><br><span class="line">&lt;/node&gt;</span><br><span class="line"> &lt;/launch&gt;</span><br></pre></td></tr></table></figure><pre><code>output_frame：更改 odom_combined 为 odombase_footprint_frame：更改 base_footprint 为 base_linkimu节点重映射：将将节点订阅的 imu_data 话题改名为 imu</code></pre><ul><li>再查看tf树</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%A1%AC%E4%BB%B6%E6%90%AD%E5%BB%BA/robot_pose_ekf%20%E6%9F%A5%E7%9C%8B%E4%BF%AE%E6%94%B9%E5%90%8ETF%E6%A0%91.jfif" width="400" hegiht="400" >（图）修改后的TF树 </center><p>可以看出 /odom 来自 /robot_pose_ekf ，TF树正确无误，可以进行下一阶段。</p><h2 id="添加协方差矩阵"><a href="#添加协方差矩阵" class="headerlink" title="添加协方差矩阵"></a>添加协方差矩阵</h2><p><strong>imu数据的协方差矩阵：</strong> razor_imu_9dof 的IMU，它有官方提供的软件包，会带有covariance，不需要添加。<br><strong>底盘运动时odom的协方差矩阵：</strong>打开 ros_arduino_bridge包下 python base_controller.py ，添加协方差矩阵。</p><figure class="highlight python"><figcaption><span>base_controller.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">odom = Odometry()</span><br><span class="line">            odom.header.frame_id = <span class="string">&quot;odom&quot;</span></span><br><span class="line">            odom.child_frame_id = self.base_frame</span><br><span class="line">            odom.header.stamp = now</span><br><span class="line">            odom.pose.pose.position.x = self.x</span><br><span class="line">            odom.pose.pose.position.y = self.y</span><br><span class="line">            odom.pose.pose.position.z = <span class="number">0</span></span><br><span class="line">            odom.pose.pose.orientation = quaternion</span><br><span class="line">            odom.pose.covariance = [<span class="number">1e-9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">1e-3</span>, <span class="number">1e-9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">0</span>, <span class="number">1e6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1e6</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1e6</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1e-9</span>]</span><br><span class="line">            odom.twist.twist.linear.x = vxy</span><br><span class="line">            odom.twist.twist.linear.y = <span class="number">0</span></span><br><span class="line">            odom.twist.twist.angular.z = vth</span><br><span class="line">            odom.twist.covariance = [<span class="number">1e-9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">1e-3</span>, <span class="number">1e-9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">0</span>, <span class="number">1e6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1e6</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1e6</span>, <span class="number">0</span>,</span><br><span class="line">                                    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1e-9</span>]</span><br><span class="line"></span><br><span class="line">            self.odomPub.publish(odom)</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><p><a href="https://www.cnblogs.com/21207-iHome/p/8117069.html">使用robot_pose_ekf对传感器信息融合</a></p></li><li><p><a href="https://blog.csdn.net/shenghuaijing3314/article/details/78220151">使用robot_pose_ekf对传感器信息融合</a></p></li><li><p><a href="https://blog.csdn.net/zhxue_11/article/details/83828877">robot_pose_ekf源码解读</a></p></li><li><p><a href="https://blog.csdn.net/xiekaikaibing/article/details/80402113">使用EKF融合odometry及imu数据</a></p></li><li><p><a href="https://blog.csdn.net/ethan_guo/article/details/79635575">robot_pose_ekf使用遇到的问题</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS小车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 机器人搭建与调试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器人搭建与调试5：线速度、角速度校准</title>
      <link href="/2019/11/25/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%955%EF%BC%9A%E7%BA%BF%E9%80%9F%E5%BA%A6%E3%80%81%E8%A7%92%E9%80%9F%E5%BA%A6%E6%A0%A1%E5%87%86/"/>
      <url>/2019/11/25/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%955%EF%BC%9A%E7%BA%BF%E9%80%9F%E5%BA%A6%E3%80%81%E8%A7%92%E9%80%9F%E5%BA%A6%E6%A0%A1%E5%87%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>robot_calibration 功能包代码已上传至<a href="https://github.com/xiaoxiaotaoya/ROS-robot/tree/master/robot_calibration">github robot_calibration</a></p><pre><code>tao@ubuntu:~/catkin_ws/src/robot_calibration$ tree.├── cfg│   ├── CalibrateAngular.cfg   #角速度校准窗口│   └── CalibrateLinear.cfg    #线速度校准窗口├── CMakeLists.txt├── package.xml└── scripts    ├── calibrate_angular.py  #角速度校准    ├── calibrate_linear.py  #线速度校准    ├── nav_square.py  #正方形行走测试    ├── odom_out_and_back.py  #来回行走测试    └── transform_utils.py #角度转换</code></pre><a id="more"></a><h2 id="创建robot-calibration速度校准功能包"><a href="#创建robot-calibration速度校准功能包" class="headerlink" title="创建robot_calibration速度校准功能包"></a>创建robot_calibration速度校准功能包</h2><p>创建 robot_calibration 功能包</p><pre><code>$ cs$ catkin_create_pkg robot_calibration geometry_msgs dynamic_reconfigure roscpp rospy std_msgs$ cm</code></pre><ul><li>新建cfg文件夹</li><li>创建CalibrateAngular.cfg文件</li><li>创建CalibrateLinear.cfg文件</li><li>修改CMakeLists.txt文件</li></ul><h2 id="线速度校准"><a href="#线速度校准" class="headerlink" title="线速度校准"></a>线速度校准</h2><pre><code>$ ssh pi@192.168.1.138 （SSH连接树莓派）$ roscore （PC电脑）$ roslaunch ros_arduino_python arduino.launch （树莓派）$ rosrun robot_calibration calibrate_linear.py （PC电脑）$ rosrun rqt_reconfigure rqt_reconfigure （PC电脑）</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%A1%AC%E4%BB%B6%E6%90%AD%E5%BB%BA/%E7%BA%BF%E9%80%9F%E5%BA%A6%E6%A0%A1%E5%87%86.jfif" width="600" hegiht="400" >（图）线速度校准 </center><p><strong>线速度校准流程：</strong></p><p>（1）设定参数后，点击 <code>start_test</code> ，开始测试；</p><pre><code>test_distance：目标距离 （单位: m）speed：线速度 （单位: m/s）tolerance：误差odom_linear_scale_correction：线速度缩放比例</code></pre><p>（2）根据校准结果，记下 <code>odom_linear_scale_correction</code> 值。</p><pre><code>odom_linear_scale_correction 初始值为1；如果小车目标距离为1m,小车实际前进1.27m，则odom_linear_scale_correction 值为1.27；同理，如果小车实际前进0.68m，则 odom_linear_scale_correction 值为0.68</code></pre><p>（3）修改树莓派上 <code>ros_arduino_bridge/ros_arduino_python/config/my_arduino_params.yaml</code> 文件中 <code>linear_scale_correction</code> 的值为校准后的值。</p><pre><code>linear_scale_correction: 1.26 线速度缩放比例 linear_scale_correction 与每米编码计数 ticks_per_meter 有关# How many encoder ticks are there per meter?self.ticks_per_meter = self.encoder_resolution * self.gear_reduction  / (self.wheel_diameter * pi)self.ticks_per_meter = self.ticks_per_meter/self.linear_scale_correction</code></pre><p>（5）最后可根据校准后的 <code>linear_scale_correction</code> 值测试是否正确到达目标位置。</p><h2 id="角速度校准"><a href="#角速度校准" class="headerlink" title="角速度校准"></a>角速度校准</h2><pre><code>$ ssh pi@192.168.1.138 （SSH连接树莓派）$ roscore （PC电脑）$ roslaunch ros_arduino_python arduino.launch （树莓派）$ rosrun robot_calibration calibrate_angular.py （PC电脑）$ rosrun rqt_reconfigure rqt_reconfigure （PC电脑）</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%A1%AC%E4%BB%B6%E6%90%AD%E5%BB%BA/%E8%A7%92%E9%80%9F%E5%BA%A6%E6%A0%A1%E5%87%86.jfif" width="600" hegiht="400" >（图）角速度校准</center><p><strong>角速度校准流程：</strong></p><p>（1）设定参数，点击 <code>start_test</code> ，开始测试；</p><pre><code>test_angle ：目标角度（单位: °）speed：角速度（单位: rad/s）tolerance：误差odom_angular_scale_correction：角速度缩放比例</code></pre><p>（2）根据校准结果，记下 <code>odom_angular_scale_correction</code> 值。</p><pre><code>odom_angular_scale_correction 初始值为1；如果小车目标角度为360°,小车实际旋转380°，则 odom_angular_scale_correction 值为1.055；同理，如果小车实际旋转270°，则 odom_angular_scale_correction 值为0.75。</code></pre><p>（4）修改树莓派上 <code>ros_arduino_bridge/ros_arduino_python/config/my_arduino_params.yaml</code> 文件中 <code>angular_scale_correction</code> 的值为校准后的值。</p><pre><code>angular_scale_correction: 1.0角速度缩放比例 angular_scale_correction 与两轮间距 wheel_track 有关self.wheel_track = pid_params[&#39;wheel_track&#39;]self.wheel_track    = self.wheel_track/self.angular_scale_correction</code></pre><p>（5）最后可根据校准后的 <code>angular_scale_correction</code> 值测试是否正确到达目标角度。</p><pre><code>注意：角速度校准包含 transform_utils.py 文件，其提供 quat_to_angle, normalize_angle 两个角度转换函数。</code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://blog.csdn.net/ykevin0510/article/details/82525949">【ROS Rikirobot基础-使用系列 第二章节】-Rikirobot的IMU、线速度、角速度的校准</a></li><li><a href="https://www.corvin.cn/916.html">三轮全向移动小车的线速度标定</a></li><li><a href="https://blog.csdn.net/mwlwlm/article/details/53004914">ROS机器人Diego 1#制作（四）base controller—线速度的标定</a></li><li><a href="https://blog.csdn.net/mwlwlm/article/details/53126717">ROS机器人Diego 1#制作（五）base controller—角速度的标定</a></li><li><a href="https://www.ncnynl.com/archives/201701/1217.html">ROS机器人Diego制作4-线速度的标定</a></li><li><a href="https://www.ncnynl.com/archives/201701/1218.html">ROS机器人Diego制作5-角速度的标定</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS小车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 机器人搭建与调试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器人搭建与调试4：PID速度控制</title>
      <link href="/2019/11/24/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%954%EF%BC%9APID%E9%80%9F%E5%BA%A6%E6%8E%A7%E5%88%B6/"/>
      <url>/2019/11/24/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%954%EF%BC%9APID%E9%80%9F%E5%BA%A6%E6%8E%A7%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> ROS小车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 机器人搭建与调试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器人搭建与调试3：底层控制ros_arduino_bridge修改 树莓派篇</title>
      <link href="/2019/11/23/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%953%EF%BC%9A%E5%BA%95%E5%B1%82%E6%8E%A7%E5%88%B6ros_arduino_bridge%E4%BF%AE%E6%94%B9%20%E6%A0%91%E8%8E%93%E6%B4%BE%E7%AF%87/"/>
      <url>/2019/11/23/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%953%EF%BC%9A%E5%BA%95%E5%B1%82%E6%8E%A7%E5%88%B6ros_arduino_bridge%E4%BF%AE%E6%94%B9%20%E6%A0%91%E8%8E%93%E6%B4%BE%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> ROS小车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 机器人搭建与调试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器人搭建与调试2：底层控制ros_arduino_bridge修改 arduino篇</title>
      <link href="/2019/11/22/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%952%EF%BC%9A%E5%BA%95%E5%B1%82%E6%8E%A7%E5%88%B6ros_arduino_bridge%E4%BF%AE%E6%94%B9%20arduino%E7%AF%87/"/>
      <url>/2019/11/22/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%952%EF%BC%9A%E5%BA%95%E5%B1%82%E6%8E%A7%E5%88%B6ros_arduino_bridge%E4%BF%AE%E6%94%B9%20arduino%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;使用Arduino开发板作为底层控制（base_controller），有<a href="https://github.com/ros-drivers/rosserial">rosserial_arduino</a>和<a href="https://github.com/hbrobotics/ros_arduino_bridge">ros_arduino_bridge</a>两种实现方式。其中 <code>rosserial_arduino</code> 将航迹推演、话题发布等都放在Arduino开发板上，占用资源大；而<code>ros_arduino_bridge</code>在Arduino开发板上只用来控制电机、舵机驱动，将计算部分放在ROS从机中，大大节省Arduino开发板占用资源，此外可外接更多传感器。<br>&emsp;&emsp;本ROS小车选择<code>ros_arduino_bridge</code>作为底层控制（base_controller）。</p><ul><li><a href="https://blog.csdn.net/github_30605157/article/details/51344150">ros_arduino_bridge功能包集的使用</a></li><li><a href="https://blog.csdn.net/github_30605157/article/details/51621965">ros_arduino_bridge功能包集的使用错误及解决方法总结</a></li></ul><p> <strong>ros_arduino_bridge  框架结构（arduino篇）</strong></p><pre><code>    ROSArduinoBridge            #Arduino相关库定义        ├── commands.h              #定义命令        ├── diff_controller.h       #差分轮PID控制头文件        ├── encoder_driver.h        #编码器驱动头文件，定义插脚(pins)        ├── encoder_driver.ino      #编码器驱动实现, 读取编码器数据，重置编码器等        ├── motor_driver.h          #电机驱动头文件        ├── motor_driver.ino        #电机驱动实现，初始化控制器，设置速度        ├── ROSArduinoBridge.ino    #核心功能实现，        ├── sensors.h               #传感器头文件及实现        ├── servos.h                #伺服器头文件，定义插脚，类        └── servos.ino              #伺服器实现</code></pre><p>&emsp;&emsp;对底层控制 <code>ros_arduino_bridge</code> 代码修改主要放在<code>encoder_driver</code>、<code>motor_driver</code>、<code>ROSArduinoBridge</code>、<code>commands</code>上，其它如<code>diff_controller</code>等暂时不需要修改。已整理修改后的代码，见 <a href="https://github.com/xiaoxiaotaoya/ROS-robot/tree/master/ros_arduino_bridge">ROS-robot</a>。</p><a id="more"></a><h2 id="安装底层驱动功能包-ros-arduino-bridge"><a href="#安装底层驱动功能包-ros-arduino-bridge" class="headerlink" title="安装底层驱动功能包 ros_arduino_bridge"></a>安装底层驱动功能包 ros_arduino_bridge</h2><p>打开虚拟机终端，运行以下命令安装<a href="https://github.com/hbrobotics/ros_arduino_bridge">ros_arduino_bridge </a> 源码：</p><pre><code>$ cs  ($ cd ~/catkin_ws/src 命令简化)$ https://github.com/hbrobotics/ros_arduino_bridge$ cm  ($ cd ~/catkin_ws &amp;&amp; catkin_make 命令简化)</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/hexo/ROS%E5%B0%8F%E8%BD%A6/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA/ros_arduino_bridge/ros_arduino_bridge%20github.JPG" width="800" hegiht="400" >（图）ros_arduino_bridge github </center><p>&emsp;&emsp;其中Arduino开发板上使用的程序在 <code>/ros_arduino_firmware/src/libraries/ROSArduinoBridge/</code> 文件夹中，可复制出来，编译修改烧写到Arduino开发板中。</p><h2 id="电机驱动代码修改（motor-driver）"><a href="#电机驱动代码修改（motor-driver）" class="headerlink" title="电机驱动代码修改（motor_driver）"></a>电机驱动代码修改（motor_driver）</h2><h3 id="引脚连接"><a href="#引脚连接" class="headerlink" title="引脚连接"></a>引脚连接</h3><table><thead><tr><th>6WD扩展版</th><th>Arduino开发板</th></tr></thead><tbody><tr><td>5V</td><td>5V</td></tr><tr><td>GND</td><td>GND</td></tr><tr><td>SDA</td><td>SDA</td></tr><tr><td>SCL</td><td>SCL</td></tr></tbody></table><h3 id="驱动原理"><a href="#驱动原理" class="headerlink" title="驱动原理"></a>驱动原理</h3><p>根据扩展版上<code>PCA9685PW模块</code>控制<code>AM2857电机驱动模块</code>驱动4路520编码电机（非I/O直接驱动）。</p><ul><li><p><strong><a href="https://www.yahboom.com/study_module/6wd_ext">PCA9685模块</a>：</strong>PCA9685是一个IIC总线控制的16通道LED控制器，每个LED控制器都有12位分辨率（4096步）固定频率单独PWM控制器。<a href="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/hexo/ROS%E5%B0%8F%E8%BD%A6/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA/%E6%A8%A1%E5%9D%97%E9%80%89%E5%9E%8B/6WD%E9%A9%B1%E5%8A%A8%E6%9D%BF%E5%8E%9F%E7%90%86%E5%9B%BE.pdf">6WD扩展板原理图</a></p></li><li><p><strong><a href="https://www.yahboom.com/study_module/AM2857">AM2857电机驱动模块</a>：</strong>双路电机驱动模块。 <a href="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/hexo/ROS%E5%B0%8F%E8%BD%A6/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA/%E6%A8%A1%E5%9D%97%E9%80%89%E5%9E%8B/AM2857%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E5%8E%9F%E7%90%86%E5%9B%BE.pdf">AM2857电机驱动模块原理图</a></p></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/hexo/ROS%E5%B0%8F%E8%BD%A6/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA/ros_arduino_bridge/%E7%94%B5%E6%9C%BA%E9%A9%B1%E5%8A%A8%E5%8E%9F%E7%90%86.JPG" width="600" hegiht="400" >（图）以M1 M2电机为例</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/hexo/ROS%E5%B0%8F%E8%BD%A6/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA/ros_arduino_bridge/%E7%94%B5%E6%9C%BA%E9%A9%B1%E5%8A%A8%E7%9C%9F%E5%80%BC%E8%A1%A8.JPG" width="600" hegiht="400" >（图）AM2857电机驱动模块真值表</center><p><code>Adafruit-PWM-Servo-Driver库</code>函数有<code>pwm.setPin()</code>、<code>drive.setPWM()</code>两种驱动方式。本文选择<code>drive.setPWM()</code>，其驱动方式如下：</p><table><thead><tr><th>编号</th><th>电机</th><th>扩展板引脚</th><th>PCA9685</th><th>前进</th><th>后退</th></tr></thead><tbody><tr><td>M1</td><td>左前电机</td><td>AIN2</td><td>LED8</td><td>setPWM(8, 0, 0);</td><td>setPWM(8, 0, spd);</td></tr><tr><td></td><td></td><td>AIN1</td><td>LED9</td><td>setPWM(9, 0, spd);</td><td>setPWM(9, 0, 0);</td></tr><tr><td>M2</td><td>左后电机</td><td>BIN2</td><td>LED10</td><td>setPWM(10, 0, 0);</td><td>setPWM(10, 0, spd);</td></tr><tr><td></td><td></td><td>BIN1</td><td>LED11</td><td>setPWM(11, 0, spd);</td><td>setPWM(11, 0, 0);</td></tr><tr><td>M5</td><td>右前电机</td><td>3AIN1</td><td>LED14</td><td>setPWM(14, 0, spd);</td><td>setPWM(14, 0, 0);</td></tr><tr><td></td><td></td><td>3AIN2</td><td>LED15</td><td>setPWM(15, 0, 0);</td><td>setPWM(15, 0, spd);</td></tr><tr><td>M6</td><td>右后电机</td><td>3BIN1</td><td>LED12</td><td>setPWM(12, 0, spd);</td><td>setPWM(12, 0, 0);</td></tr><tr><td></td><td></td><td>3BIN2</td><td>LED13</td><td>setPWM(13, 0, 0);</td><td>setPWM(13, 0, spd);</td></tr></tbody></table><h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><p>&emsp;&emsp;由于6WD扩展版PCA9685模块吸流而导致电流小问题，不能直接通过电机驱动模块引脚驱动电机，只能采用PCA9685模块间接驱动电机，PWM可选范围为0-4095，所以MAX_PWM设置为4095。（如果采用Arduino开发板通过电机驱动模块直接驱动电机，PWM引脚范围为 0-255，MAX_PWM则设置为255）</p><p>&emsp;&emsp;电机驱动需要<a href="https://github.com/xiaoxiaotaoya/ROS-robot/tree/master/I2Cdev">I2Cdev</a>、<a href="https://github.com/xiaoxiaotaoya/ROS-robot/tree/master/Adafruit-PWM-Servo-Driver">Adafruit-PWM-Servo-Driver</a>两个库。下载后放在Arduino安装目录下libraries文件夹中即可。</p><figure class="highlight c"><figcaption><span>motor_driver.h</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* *************************************************************</span></span><br><span class="line"><span class="comment">  电机驱动模块AM2857</span></span><br><span class="line"><span class="comment">   ************************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initMotorController</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setMotorSpeed</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> spd)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setMotorSpeeds</span><span class="params">(<span class="keyword">int</span> leftSpeed, <span class="keyword">int</span> rightSpeed)</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight c"><figcaption><span>motor_driver.ino</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载I2C和电机驱动库</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;commands.h&quot;</span>;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Wire.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Adafruit_PWMServoDriver.h&gt;</span></span></span><br><span class="line">Adafruit_PWMServoDriver drive = Adafruit_PWMServoDriver(<span class="number">0x41</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义最大PWM</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_PWM  4095</span></span><br><span class="line"></span><br><span class="line">boolean directionLeft = <span class="literal">false</span>;</span><br><span class="line">boolean directionRight = <span class="literal">false</span>;</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 初始化电机控制</span></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">initMotorController</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">     drive.begin();</span><br><span class="line">     drive.setPWMFreq(<span class="number">50</span>);</span><br><span class="line">     </span><br><span class="line">     drive.setPWM(<span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">     drive.setPWM(<span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">     drive.setPWM(<span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">     drive.setPWM(<span class="number">11</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">     </span><br><span class="line">     drive.setPWM(<span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">     drive.setPWM(<span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">     drive.setPWM(<span class="number">15</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">     drive.setPWM(<span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>);  </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 确定方向</span></span><br><span class="line"> <span class="function">boolean <span class="title">direction</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">   <span class="keyword">if</span>(i == LEFT)&#123;</span><br><span class="line">      <span class="keyword">return</span> directionLeft;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> directionRight;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PWM控制 </span></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">setMotorSpeed</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> spd)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(spd &gt; MAX_PWM)&#123;</span><br><span class="line">      spd = MAX_PWM;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(spd &lt; -MAX_PWM)&#123;</span><br><span class="line">      spd = <span class="number">-1</span> * MAX_PWM;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (i == LEFT)&#123;</span><br><span class="line">        <span class="keyword">if</span>(spd&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            directionLeft = FORWARDS;</span><br><span class="line">             drive.setPWM(<span class="number">9</span>, <span class="number">0</span>, spd);</span><br><span class="line">             drive.setPWM(<span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">             drive.setPWM(<span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">             drive.setPWM(<span class="number">11</span>, <span class="number">0</span>, spd);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(spd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            directionLeft = BACKWARDS;</span><br><span class="line">            spd = <span class="number">-1</span> * spd; </span><br><span class="line">             drive.setPWM(<span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">             drive.setPWM(<span class="number">8</span>, <span class="number">0</span>, spd);</span><br><span class="line">             drive.setPWM(<span class="number">10</span>, <span class="number">0</span>, spd);</span><br><span class="line">             drive.setPWM(<span class="number">11</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(spd&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            directionRight = FORWARDS;</span><br><span class="line">             drive.setPWM(<span class="number">12</span>, <span class="number">0</span>, spd);</span><br><span class="line">             drive.setPWM(<span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">             drive.setPWM(<span class="number">15</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">             drive.setPWM(<span class="number">14</span>, <span class="number">0</span>, spd);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(spd&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            directionRight = BACKWARDS;</span><br><span class="line">            spd = <span class="number">-1</span> * spd;</span><br><span class="line">             drive.setPWM(<span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">             drive.setPWM(<span class="number">13</span>, <span class="number">0</span>, spd);</span><br><span class="line">             drive.setPWM(<span class="number">15</span>, <span class="number">0</span>, spd);</span><br><span class="line">             drive.setPWM(<span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//左右两轮电机控制</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">setMotorSpeeds</span><span class="params">(<span class="keyword">int</span> leftSpeed, <span class="keyword">int</span> rightSpeed)</span> </span>&#123;</span><br><span class="line">    setMotorSpeed(LEFT, leftSpeed);</span><br><span class="line">    setMotorSpeed(RIGHT, rightSpeed);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="编码计数代码修改（encoder-driver）"><a href="#编码计数代码修改（encoder-driver）" class="headerlink" title="编码计数代码修改（encoder_driver）"></a>编码计数代码修改（encoder_driver）</h2><h3 id="引脚连接-1"><a href="#引脚连接-1" class="headerlink" title="引脚连接"></a>引脚连接</h3><table><thead><tr><th>6WD扩展版</th><th>Arduino开发板</th></tr></thead><tbody><tr><td>M1B</td><td>4</td></tr><tr><td>M1A</td><td>18</td></tr><tr><td>M6B</td><td>5</td></tr><tr><td>M6A</td><td>19</td></tr></tbody></table><h3 id="编码计数原理"><a href="#编码计数原理" class="headerlink" title="编码计数原理"></a>编码计数原理</h3><p>&emsp;&emsp;测速的编码器是双通道霍尔效应编码器，它包含一个磁栅和磁敏检测电路，输出两个通道正交相位角为90度的方波。该编码器单路每圈脉冲13CPR(Counts Per Revolution，每转脉冲的个数)。一方面由于每圈又可以分一个上升沿和一个下降沿，另一方面该编码器拥有AB双相输出，所以每转一圈，该编码器的AB双相上下沿总共可以输出52CPR。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/hexo/ROS%E5%B0%8F%E8%BD%A6/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA/ros_arduino_bridge/AB%E5%8F%8C%E7%9B%B8.png" width="600" hegiht="400" >（图）以M1 M2电机为例</center><p>&emsp;&emsp;小车轮子转一圈，还需要考虑减速比1:30（编码器侧转30圈，小车的轮子才转一圈）。所以小车轮子转一圈，可以产生52*30=1560个脉冲信号。这方面计算在ROS从机树莓派上完成。</p><p>&emsp;&emsp;本ROS小车使用Arduino mega 2560开发板完成编码计数。Arduino mega 2560开发板有六个外部中断，触发外部中断方式有四种。本文使用下降沿触发外部中断计数，每当触发一次外部中断，就计数一次。</p><pre><code>attachInterrupt(interrupt, ISR, mode) 外部中断配置函数- interrupt: 中断号，不同Arduino开发板中断号不同。- ISR: 中断处理函数。此函数不带参数，没有返回值。- mode: 中断触发方式。    - LOW: 低电平触发。    - CHANGE:管脚状态改变触发（ 电平变化，高电平变低电平、低电平变高电平）。    - RISING:上升沿触发。    - FALLING:下降沿触发。</code></pre><h3 id="源代码-1"><a href="#源代码-1" class="headerlink" title="源代码"></a>源代码</h3><figure class="highlight c"><figcaption><span>encoder_driver.h</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* *************************************************************</span></span><br><span class="line"><span class="comment">   Arduino mega 外部中断：</span></span><br><span class="line"><span class="comment">   中断号 int0  ----- 引脚号 2 </span></span><br><span class="line"><span class="comment">   中断号 int1  ----- 引脚号 3</span></span><br><span class="line"><span class="comment">   中断号 int2  ----- 引脚号 21</span></span><br><span class="line"><span class="comment">   中断号 int3  ----- 引脚号 20</span></span><br><span class="line"><span class="comment">   中断号 int4  ----- 引脚号 19</span></span><br><span class="line"><span class="comment">   中断号 int5  ----- 引脚号 18   </span></span><br><span class="line"><span class="comment">   ************************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 左轮</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ENC_LEFT_PINA 18</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ENC_LEFT_PINB 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 右轮</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ENC_RIGHT_PINA 19</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ENC_RIGHT_PINB 5</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initEncoders</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">readEncoder</span><span class="params">(<span class="keyword">int</span> i)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">resetEncoders</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight c"><figcaption><span>encoder_driver.ino</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;motor_driver.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;encoder_driver.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;commands.h&quot;</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> left_enc_pos = <span class="number">0L</span>;</span><br><span class="line"><span class="keyword">int</span> right_enc_pos = <span class="number">0L</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initEncoders</span><span class="params">()</span></span>&#123;</span><br><span class="line">  pinMode(ENC_LEFT_PINA, INPUT);</span><br><span class="line">  pinMode(ENC_LEFT_PINB, INPUT);</span><br><span class="line">  attachInterrupt(<span class="number">5</span>, encoderLeftISR,FALLING);  </span><br><span class="line">    </span><br><span class="line">  pinMode(ENC_RIGHT_PINA, INPUT);</span><br><span class="line">  pinMode(ENC_RIGHT_PINB, INPUT);</span><br><span class="line">  attachInterrupt(<span class="number">4</span>, encoderRightISR,FALLING);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//每次产生中断，根据左轮方向计数器加1或减1</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encoderLeftISR</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(digitalRead(ENC_LEFT_PINB)==HIGH)&#123;</span><br><span class="line">      left_enc_pos++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      left_enc_pos--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//每次产生中断，根据右轮方向计数器加1或减1</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encoderRightISR</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(digitalRead(ENC_RIGHT_PINB)==HIGH)&#123;</span><br><span class="line">      right_enc_pos--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      right_enc_pos++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Wrap the encoder reading function */</span></span><br><span class="line">  <span class="function"><span class="keyword">long</span> <span class="title">readEncoder</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (i == LEFT) <span class="keyword">return</span> <span class="number">0</span>-left_enc_pos;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> right_enc_pos;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Wrap the encoder reset function */</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">resetEncoder</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (i == LEFT)&#123;</span><br><span class="line">      left_enc_pos=<span class="number">0L</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">      right_enc_pos=<span class="number">0L</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">resetEncoders</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  resetEncoder(LEFT);</span><br><span class="line">  resetEncoder(RIGHT);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="主代码修改（ros-arduino-bridge）"><a href="#主代码修改（ros-arduino-bridge）" class="headerlink" title="主代码修改（ros_arduino_bridge）"></a>主代码修改（ros_arduino_bridge）</h2><figure class="highlight c"><figcaption><span>ros_arduino_bridge.ino</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载库</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Arduino.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;commands.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;motor_driver.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;encoder_driver.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;diff_controller.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;mpu6050.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 串口波特率</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAUDRATE     57600 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PID轮询速率 30次每秒</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PID_RATE     30     <span class="comment">// Hz</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> PID_INTERVAL = <span class="number">1000</span> / PID_RATE;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> nextPID = PID_INTERVAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 电机命令执行时间2s</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AUTO_STOP_INTERVAL 2000</span></span><br><span class="line"><span class="keyword">long</span> lastMotorCommand = AUTO_STOP_INTERVAL;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义电机PWM控制范围</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_PWM        4095</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Variable initialization */</span></span><br><span class="line"><span class="keyword">int</span> arg = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> chr;</span><br><span class="line"><span class="keyword">char</span> cmd;</span><br><span class="line"><span class="keyword">char</span> argv1[<span class="number">32</span>];</span><br><span class="line"><span class="keyword">char</span> argv2[<span class="number">32</span>];</span><br><span class="line"><span class="keyword">long</span> arg1;</span><br><span class="line"><span class="keyword">long</span> arg2;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重置命令</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">resetCommand</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cmd = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="built_in">memset</span>(argv1, <span class="number">0</span>, <span class="keyword">sizeof</span>(argv1));</span><br><span class="line">  <span class="built_in">memset</span>(argv2, <span class="number">0</span>, <span class="keyword">sizeof</span>(argv2));</span><br><span class="line">  arg1 = <span class="number">0</span>;</span><br><span class="line">  arg2 = <span class="number">0</span>;</span><br><span class="line">  arg = <span class="number">0</span>;</span><br><span class="line">  index = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行命令</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">runCommand</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">char</span> *p = argv1;</span><br><span class="line">  <span class="keyword">char</span> *str;</span><br><span class="line">  <span class="keyword">int</span> pid_args[<span class="number">8</span>];</span><br><span class="line">  arg1 = atoi(argv1);</span><br><span class="line">  arg2 = atoi(argv2);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (cmd) &#123;</span><br><span class="line">    <span class="keyword">case</span> GET_BAUDRATE: </span><br><span class="line">      Serial.println(BAUDRATE);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> READ_PIDIN:</span><br><span class="line">      Serial.print(readPidIn(LEFT));</span><br><span class="line">      Serial.print(<span class="string">&quot; &quot;</span>);</span><br><span class="line">      Serial.println(readPidIn(RIGHT));</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> READ_PIDOUT:</span><br><span class="line">      Serial.print(readPidOut(LEFT));</span><br><span class="line">      Serial.print(<span class="string">&quot; &quot;</span>);</span><br><span class="line">      Serial.println(readPidOut(RIGHT));</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> PIN_MODE:</span><br><span class="line">      <span class="keyword">if</span> (arg2 == <span class="number">0</span>) pinMode(arg1, INPUT);</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (arg2 == <span class="number">1</span>) pinMode(arg1, OUTPUT);</span><br><span class="line">      Serial.println(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>; </span><br><span class="line">    <span class="keyword">case</span> READ_ENCODERS:</span><br><span class="line">      Serial.print(readEncoder(LEFT));</span><br><span class="line">      Serial.print(<span class="string">&quot; &quot;</span>);</span><br><span class="line">      Serial.println(readEncoder(RIGHT));</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> READ_MPU6050:</span><br><span class="line">      send_imudata();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> RESET_ENCODERS:</span><br><span class="line">      resetEncoders();</span><br><span class="line">      resetPID();</span><br><span class="line">      Serial.println(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> MOTOR_SPEEDS:</span><br><span class="line">      lastMotorCommand = millis();</span><br><span class="line">      <span class="keyword">if</span> (arg1 == <span class="number">0</span> &amp;&amp; arg2 == <span class="number">0</span>) &#123;</span><br><span class="line">        setMotorSpeeds(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        moving = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> moving = <span class="number">1</span>;</span><br><span class="line">      leftPID.TargetTicksPerFrame = arg1;</span><br><span class="line">      rightPID.TargetTicksPerFrame = arg2;</span><br><span class="line">      Serial.println(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> UPDATE_PID:</span><br><span class="line">      <span class="keyword">while</span> ((str = strtok_r(p, <span class="string">&quot;:&quot;</span>, &amp;p)) != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">        pid_args[i] = atoi(str);</span><br><span class="line">        i++;</span><br><span class="line">      &#125;</span><br><span class="line">      left_Kp = pid_args[<span class="number">0</span>];</span><br><span class="line">      left_Kd = pid_args[<span class="number">1</span>];</span><br><span class="line">      left_Ki = pid_args[<span class="number">2</span>];</span><br><span class="line">      left_Ko = pid_args[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">      right_Kp = pid_args[<span class="number">4</span>];</span><br><span class="line">      right_Kd = pid_args[<span class="number">5</span>];</span><br><span class="line">      right_Ki = pid_args[<span class="number">6</span>];</span><br><span class="line">      right_Ko = pid_args[<span class="number">7</span>];</span><br><span class="line">      Serial.println(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> ANALOG_READ:</span><br><span class="line">      Serial.println(analogRead(arg1));</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> DIGITAL_READ:</span><br><span class="line">      Serial.println(digitalRead(arg1));</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> ANALOG_WRITE:</span><br><span class="line">      analogWrite(arg1, arg2);</span><br><span class="line">      Serial.println(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> DIGITAL_WRITE:</span><br><span class="line">      <span class="keyword">if</span> (arg2 == <span class="number">0</span>) digitalWrite(arg1, LOW);</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (arg2 == <span class="number">1</span>) digitalWrite(arg1, HIGH);</span><br><span class="line">      Serial.println(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      Serial.println(<span class="string">&quot;Invalid Command&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Serial.begin(BAUDRATE);</span><br><span class="line">  initEncoders();</span><br><span class="line">  initMotorController();</span><br><span class="line">  initmpu6050();</span><br><span class="line">  resetPID();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 循环执行</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (Serial.available() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    chr = Serial.read();</span><br><span class="line">    <span class="keyword">if</span> (chr == <span class="number">13</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arg == <span class="number">1</span>) argv1[index] = <span class="literal">NULL</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (arg == <span class="number">2</span>) argv2[index] = <span class="literal">NULL</span>;</span><br><span class="line">      runCommand();</span><br><span class="line">      resetCommand();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (chr == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arg == <span class="number">0</span>) arg = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (arg == <span class="number">1</span>)  &#123;</span><br><span class="line">        argv1[index] = <span class="literal">NULL</span>;</span><br><span class="line">        arg = <span class="number">2</span>;</span><br><span class="line">        index = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (arg == <span class="number">0</span>) &#123;</span><br><span class="line">        cmd = chr;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (arg == <span class="number">1</span>) &#123;</span><br><span class="line">        argv1[index] = chr;</span><br><span class="line">        index++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (arg == <span class="number">2</span>) &#123;</span><br><span class="line">        argv2[index] = chr;</span><br><span class="line">        index++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (millis() &gt; nextPID) &#123;</span><br><span class="line">    updatePID();</span><br><span class="line">    nextPID += PID_INTERVAL;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ((millis() - lastMotorCommand) &gt; AUTO_STOP_INTERVAL) &#123;</span><br><span class="line">    setMotorSpeeds(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    moving = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><figcaption><span>commands.h</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GET_BAUDRATE   <span class="meta-string">&#x27;b&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> READ_ENCODERS  <span class="meta-string">&#x27;e&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOTOR_SPEEDS   <span class="meta-string">&#x27;m&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RESET_ENCODERS <span class="meta-string">&#x27;r&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UPDATE_PID     <span class="meta-string">&#x27;u&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> READ_PIDOUT    <span class="meta-string">&#x27;f&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> READ_PIDIN     <span class="meta-string">&#x27;i&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> READ_MPU6050   <span class="meta-string">&#x27;z&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PIN_MODE       <span class="meta-string">&#x27;c&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIGITAL_READ   <span class="meta-string">&#x27;d&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ANALOG_READ    <span class="meta-string">&#x27;a&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIGITAL_WRITE  <span class="meta-string">&#x27;w&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ANALOG_WRITE   <span class="meta-string">&#x27;x&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LEFT            0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RIGHT           1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FORWARDS true</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BACKWARDS false</span></span><br></pre></td></tr></table></figure><h2 id="PID代码修改（diff-controller）"><a href="#PID代码修改（diff-controller）" class="headerlink" title="PID代码修改（diff_controller）"></a>PID代码修改（diff_controller）</h2><p>需要指出的是，它的左右轮的PID用的是同一套Kp,Kd,Ki,Ko， 如果你的两个电机特性差异比较大，就要对这块做下优化。(已添加PID调速部分)</p><figure class="highlight c"><figcaption><span>diff_controller.ino</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义电机PWM控制范围</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_PWM        4095</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* PID setpoint info For a Motor */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="keyword">double</span> TargetTicksPerFrame;    <span class="comment">// target speed in ticks per frame</span></span><br><span class="line">  <span class="keyword">long</span> Encoder;                  <span class="comment">// encoder count</span></span><br><span class="line">  <span class="keyword">long</span> PrevEnc;                  <span class="comment">// last encoder count</span></span><br><span class="line">  <span class="keyword">int</span> PrevInput;                <span class="comment">// last input</span></span><br><span class="line">  <span class="keyword">int</span> ITerm;                    <span class="comment">//integrated term</span></span><br><span class="line">  <span class="keyword">long</span> output;                    <span class="comment">// last motor setting</span></span><br><span class="line">&#125;</span><br><span class="line">SetPointInfo;</span><br><span class="line"></span><br><span class="line">SetPointInfo leftPID, rightPID;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* PID Parameters */</span></span><br><span class="line"><span class="keyword">int</span> Kp = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> Kd = <span class="number">12</span>;</span><br><span class="line"><span class="keyword">int</span> Ki = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> Ko = <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> left_Kp=Kp;</span><br><span class="line"><span class="keyword">int</span> left_Kd=Kd;</span><br><span class="line"><span class="keyword">int</span> left_Ki=Ki;</span><br><span class="line"><span class="keyword">int</span> left_Ko=Ko;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> right_Kp=Kp;</span><br><span class="line"><span class="keyword">int</span> right_Kd=Kd;</span><br><span class="line"><span class="keyword">int</span> right_Ki=Ki;</span><br><span class="line"><span class="keyword">int</span> right_Ko=Ko;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> moving = <span class="number">0</span>; <span class="comment">// is the base in motion?</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">resetPID</span><span class="params">()</span></span>&#123;</span><br><span class="line"> leftPID.TargetTicksPerFrame = <span class="number">0.0</span>;</span><br><span class="line"> leftPID.Encoder = readEncoder(LEFT);</span><br><span class="line"> leftPID.PrevEnc = leftPID.Encoder;</span><br><span class="line"> leftPID.output = <span class="number">0</span>;</span><br><span class="line"> leftPID.PrevInput = <span class="number">0</span>;</span><br><span class="line"> leftPID.ITerm = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"> rightPID.TargetTicksPerFrame = <span class="number">0.0</span>;</span><br><span class="line"> rightPID.Encoder = readEncoder(RIGHT);</span><br><span class="line"> rightPID.PrevEnc = rightPID.Encoder;</span><br><span class="line"> rightPID.output = <span class="number">0</span>;</span><br><span class="line"> rightPID.PrevInput = <span class="number">0</span>;</span><br><span class="line"> rightPID.ITerm = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//* PID routine to compute the next motor commands */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dorightPID</span><span class="params">(SetPointInfo * p)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> Perror;</span><br><span class="line">  <span class="keyword">long</span> output;</span><br><span class="line">  <span class="keyword">int</span> input;</span><br><span class="line"></span><br><span class="line">  input = p-&gt;Encoder - p-&gt;PrevEnc;</span><br><span class="line">  Perror = p-&gt;TargetTicksPerFrame - input;</span><br><span class="line">  output = (right_Kp * Perror - right_Kd * (input - p-&gt;PrevInput) + p-&gt;ITerm) / right_Ko;</span><br><span class="line">  p-&gt;PrevEnc = p-&gt;Encoder;</span><br><span class="line">  </span><br><span class="line">  output += p-&gt;output;</span><br><span class="line">  <span class="keyword">if</span> (output &gt;= MAX_PWM)</span><br><span class="line">    output = MAX_PWM;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (output &lt;= -MAX_PWM)</span><br><span class="line">    output = -MAX_PWM;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    p-&gt;ITerm += Ki * Perror;</span><br><span class="line"></span><br><span class="line">  p-&gt;output = output;</span><br><span class="line">  p-&gt;PrevInput = input;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* PID routine to compute the next motor commands */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doleftPID</span><span class="params">(SetPointInfo * p)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> Perror;</span><br><span class="line">  <span class="keyword">long</span> output;</span><br><span class="line">  <span class="keyword">int</span> input;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Perror = p-&gt;TargetTicksPerFrame - (p-&gt;Encoder - p-&gt;PrevEnc);</span></span><br><span class="line">  input = p-&gt;Encoder - p-&gt;PrevEnc;</span><br><span class="line">  Perror =p-&gt;TargetTicksPerFrame + input;</span><br><span class="line"></span><br><span class="line">  output = (left_Kp * Perror - left_Kd * (input - p-&gt;PrevInput) + p-&gt;ITerm) / left_Ko;</span><br><span class="line">  p-&gt;PrevEnc = p-&gt;Encoder;</span><br><span class="line"></span><br><span class="line">  output += p-&gt;output;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (output &gt;= MAX_PWM)</span><br><span class="line">    output = MAX_PWM;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (output &lt;= -MAX_PWM)</span><br><span class="line">    output = -MAX_PWM;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    p-&gt;ITerm += Ki * Perror;</span><br><span class="line"></span><br><span class="line">  p-&gt;output = output;</span><br><span class="line">  p-&gt;PrevInput = input;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updatePID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* Read the encoders */</span></span><br><span class="line">  leftPID.Encoder =readEncoder(LEFT);</span><br><span class="line">  rightPID.Encoder = readEncoder(RIGHT);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* If we&#x27;re not moving there is nothing more to do */</span></span><br><span class="line">  <span class="keyword">if</span> (!moving)&#123;</span><br><span class="line">    <span class="keyword">if</span> (leftPID.PrevInput != <span class="number">0</span> || rightPID.PrevInput != <span class="number">0</span>) resetPID();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Compute PID update for each motor */</span></span><br><span class="line">  dorightPID(&amp;rightPID);<span class="comment">//执行右马达PID</span></span><br><span class="line">  doleftPID(&amp;leftPID);<span class="comment">//执行左马达PID</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Set the motor speeds accordingly */</span></span><br><span class="line">  setMotorSpeeds(leftPID.output, rightPID.output);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">readPidIn</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> pidin=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (i == LEFT)&#123;</span><br><span class="line">    pidin = leftPID.PrevInput;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    pidin = rightPID.PrevInput;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> pidin;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">readPidOut</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> pidout=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (i == LEFT)&#123;</span><br><span class="line">    pidout = leftPID.output;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    pidout = rightPID.output;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> pidout;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="串口调试"><a href="#串口调试" class="headerlink" title="串口调试"></a>串口调试</h2><p>&emsp;&emsp;将修改好的代码烧录进Arduino开发板中。打开串口，设置串口波特率为 57600。</p><pre><code>查看编码计数，发送命令 e清除编码计数，发送命令 r驱动电机转动，发送命令 m 200 200 （默认设置轮子仅仅移动2秒，你可以通过修改源码中的AUTO_STOP_INTERVAL改变这个值）其他命令可参考 commands.h 文件</code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://www.ncnynl.com/archives/201612/1203.html">搭建ROS小车底盘</a></li><li><a href="https://www.ncnynl.com/category/ros-diego/">ROS机器人Diego制作</a></li><li><a href="https://blog.csdn.net/github_30605157/article/details/51344150">ros_arduino_bridge功能包集的使用</a></li><li><a href="https://blog.csdn.net/github_30605157/article/details/51621965">ros_arduino_bridge功能包集的使用错误及解决方法总结</a></li><li><a href="https://mp.weixin.qq.com/s?src=3&timestamp=1569247988&ver=1&signature=mUYir5xCcV45GICjXRzD94x1hP2UOmQzFJtGoosiCFqUfXWggfKHIrJLLnHQA0lJhnYRz7BhZHBz8b65zp1yfqXCoqMOqfCOsLdaG2P44SZ8IKAkKVxP1YlwcS*GPAfBDwi6wn06bNS6NtGSxG-NKy3TSwPC44e-4P05warviUU=">ros_arduino_bridge开源软件包简介</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS小车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 机器人搭建与调试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>虚拟机VMware 15.5安装Ubuntu</title>
      <link href="/2019/11/21/%E8%99%9A%E6%8B%9F%E6%9C%BAVMware%2015.5%E5%AE%89%E8%A3%85Ubuntu/"/>
      <url>/2019/11/21/%E8%99%9A%E6%8B%9F%E6%9C%BAVMware%2015.5%E5%AE%89%E8%A3%85Ubuntu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;虚拟机VMware 15.5安装Ubuntu很简单，按照操作提示一步步来即可。<br>本文和主要叙述Ubuntu配置源和软件安装。</p><p><a href="https://my.vmware.com/cn/web/vmware/info/slug/desktop_end_user_computing/vmware_workstation_pro/15_0">VMware Workstation 15.5.1 Pro </a><br><a href="http://releases.ubuntu.com/16.04/">Ubuntu 16.04.6 LTS (Xenial Xerus)</a><br><a href="http://releases.ubuntu.com/bionic/">Ubuntu 18.04.3 LTS (Bionic Beaver)</a></p><a id="more"></a><h2 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h2><h3 id="安装虚拟机VMware"><a href="#安装虚拟机VMware" class="headerlink" title="安装虚拟机VMware"></a>安装虚拟机VMware</h3><p>可去<a href="https://www.vmware.com/cn.html">VMware官网</a>下载 <a href="https://my.vmware.com/cn/web/vmware/info/slug/desktop_end_user_computing/vmware_workstation_pro/15_0">VMware Workstation Pro 15 </a></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/VMware%2015.5%E5%AE%89%E8%A3%85Ubuntu/VMware%E4%B8%8B%E8%BD%BD.png" width="600" hegiht="200">（图）VMware Workstation Pro 15</center><p><strong>激活许可证：</strong></p><pre><code>UY758-0RXEQ-M81WP-8ZM7Z-Y3HDAVF750-4MX5Q-488DQ-9WZE9-ZY2D6UU54R-FVD91-488PP-7NNGC-ZFAX6YC74H-FGF92-081VZ-R5QNG-P6RY4YC34H-6WWDK-085MQ-JYPNX-NZRA2</code></pre><h3 id="虚拟机安装-Ubuntu-系统"><a href="#虚拟机安装-Ubuntu-系统" class="headerlink" title="虚拟机安装 Ubuntu 系统"></a>虚拟机安装 Ubuntu 系统</h3><p><strong><a href="http://releases.ubuntu.com/">Ubuntu </a>系统下载：</strong></p><ul><li><a href="http://releases.ubuntu.com/16.04/">Ubuntu 16.04.6 LTS (Xenial Xerus)</a></li><li><a href="http://releases.ubuntu.com/bionic/">Ubuntu 18.04.3 LTS (Bionic Beaver)</a></li></ul><p><strong>安装步骤注意事项：</strong><br>（1） 密码尽可能简单，因为后期使用过程中要输入密码次数非常多。<br>（2） 磁盘大小尽可能大，因为到后期30G完全不够用。</p><p>安装成功后，可看到如下界面：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/VMware%2015.5%E5%AE%89%E8%A3%85Ubuntu/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%95%8C%E9%9D%A2.PNG" width="600" hegiht="600">（图）Ubuntu 16.04</center><p>安装成功后，还需要进行以下配置：</p><ul><li>打开 <code>编辑虚拟机设置</code></li><li>修改内存大小和处理器数量</li><li>USB控制器选择 <code>USB3.0</code></li></ul><h2 id="修改语言"><a href="#修改语言" class="headerlink" title="修改语言"></a>修改语言</h2><p>Ubuntu默认的为英语，可改为中文便于操作。</p><p><strong>步骤：</strong></p><p>（1）打开 <code>系统设置</code> → <code>Language Support</code>;<br>（2）选择 <code>Install /Remove Languages</code> → <code>Chinese (simplified)</code>;</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/VMware%2015.5%E5%AE%89%E8%A3%85Ubuntu/%E4%BF%AE%E6%94%B9%E8%AF%AD%E8%A8%801.png" width="600" hegiht="400">（图）选择汉语</center><p>（3）将 <code>汉语（中国</code> 拖拽到最顶层，选择 <code>Apply System-Wide</code></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/VMware%2015.5%E5%AE%89%E8%A3%85Ubuntu/%E4%BF%AE%E6%94%B9%E8%AF%AD%E8%A8%802.png" width="300" hegiht="400">（图）将汉语应用整个系统</center><p>（4）点击桌面右上角设置，注销并重新登陆即可。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/VMware%2015.5%E5%AE%89%E8%A3%85Ubuntu/%E6%B3%A8%E9%94%80.PNG" width="200" hegiht="400">（图）注销</center><h2 id="配置镜像源"><a href="#配置镜像源" class="headerlink" title="配置镜像源"></a>配置镜像源</h2><p>Ubuntu使用默认的源下载速度不够快，可选择国内源。</p><p><strong>步骤：</strong><br>（1）打开 <code>系统设置</code> → <code>软件和更新</code>。<br>（2）在 <code>下载自</code> 中选择 <code>其他站点</code> ，然后在 <code>china</code> 的条目下选择以下一种国内源。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/VMware%2015.5%E5%AE%89%E8%A3%85Ubuntu/ubuntu-%E8%BD%AF%E4%BB%B6%E6%BA%90%E8%AE%BE%E7%BD%AE%20%E4%B8%AD%E7%A7%91%E5%A4%A7.png" width="600" hegiht="400">（图）配置镜像源</center><ul><li><a href="https://opsx.alibaba.com/mirror">阿里云镜像源</a>：mirrors.aliyun.com</li><li><a href="http://mirrors.ustc.edu.cn/">中科大镜像</a>：mirrors.ustc.edu.cn</li><li><a href="https://mirrors.tuna.tsinghua.edu.cn/">清华大学镜像</a>：mirrors.tuna.tsinghua.edu.cn</li></ul><p>其他方法可参考国内源网站的Ubuntu镜像帮助文件。</p><h2 id="安装搜狗输入法"><a href="#安装搜狗输入法" class="headerlink" title="安装搜狗输入法"></a>安装搜狗输入法</h2><p>搜狗输入法liunx版：<a href="https://pinyin.sogou.com/linux/?r=pinyin">https://pinyin.sogou.com/linux/?r=pinyin</a></p><p><strong>步骤：</strong></p><p>（1）下载并安装<br>以下载的安装包 <code>sogoupinyin_2.3.1.0112_amd64.deb</code> 为例，安装方法有两种：<br><strong>方法一：</strong> 只需双击下载的 deb 软件包，即可直接安装搜狗输入法。<br><strong>方法二：</strong> 打开终端，采用命令安装</p><pre><code>$ cd Download$ sudo dpkg -i sogoupinyin_2.3.1.0112_amd64.deb</code></pre><p>（2）设置键盘输入法系统<br>安装后在<code>系统设置</code> → <code>语言支持</code>里面，设置 <code>键盘输入法系统</code> 为 <code>fcitx</code></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/VMware%2015.5%E5%AE%89%E8%A3%85Ubuntu/%E8%BE%93%E5%85%A5%E6%B3%95fcitx.PNG" width="200" hegiht="400">（图）设置键盘输入法系统</center><p>（3）点击桌面右上角设置，注销并重新登陆即可。</p><h2 id="安装QQ、微信"><a href="#安装QQ、微信" class="headerlink" title="安装QQ、微信"></a>安装QQ、微信</h2><p>&emsp;&emsp;Ubuntu系统安装QQ、微信稍嫌麻烦，QQ今年发布了<a href="https://im.qq.com/linuxqq/index.html">QQ Linux版 2.0.0 Beta</a>，可以直接安装；微信还没有适配Liunx版本，好在还有<a href="https://wx.qq.com/">网页版微信</a>可以用。此外也可以在deepin wine环境下安装QQ、微信等软件。</p><h3 id="配置deepin-wine环境"><a href="#配置deepin-wine环境" class="headerlink" title="配置deepin wine环境"></a>配置deepin wine环境</h3><ul><li>github：<a href="https://github.com/wszqkzqk/deepin-wine-ubuntu">https://github.com/wszqkzqk/deepin-wine-ubuntu</a></li><li>gitee：<a href="https://gitee.com/wszqkzqk/deepin-wine-for-ubuntu">https://gitee.com/wszqkzqk/deepin-wine-for-ubuntu</a></li></ul><p>（1） 下载 deepin wine 源码</p><pre><code># 在中国推荐用下面的地址，速度更快：$ git clone https://gitee.com/wszqkzqk/deepin-wine-for-ubuntu.git# 切换到解压文件目录，在终端中运行：$ ./install.sh</code></pre><div class="note primary">            <p>也可以<a href="https://github.com/wszqkzqk/deepin-wine-ubuntu/archive/master.zip">直接下载</a>安装，或选择下载releases：<a href="https://github.com/wszqkzqk/deepin-wine-ubuntu/releases">Github releases</a>或者 <a href="https://gitee.com/wszqkzqk/deepin-wine-for-ubuntu/releases">Gitee releases</a>。</p>          </div><p>（2） 选择安装包</p><div class="note info">            <p>直接安装deb包或者命令执行：<code>$ sudo dpkg -i XXX.deb</code></p>          </div><ul><li><a href="https://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.im/">QQ</a></li><li><a href="https://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.wechat/">微信</a></li><li><a href="https://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.office/">TIM</a></li><li><a href="https://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.baidu.pan/">百度网盘</a></li></ul><p>其它软件见 <a href="http://mirrors.aliyun.com/deepin/pool/non-free/d/">http://mirrors.aliyun.com/deepin/pool/non-free/d/</a></p><h3 id="安装QQ"><a href="#安装QQ" class="headerlink" title="安装QQ"></a>安装QQ</h3><p>（1）以安装包 <code>deepin.com.qq.im_8.9.19983deepin23_i386.deb</code>  为例。<br>QQ链接：<a href="http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.im/">http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.im/</a></p><p>（2）直接安装deb包或者命令执行：</p><pre><code>$ sudo dpkg -i deepin.com.qq.im_8.9.19983deepin23_i386.deb</code></pre><h3 id="安装微信"><a href="#安装微信" class="headerlink" title="安装微信"></a>安装微信</h3><p>（1）以安装包 <code>deepin.com.wechat_2.6.8.65deepin0_i386.deb  </code>  为例。<br>微信链接：<a href="http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.wechat/">http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.wechat/</a></p><p>（2）直接安装deb包或者命令执行：</p><pre><code>$ sudo dpkg -i deepin.com.wechat_2.6.8.65deepin0_i386.deb  </code></pre>]]></content>
      
      
      <categories>
          
          <category> Ubuntu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器人搭建与调试1：总体框架介绍</title>
      <link href="/2019/11/19/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%951%EF%BC%9A%E6%80%BB%E4%BD%93%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/"/>
      <url>/2019/11/19/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%B0%83%E8%AF%951%EF%BC%9A%E6%80%BB%E4%BD%93%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;本ROS小车实现自主搬运功能，主要可分为以下几个大步骤：</p><ul><li><strong>机器人搭建与底盘调试</strong></li><li><strong>机器人建模与仿真</strong></li><li><strong>同时定位和地图构建</strong></li><li><strong>路径规划与自主避障</strong></li><li><strong>自主搬运动作规划</strong></li></ul><p>&emsp;&emsp;总体框架如下：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%A1%AC%E4%BB%B6%E6%90%AD%E5%BB%BA/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%80%BB%E4%BD%93%E6%A1%86%E6%9E%B6.PNG" width="600" hegiht="400" >（图）搬运机器人总体框架 </center><a id="more"></a><h2 id="搬运机器人模块选型与搭建"><a href="#搬运机器人模块选型与搭建" class="headerlink" title="搬运机器人模块选型与搭建"></a>搬运机器人模块选型与搭建</h2><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">机器人版本改进</a></li><li class="tab"><a href="#tab标签列表-2">机器人模块选型</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%A1%AC%E4%BB%B6%E6%90%AD%E5%BB%BA/%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%89%88%E6%9C%AC%E6%94%B9%E8%BF%9B.PNG" width="600" hegiht="400" ></center><p>&emsp;&emsp;目前ROS搬运小车经历三个版本。在硬件上，下位机方面主要选择<code>arduino mega 2560</code>作为控制板，驱动电机和舵机，完成编码计数的上传。上位机方面基于机器人操作系统 ROS，以“ROS 主机（PC 电脑）+ROS 从机(树莓派 3B)”配合 Arduino mega 开发板作为控制系统，通过电源模块等驱动系统来驱动编码电机、舵机手爪等部件。外部传感器采用惯性测量单元 IMU、USB 摄像头、激光雷达提高机器人定位精度、识别二维码目标点位姿以及自主搬运功能的实现。其中搬运机器人底盘是关键，如果机器人底盘不满足实验要求，后续任务将无法进行。</p><p>&emsp;&emsp;数据通信方面，传感器模块和<code>arduino mega 2560</code>开发板与ROS从机（<code>树莓派3B</code>）通过USB口串口通信；ROS从机（<code>树莓派3B</code>）与ROS主机（<code>PC电脑</code>）之间以局域网不同IP地址通过SSH连接相互通信。</p></div><div class="tab-pane" id="tab标签列表-2"><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%A1%AC%E4%BB%B6%E6%90%AD%E5%BB%BA/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%A8%A1%E5%9D%97%E9%80%89%E5%9E%8B.png" width="600" hegiht="400" ></center><p><strong>备注</strong></p><p>（1）底层控制可选择<code>STM32开发板</code>或者<code>Arduino开发板</code>。<br>（2）ROS主机可选择<code>虚拟机VMware 15.5</code>安装<code>Ubuntu 系统</code>。<br>（3）ROS从机可选择<code>树莓派</code>或者<code>工控机</code>。<br>&emsp;&emsp;推荐<code>树莓派</code>，因为<code>树莓派</code>是一款微型电脑，搭配wifi模块和4个USB口，性能基本满足ROS一般任务要求，此外计算量大的部分可以放在ROS主机上。<br>（4）SLAM构建地图可以选择激光SLAM或者视觉SLAM。<br>&emsp;&emsp;激光SLAM 可选择 <code>思岚 RPLIDAR</code> 激光雷达传感器；<br>&emsp;&emsp;视觉SLAM 可选择 <code>kinect 深度相机</code>。<br>（5）本ROS小车电机驱动板（<code>6WD扩展板</code>）有些小瑕疵，非I/O直接驱动，且电机接口较小。可替换选择<code>PIKIROBOT ROS电机驱动板</code>，有STM32和Arduino等多种型号。<br>（6）底板可自己画好图纸定制亚克力板。</p></div></div></div><h2 id="实现搬运功能所需步骤"><a href="#实现搬运功能所需步骤" class="headerlink" title="实现搬运功能所需步骤"></a>实现搬运功能所需步骤</h2><h3 id="机器人底盘运动控制"><a href="#机器人底盘运动控制" class="headerlink" title="机器人底盘运动控制"></a>机器人底盘运动控制</h3><ul><li>电机、舵机驱动测试；</li><li>机器人底盘PID运动控制，确保机器人走直线不偏斜；</li><li>速度（线速度、角速度）校准实验，确保机器人在真实环境前进距离和航迹推算距离保持一致。</li><li>里程计信息融合（功能包 /robot_pose_ekf），提高机器人定位和航迹推算精度。</li></ul><h3 id="机器人建模与仿真"><a href="#机器人建模与仿真" class="headerlink" title="机器人建模与仿真"></a>机器人建模与仿真</h3><ul><li>TF坐标树的维护</li><li>建立urdf模型、xacro模型、SolidWorks模型</li><li>ArbotiX + Rviz 控制机器人可视化行走</li><li>Gazebo 模拟仿真。（可参考 turtlebot3 功能包）</li></ul><h3 id="同时定位和地图构建"><a href="#同时定位和地图构建" class="headerlink" title="同时定位和地图构建"></a>同时定位和地图构建</h3><ul><li>激光SLAM算法功能包 /hector 使用与理论分析 </li><li>激光SLAM算法功能包 /gmapping 使用与理论分析</li><li>激光SLAM算法功能包 /karto 使用与理论分析</li><li>激光SLAM算法功能包 /cartographer 使用与理论分析</li></ul><h3 id="自主导航"><a href="#自主导航" class="headerlink" title="自主导航"></a>自主导航</h3><ul><li>理解 /navigation功能包（机器人地图定位/amcl、路径规划/move_base）</li><li>全局路径规划器（ Dijkstra 算法、A*算法等插件使用）</li><li>本地路径规划（dwa方法、teb方法等插件使用）</li></ul><h3 id="搬运动作规划"><a href="#搬运动作规划" class="headerlink" title="搬运动作规划"></a>搬运动作规划</h3><ul><li>摄像头驱动与畸变校准</li><li>二维码识别</li><li>搬运动作规划</li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS小车 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS小车 </tag>
            
            <tag> 机器人搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习7：理解动作中Server与Client(Python)</title>
      <link href="/2019/04/06/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A07%EF%BC%9A%E7%90%86%E8%A7%A3%E5%8A%A8%E4%BD%9C%E4%B8%ADServer%E4%B8%8EClient(Python)/"/>
      <url>/2019/04/06/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A07%EF%BC%9A%E7%90%86%E8%A7%A3%E5%8A%A8%E4%BD%9C%E4%B8%ADServer%E4%B8%8EClient(Python)/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;<a href="http://wiki.ros.org/actionlib">动作</a>（Action）是ROS中一种同步通信模式，与服务非常相似，服务具有与请求和响应分别对应的目标（goal）和结果（result），除此之外动作中还多了反馈（feedback）。与服务不同，动作通常用于指导复杂的机器人任务，例如发送一个目标值之后，还可以在任意时刻发送取消目标的命令。ROS中已经包含<code>actionlib</code>功能包，用于实现动作通信机制。</p><ul><li>客户端（Client)：用于请求发布任务目标（goal）或取消任务（cancel）。</li><li>服务器（Server）：用于通知客户端当前状态（status）、周期性反馈任务运行进度（feedback）以及发送任务执行结果（result）。结果只发送一次。</li><li>关系：Client-Server 多对一</li></ul><p>&emsp;&emsp;例如，当客户端将家庭服务器设置为服务器时，服务器会时时地通知客户端洗碗、洗衣和清洁等进度，最后将结果值发送给客户端。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/%E5%8A%A8%E4%BD%9C.PNG" width="600" hegiht="600">（图）动作通信模式</center><p>&emsp;&emsp;消息传输方案本身与异步方式的话题（topic）相同。反馈在动作客户端（action client）和动作服务器（action server）之间执行异步双向消息通信，其中动作客户端设置动作目标（goal），而动作服务器根据目标执行指定的工作，并将动作反馈和动作结果发送给动作客户端。</p><a id="more"></a><h2 id="动作"><a href="#动作" class="headerlink" title="动作"></a>动作</h2><p>本例程放在<code>ros_learning</code>功能包<code>script</code>文件夹下，新建<code>ros_learning</code>功能包(如果已经创建，可以跳过)：</p><pre><code>$ cs$ catkin_create_pkg ros_learning std_msgs rospy roscpp$ cm</code></pre><h3 id="新建自定义动作"><a href="#新建自定义动作" class="headerlink" title="新建自定义动作"></a>新建自定义动作</h3><p>自定义动作消息数据格式一般为<code>action</code>文件，如此次需要创建<code>DoDishes.action</code>文件，一般放在功能包目录下<code>action</code>文件夹下。</p><p>路径：<code>catkin_ws/src/ros_learning/action/DoDishes.action</code></p><figure class="highlight python"><figcaption><span>DoDishes.action</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义目标</span></span><br><span class="line">uint32 dish_goal </span><br><span class="line">---</span><br><span class="line"><span class="comment"># 定义结果</span></span><br><span class="line">uint32 dish_result</span><br><span class="line">---</span><br><span class="line"><span class="comment"># 定义反馈消息</span></span><br><span class="line">uint32 dish_progress</span><br></pre></td></tr></table></figure><p>注：数据域中的内容，目标、结果和反馈消息数据格式之间需要使用<code>---</code>分割。</p><h3 id="修改package-xml和CMakeLists-txt"><a href="#修改package-xml和CMakeLists-txt" class="headerlink" title="修改package.xml和CMakeLists.txt"></a>修改package.xml和CMakeLists.txt</h3><ul><li>修改package.xml文件，添加以下内容</li></ul><figure class="highlight xml"><figcaption><span>package.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build_depend</span>&gt;</span>actionlib_msgs<span class="tag">&lt;/<span class="name">build_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build_depend</span>&gt;</span>actionlib<span class="tag">&lt;/<span class="name">build_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build_export_depend</span>&gt;</span>actionlib_msgs<span class="tag">&lt;/<span class="name">build_export_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build_export_depend</span>&gt;</span>actionlib<span class="tag">&lt;/<span class="name">build_export_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exec_depend</span>&gt;</span>actionlib_msgs<span class="tag">&lt;/<span class="name">exec_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exec_depend</span>&gt;</span>actionlib<span class="tag">&lt;/<span class="name">exec_depend</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>修改CMakeLists.txt文件，添加以下内容</li></ul><figure class="highlight python"><figcaption><span>CMakeLists.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">find_package(catkin REQUIRED COMPONENTS</span><br><span class="line">  roscpp</span><br><span class="line">  rospy</span><br><span class="line">  std_msgs</span><br><span class="line">  message_generation</span><br><span class="line">  genmsg</span><br><span class="line">  actionlib_msgs</span><br><span class="line">  actionlib</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Generate actions in the &#x27;action&#x27; folder</span></span><br><span class="line"> add_action_files(</span><br><span class="line">   FILES</span><br><span class="line">   DoDishes.action</span><br><span class="line"> )</span><br><span class="line"></span><br><span class="line"><span class="comment">## Generate added messages and services with any dependencies listed here</span></span><br><span class="line"> generate_messages(</span><br><span class="line">   DEPENDENCIES</span><br><span class="line">   std_msgs</span><br><span class="line">   actionlib_msgs</span><br><span class="line"> )</span><br><span class="line"></span><br><span class="line">catkin_package(</span><br><span class="line"><span class="comment">#  INCLUDE_DIRS include</span></span><br><span class="line"><span class="comment">#  LIBRARIES ros_learning</span></span><br><span class="line">  CATKIN_DEPENDS roscpp rospy std_msgs message_generation actionlib_msgs actionlib</span><br><span class="line"><span class="comment">#  DEPENDS system_lib</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="创建动作客户端（Action-Client"><a href="#创建动作客户端（Action-Client" class="headerlink" title="创建动作客户端（Action Client)"></a>创建动作客户端（Action Client)</h3><p>可参考 <a href="https://docs.ros.org/api/actionlib/html/classactionlib_1_1simple__action__client_1_1SimpleActionClient.html">Full API reference for the Python SimpleActionClient</a></p><p>路径：<code>catkin_ws/src/ros_learning/script/dodishes_client.py</code></p><figure class="highlight python"><figcaption><span>dodishes_client.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> roslib</span><br><span class="line">roslib.load_manifest(<span class="string">&#x27;ros_learning&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> actionlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ros_learning.msg <span class="keyword">import</span> DoDishesAction, DoDishesGoal, DoDishesFeedback, DoDishesResult</span><br><span class="line"></span><br><span class="line"><span class="comment">#激活动作回调</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">active</span>():</span></span><br><span class="line">    rospy.loginfo(<span class="string">&quot;开始洗盘子....&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#动作服务完成回调</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">done</span>(<span class="params">d,result</span>):</span></span><br><span class="line">    rospy.loginfo(<span class="string">&quot;已经洗完[%d]个盘子&quot;</span>%result.dish_result)</span><br><span class="line"></span><br><span class="line"><span class="comment">#中间过程回调</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">feedback</span>(<span class="params">msg</span>):</span></span><br><span class="line">    rospy.loginfo(<span class="string">&quot;当前进度[%d]&quot;</span>%msg.dish_progress)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">client</span>():</span></span><br><span class="line">    rospy.init_node(<span class="string">&#x27;do_dishes_client&#x27;</span>)     <span class="comment"># 初始化节点</span></span><br><span class="line">    action_client = actionlib.SimpleActionClient(<span class="string">&#x27;do_dishes&#x27;</span>, DoDishesAction)   <span class="comment"># 初始化动作客户端</span></span><br><span class="line"></span><br><span class="line">    rospy.loginfo(<span class="string">&quot;连接洗盘子服务器&quot;</span>) </span><br><span class="line">    action_client.wait_for_server()     <span class="comment"># 等待动作服务</span></span><br><span class="line">    rospy.loginfo(<span class="string">&quot;已连接，发送任务目标&quot;</span>) </span><br><span class="line"></span><br><span class="line">    goal = DoDishesGoal()   <span class="comment"># 创建一个动作的任务目标</span></span><br><span class="line">    goal.dish_goal= <span class="number">100</span>   <span class="comment">#　设置任务目标</span></span><br><span class="line">    rospy.loginfo(<span class="string">&quot;任务目标[%d].&quot;</span>%goal.dish_goal)   <span class="comment">#打印任务目标</span></span><br><span class="line"></span><br><span class="line">    action_client.send_goal(goal,done,active,feedback)  <span class="comment">#申请服务</span></span><br><span class="line">    rospy.spin() <span class="comment">#循环等待</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        client()</span><br><span class="line">    <span class="keyword">except</span> rospy.ROSInterruptException:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>创建客户端完成后，使用命令<code>sudo chmod +x XXX.py</code>为Python文件添加可执行权限：</p><pre><code>tao@ubuntu:~/catkin_ws/src/ros_learning/script$ sudo chmod +x dodishes_client.py</code></pre><h3 id="创建动作服务器（Action-Server"><a href="#创建动作服务器（Action-Server" class="headerlink" title="创建动作服务器（Action Server)"></a>创建动作服务器（Action Server)</h3><p>可参考 <a href="https://docs.ros.org/api/actionlib/html/classactionlib_1_1simple__action__server_1_1SimpleActionServer.html">Full API reference for the Python SimpleActionServer</a></p><p>路径：<code>catkin_ws/src/ros_learning/script/dodishes_server.py</code></p><figure class="highlight python"><figcaption><span>dodishes_server.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> roslib</span><br><span class="line">roslib.load_manifest(<span class="string">&#x27;ros_learning&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> actionlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ros_learning.msg <span class="keyword">import</span> DoDishesAction, DoDishesGoal, DoDishesFeedback, DoDishesResult</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execute</span>(<span class="params">goal</span>):</span></span><br><span class="line">  feedback = DoDishesFeedback()   <span class="comment"># 反馈进度</span></span><br><span class="line">  result = DoDishesResult()       <span class="comment"># 最终结果</span></span><br><span class="line">  rospy.loginfo(<span class="string">&quot;已收到任务目标[%d].&quot;</span>%goal.dish_goal)   <span class="comment">#打印任务目标</span></span><br><span class="line"></span><br><span class="line">  rate = rospy.Rate(<span class="number">10</span>)           <span class="comment"># 10hz 每秒10次</span></span><br><span class="line">  num_goal = goal.dish_goal    <span class="comment">#　任务目标</span></span><br><span class="line">  num = <span class="number">0</span>                         <span class="comment">#　临时变量</span></span><br><span class="line">  num_add = <span class="number">5</span>                     <span class="comment">#　增量</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    time.sleep(<span class="number">0.2</span>)     <span class="comment">#　模拟耗时</span></span><br><span class="line">    num += num_add      <span class="comment">#　模拟进度</span></span><br><span class="line">    feedback.dish_progress = num   <span class="comment">#更新反馈进度</span></span><br><span class="line">    <span class="keyword">if</span> num == num_goal:</span><br><span class="line">      result.dish_result = num   <span class="comment">#给最终结果赋值</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    action_server.publish_feedback(feedback)  <span class="comment">#反馈任务进度</span></span><br><span class="line"></span><br><span class="line">  rospy.loginfo(<span class="string">&quot;已经洗完[%d]个盘子&quot;</span>%result.dish_result) <span class="comment">#打印最终结果</span></span><br><span class="line">  action_server.set_succeeded(result)   <span class="comment">#反馈最终结果</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  rospy.init_node(<span class="string">&#x27;do_dishes_server&#x27;</span>)   <span class="comment"># 初始化节点</span></span><br><span class="line">  action_server=actionlib.SimpleActionServer(<span class="string">&quot;do_dishes&quot;</span>,DoDishesAction,execute,auto_start=<span class="literal">False</span>) <span class="comment"># 初始化动作服务,动作名DoDishesAction,回调函数execute</span></span><br><span class="line">  action_server.start()   <span class="comment">#启动动作服务</span></span><br><span class="line">  rospy.spin()    <span class="comment">#循环等待</span></span><br></pre></td></tr></table></figure><p>创建客户端完成后，使用命令<code>sudo chmod +x XXX.py</code>为Python文件添加可执行权限：</p><pre><code>tao@ubuntu:~/catkin_ws/src/ros_learning/script$ sudo chmod +x dodishes_server.py</code></pre><h2 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h2><ul><li>打开新终端，编译功能包，启动ROS：</li></ul><pre><code>$ cm$ roscore</code></pre><ul><li>打开新终端，运行动作服务器，可以看出服务在等待动作客户端请求：</li></ul><pre><code>$ rosrun ros_learning dodishes_server.py</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E5%8A%A8%E4%BD%9C/%E5%8A%A8%E4%BD%9C%E6%9C%8D%E5%8A%A1%E5%99%A8.PNG" width="600" hegiht="400">（图）动作服务器（Server)</center><ul><li>打开新终端，运行动作客户端，可以看出，当发出任务目标请求后，动作服务器周期反馈进度和任务结果：</li></ul><pre><code>$ rosrun ros_learning dodishes_client.py</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E5%8A%A8%E4%BD%9C/%E5%8A%A8%E4%BD%9C%E5%AE%A2%E6%88%B7%E7%AB%AF.PNG" width="600" hegiht="800">（图）动作客户端（Server)</center><ul><li>查看话题列表<code>rostopic list</code>和节点列表<code>rosnode list</code></li></ul><pre><code>tao@ubuntu:~$ rostopic list/do_dishes/cancel/do_dishes/feedback/do_dishes/goal/do_dishes/result/do_dishes/status/rosout/rosout_aggtao@ubuntu:~$ rosnode list/do_dishes_client/do_dishes_server/rosout</code></pre><ul><li>查看节点关系<code>rqt_graph</code></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E5%8A%A8%E4%BD%9C/%E5%8A%A8%E4%BD%9C%E8%8A%82%E7%82%B9%E5%85%B3%E7%B3%BB.PNG" width="600" hegiht="400">（图）动作节点关系（Server)</center><p>到此，已经简单了解一下动作的通信模式。</p>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习6：理解服务中Server与Client(Python)</title>
      <link href="/2019/04/05/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A06%EF%BC%9A%E7%90%86%E8%A7%A3%E6%9C%8D%E5%8A%A1%E4%B8%ADServer%E4%B8%8EClint(Python)/"/>
      <url>/2019/04/05/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A06%EF%BC%9A%E7%90%86%E8%A7%A3%E6%9C%8D%E5%8A%A1%E4%B8%ADServer%E4%B8%8EClint(Python)/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;<a href="http://wiki.ros.org/Services">服务</a>（Services）是ROS中一种同步通信模式，其中消息以请求/应答（Request/Reply）的方式传递。</p><ul><li>客户端（Client)：请求服务后等待响应。</li><li>服务器（Server）： 收到服务请求后执行指定的任务，并发送响应。</li><li>关系：Client-Server 多对一</li></ul><p>&emsp;&emsp;与话题不同，ROS中只允许有一个节点提供服务，但可以存在多个客户端。与话题不同，服务只连接一次，在执行请求和响应之后彼此断开连接。如果有必要，需要重新连接。</p><p>&emsp;&emsp;例如，当客户端向服务器请求当前时间时，服务器将确认时间并作出响应。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/%E6%9C%8D%E5%8A%A1.PNG" width="600" hegiht="400">（图）服务通信模式</center><p>&emsp;&emsp;该服务通常被用作请求机器人执行特定操作时使用的命令，或者用于根据特定条件需要产生事件的节点。由于它是一次性的通信方式，又因为它在网络上的负载很小，所以它也被用作代替话题的手段，因此是一种非常有用的通信手段。</p><a id="more"></a><h2 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h2><p>本例程放在<code>ros_learning</code>功能包<code>script</code>文件夹下，新建<code>ros_learning</code>功能包(如果已经创建，可以跳过)：</p><pre><code>$ cs$ catkin_create_pkg ros_learning std_msgs rospy roscpp$ cm</code></pre><h3 id="新建自定义服务"><a href="#新建自定义服务" class="headerlink" title="新建自定义服务"></a>新建自定义服务</h3><p>自定义服务消息数据格式一般为<code>srv</code>文件，如此次需要创建<code>AddTwoInts.srv</code>文件，一般放在功能包目录下<code>srv</code>文件夹下。</p><p>路径：<code>catkin_ws/src/ros_learning/srv/AddTwoInts.srv</code></p><figure class="highlight c"><figcaption><span>AddTwoInts.srv</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int64 a</span><br><span class="line">int64 b</span><br><span class="line">---</span><br><span class="line">int64 sum</span><br></pre></td></tr></table></figure><p>注：数据域中的内容，请求与应答数据格式之间需要使用<code>---</code>分割。</p><h3 id="修改package-xml和CMakeLists-txt"><a href="#修改package-xml和CMakeLists-txt" class="headerlink" title="修改package.xml和CMakeLists.txt"></a>修改package.xml和CMakeLists.txt</h3><ul><li>修改package.xml文件，添加以下内容</li></ul><figure class="highlight xml"><figcaption><span>package.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build_depend</span>&gt;</span>message_generation<span class="tag">&lt;/<span class="name">build_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build_export_depend</span>&gt;</span>message_generation<span class="tag">&lt;/<span class="name">build_export_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exec_depend</span>&gt;</span>message_runtime<span class="tag">&lt;/<span class="name">exec_depend</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>修改CMakeLists.txt文件，添加以下内容</li></ul><figure class="highlight python"><figcaption><span>CMakeLists.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Find catkin macros and libraries</span></span><br><span class="line"><span class="comment">## if COMPONENTS list like find_package(catkin REQUIRED COMPONENTS xyz)</span></span><br><span class="line"><span class="comment">## is used, also find other catkin packages</span></span><br><span class="line">find_package(catkin REQUIRED COMPONENTS</span><br><span class="line">  roscpp</span><br><span class="line">  rospy</span><br><span class="line">  std_msgs</span><br><span class="line">  message_generation</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Generate services in the &#x27;srv&#x27; folder</span></span><br><span class="line">add_service_files(</span><br><span class="line">   FILES</span><br><span class="line">   AddTwoInts.srv</span><br><span class="line"> )</span><br><span class="line"></span><br><span class="line"><span class="comment">## Generate added messages and services with any dependencies listed here</span></span><br><span class="line"> generate_messages(</span><br><span class="line">   DEPENDENCIES</span><br><span class="line">   std_msgs</span><br><span class="line"> )</span><br><span class="line"></span><br><span class="line">catkin_package(</span><br><span class="line"><span class="comment">#  INCLUDE_DIRS include</span></span><br><span class="line"><span class="comment">#  LIBRARIES ros_learning</span></span><br><span class="line">  CATKIN_DEPENDS roscpp rospy std_msgs message_generation</span><br><span class="line"><span class="comment">#  DEPENDS system_lib</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="创建客户端（Client"><a href="#创建客户端（Client" class="headerlink" title="创建客户端（Client)"></a>创建客户端（Client)</h3><p>路径：<code>catkin_ws/src/ros_learning/script/client.py</code></p><figure class="highlight python"><figcaption><span>client.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 客户端clint　主动发送请求数据　如：rosrun ros_learning client.py 4 5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> ros_learning.srv <span class="keyword">import</span> *  <span class="comment"># 自定义服务数据</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_two_ints_client</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="comment"># 客户端调用服务更简单，甚至可以不调用init_node()来初始化节点,直到服务名为add_two_ints的服务生效</span></span><br><span class="line">    rospy.wait_for_service(<span class="string">&#x27;add_two_ints&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        add_two_ints = rospy.ServiceProxy(<span class="string">&#x27;add_two_ints&#x27;</span>, AddTwoInts)   <span class="comment"># 创建实例来调用服务</span></span><br><span class="line">        resp1 = add_two_ints(x, y)    <span class="comment"># 因为我们已声明服务类型AddTwoInts，它生成AddTwoIntsRequest对象  </span></span><br><span class="line">        <span class="keyword">return</span> resp1.sum    <span class="comment">#返回值是一个AddTwoIntsResponse对象。</span></span><br><span class="line">    <span class="keyword">except</span> rospy.ServiceException, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;Service call failed: %s&quot;</span>%e</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">usage</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;%s [x y]&quot;</span>%sys.argv[<span class="number">0</span>]   <span class="comment"># 异常返回　如：/home/tao/catkin_ws/src/ros_learning/src/client.py [x y]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        x = int(sys.argv[<span class="number">1</span>])</span><br><span class="line">        y = int(sys.argv[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> usage()</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Requesting %s+%s&quot;</span>%(x, y)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;%s + %s = %s&quot;</span>%(x, y, add_two_ints_client(x, y))</span><br></pre></td></tr></table></figure><p>创建客户端完成后，使用命令<code>sudo chmod +x XXX.py</code>为Python文件添加可执行权限：</p><pre><code>tao@ubuntu:~/catkin_ws/src/ros_learning/script$ sudo chmod +x client.py</code></pre><h3 id="创建服务器（Server）"><a href="#创建服务器（Server）" class="headerlink" title="创建服务器（Server）"></a>创建服务器（Server）</h3><p>路径：<code>catkin_ws/src/ros_learning/script/server.py</code></p><figure class="highlight python"><figcaption><span>server.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ros_learning.srv <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有请求传递到handle_add_two_ints函数处理，并传递实例AddTwoIntsRequest和返回AddTwoIntsResponse实例。</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle_add_two_ints</span>(<span class="params">req</span>):</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Returning [%s + %s = %s]&quot;</span>%(req.a, req.b, (req.a + req.b))</span><br><span class="line">    <span class="keyword">return</span> AddTwoIntsResponse(req.a + req.b)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_two_ints_server</span>():</span></span><br><span class="line">    rospy.init_node(<span class="string">&#x27;add_two_ints_server&#x27;</span>)  <span class="comment"># 初始化节点</span></span><br><span class="line">    s = rospy.Service(<span class="string">&#x27;add_two_ints&#x27;</span>, AddTwoInts, handle_add_two_ints)  <span class="comment">#声明一个名为add_two_ints新服务，使用AddTwoInts服务类型。</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Ready to add two ints.&quot;</span></span><br><span class="line">    rospy.spin()    <span class="comment"># 类似订阅实例，rospy.spin()会保持代码不退出，直到服务关闭</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    add_two_ints_server()</span><br></pre></td></tr></table></figure><p>创建服务器完成后，使用命令<code>sudo chmod +x XXX.py</code>为Python文件添加可执行权限：</p><pre><code>tao@ubuntu:~/catkin_ws/src/ros_learning/script$ sudo chmod +x server.py</code></pre><h2 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h2><ul><li>打开新终端，编译功能包，启动ROS：</li></ul><pre><code>$ cm$ roscore</code></pre><ul><li>打开新终端，运行服务器，可以看出服务在等待客户端请求：</li></ul><pre><code>$ rosrun ros_learning subscriber.py</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E6%9C%8D%E5%8A%A1/%E8%BF%90%E8%A1%8C%E6%9C%8D%E5%8A%A1%E5%99%A8.PNG" width="600" hegiht="400">（图）服务器（Server)</center><ul><li>打开新终端，运行客户端，可以看出，当发出两个整数相加请求后，服务器计算并返回所求的和：</li></ul><pre><code>$ rosrun ros_learning subscriber.py</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E6%9C%8D%E5%8A%A1/%E8%BF%90%E8%A1%8C%E5%AE%A2%E6%88%B7%E7%AB%AF.PNG" width="600" hegiht="600">（图）客户端（Client)</center><p>到此，已经简单了解一下服务的通信模式。</p>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习5：理解话题中Publier与Subscriber(Python)</title>
      <link href="/2019/04/05/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A05%EF%BC%9A%E7%90%86%E8%A7%A3%E8%AF%9D%E9%A2%98%E4%B8%ADPublier%E4%B8%8ESubscriber(Python)/"/>
      <url>/2019/04/05/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A05%EF%BC%9A%E7%90%86%E8%A7%A3%E8%AF%9D%E9%A2%98%E4%B8%ADPublier%E4%B8%8ESubscriber(Python)/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;<a href="http://wiki.ros.org/Topics">话题</a>（topic）是ROS中一种异步通信模式，其中消息以单向发布/订阅（Publish/Subscribe）的方式传递。</p><ul><li>发布者（Publier）：给指定的话题发布消息。</li><li>订阅者（Subscriber）：订阅指定的话题接收消息。</li><li>关系：Publier-Subscriber 多对多</li></ul><p>&emsp;&emsp;话题是单向的，适用于需要连续发送消息的传感器数据，因为它们通过一次的连接连续发送和接收消息。<br>&emsp;&emsp;例如，通过计算移动机器人的两个车轮的编码器值生成可以描述机器人当前位置的里程计（odometry） 信息，并以话题信息（x, y, i）传达，以此实现异步单向的连续消息传输。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/%E8%AF%9D%E9%A2%98%E9%80%9A%E4%BF%A1.PNG" width="600" hegiht="400">（图）话题通信模式</center><p>&emsp;&emsp;话题是一种多对多的通信，即一个话题可以有多个发布者和订阅者。发布者和订阅者并不了解彼此的存在，系统中可能有多个节点发布和订阅同一个话题。单个发布者可以与多个订阅者进行通信，相反，一个订阅者可以在单个话题上与多个发布者进行通信。当然，这两家发布者都可以和多个订阅者进行通信。</p><a id="more"></a><h2 id="话题程序编写"><a href="#话题程序编写" class="headerlink" title="话题程序编写"></a>话题程序编写</h2><p>本例程放在<code>ros_learning</code>功能包script文件夹下，新建<code>ros_learning</code>功能包：</p><pre><code>$ cs$ catkin_create_pkg ros_learning std_msgs rospy roscpp$ cm</code></pre><h3 id="创建发布者（Publier）"><a href="#创建发布者（Publier）" class="headerlink" title="创建发布者（Publier）"></a>创建发布者（Publier）</h3><p>路径：<code>catkin_ws/src/ros_learning/script/publisher.py</code></p><figure class="highlight python"><figcaption><span>publisher.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> std_msgs.msg <span class="keyword">import</span> String</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">talker</span>():</span></span><br><span class="line">    <span class="comment"># 创建发布者pub，发布的话题chatter数据类型为String类型</span></span><br><span class="line">    <span class="comment"># queue_size=10，消息队列，即如果收到的数据大于10，则将开始抛弃最初收到的第一个数据</span></span><br><span class="line">    pub = rospy.Publisher(<span class="string">&#x27;chatter&#x27;</span>, String, queue_size=<span class="number">10</span>)     </span><br><span class="line"></span><br><span class="line">    <span class="comment"># ROS要求每个节点要有唯一名称，如果相同的名称，就会中止之前同名的节点。</span></span><br><span class="line">    <span class="comment"># anoymous=True 通过在你名字的后边添加一个随机数，来保证你的节点独一无二。</span></span><br><span class="line">    rospy.init_node(<span class="string">&#x27;talker&#x27;</span>, anonymous=<span class="literal">True</span>)   <span class="comment"># 初始化节点talker</span></span><br><span class="line">    rate = rospy.Rate(<span class="number">10</span>)   <span class="comment"># 10hz 每秒10次</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        hello_str = <span class="string">&quot;hello world %s&quot;</span> % rospy.get_time()     <span class="comment"># 要发布的消息hello_str　</span></span><br><span class="line">        rospy.loginfo(hello_str)    <span class="comment"># 打印消息</span></span><br><span class="line">        pub.publish(hello_str)      <span class="comment"># 发布消息</span></span><br><span class="line">        rate.sleep()    <span class="comment"># 节点休眠100ms后开始下一个循环</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        talker()</span><br><span class="line">    <span class="keyword">except</span> rospy.ROSInterruptException:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>创建发布者完成后，使用命令<code>sudo chmod +x XXX.py</code>为Python文件添加可执行权限：</p><pre><code>tao@ubuntu:~/catkin_ws/src/ros_learning/script$ sudo chmod +x publisher.py</code></pre><h3 id="创建订阅者（Subscriber）"><a href="#创建订阅者（Subscriber）" class="headerlink" title="创建订阅者（Subscriber）"></a>创建订阅者（Subscriber）</h3><p>路径：<code>catkin_ws/src/ros_learning/script/subscriber.py</code></p><figure class="highlight python"><figcaption><span>subscriber.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> std_msgs.msg <span class="keyword">import</span> String</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback</span>(<span class="params">data</span>):</span></span><br><span class="line">    rospy.loginfo(rospy.get_caller_id() + <span class="string">&quot;I heard %s&quot;</span>, data.data)  <span class="comment">#　回调函数</span></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">listener</span>():</span></span><br><span class="line">    rospy.init_node(<span class="string">&#x27;listener&#x27;</span>, anonymous=<span class="literal">True</span>)     <span class="comment"># 初始化节点listener</span></span><br><span class="line">    rospy.Subscriber(<span class="string">&quot;chatter&quot;</span>, String, callback)   <span class="comment"># 节点listener订阅话题chatter，调用回调函数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 简单保持你的节点一直运行，直到程序关闭。</span></span><br><span class="line">    rospy.spin()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    listener()</span><br></pre></td></tr></table></figure><p>创建订阅者完成后，使用<code>sudo chmod +x XXX.py</code>命令为Python文件添加可执行权限：</p><pre><code>tao@ubuntu:~/catkin_ws/src/ros_learning/script$ sudo chmod +x subscriber.py</code></pre><h2 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h2><h3 id="运行一组话题节点"><a href="#运行一组话题节点" class="headerlink" title="运行一组话题节点"></a>运行一组话题节点</h3><ul><li><p>打开新终端，编译功能包，启动ROS：</p><p>  $ cm<br>  $ roscore</p></li><li><p>打开新终端，运行订阅者，此时发布者还没发送消息：</p></li></ul><pre><code>$ rosrun ros_learning subscriber.py</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E8%AF%9D%E9%A2%98/%E8%BF%90%E8%A1%8C%E8%AE%A2%E9%98%85%E8%80%85.PNG" width="600" hegiht="400">（图）订阅者（Subscriber）</center><ul><li>打开新终端，运行发布者，可以看到打印的发布消息和订阅消息：</li></ul><pre><code>$ rosrun ros_learning publisher.py </code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E8%AF%9D%E9%A2%98/%E8%BF%90%E8%A1%8C%E5%8F%91%E5%B8%83%E8%80%85.PNG" width="800" hegiht="600">（图）发布者（Publier）</center><ul><li>查看话题列表<code>rostopic list</code>和节点列表<code>rosnode list</code></li></ul><pre><code>tao@ubuntu:~$ rostopic list/chatter/rosout/rosout_aggtao@ubuntu:~$ rosnode list/listener_17529_1575516478892/rosout/talker_17632_1575516514932</code></pre><ul><li>查看节点关系<code>rqt_graph</code>，可以看到每一个节点后面都有编号，都是独一无二的。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E8%AF%9D%E9%A2%98/%E8%8A%82%E7%82%B9%E5%85%B3%E7%B3%BB.PNG" width="600" hegiht="400">（图）节点关系</center><h3 id="运行两组话题节点"><a href="#运行两组话题节点" class="headerlink" title="运行两组话题节点"></a>运行两组话题节点</h3><p>接着上一组，再运行一组节点。</p><ul><li>打开新终端，运行订阅者：</li></ul><pre><code>$ rosrun ros_learning subscriber.py</code></pre><ul><li>打开新终端，运行发布者：</li></ul><pre><code>$ rosrun ros_learning publisher.py </code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E8%AF%9D%E9%A2%98/%E8%BF%90%E8%A1%8C%E5%8F%91%E5%B8%83%E8%80%852.PNG" width="800" hegiht="600">（图）发布者（Publier）</center><ul><li>查看话题列表<code>rostopic list</code>和节点列表<code>rosnode list</code></li></ul><pre><code>tao@ubuntu:~$ rostopic list/chatter/rosout/rosout_aggtao@ubuntu:~$ rosnode list/listener_17529_1575516478892/listener_18076_1575516788711/rosout/talker_17632_1575516514932/talker_17809_1575516645091</code></pre><ul><li>查看节点关系<code>rqt_graph</code>，可以看到每一个节点后面都有编号，都是独一无二的。</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/%E8%AF%9D%E9%A2%98/%E8%8A%82%E7%82%B9%E5%85%B3%E7%B3%BB2.PNG" width="600" hegiht="400">（图）节点关系</center><p>到此，已经简单了解一下话题的通信模式。</p>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬虫学习4：MySQL数据库使用</title>
      <link href="/2019/03/09/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A04%EF%BC%9AMySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/03/09/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A04%EF%BC%9AMySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>MySQL数据库使用需要以下软件：</p><ul><li><a href="https://www.mysql.com/](https://www.mysql.com/">MySQL</a> </li><li>pyMySQL</li><li>SQLyog</li></ul>    <div id="aplayer-bFVLwKJq" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="1386873694" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#555"    ></div><a id="more"></a><h2 id="MySQL数据库-安装"><a href="#MySQL数据库-安装" class="headerlink" title="MySQL数据库 安装"></a>MySQL数据库 安装</h2><h3 id="下载-MySQL-windows-版本"><a href="#下载-MySQL-windows-版本" class="headerlink" title="下载 MySQL windows 版本"></a>下载 MySQL windows 版本</h3><p>MySQL 官网：<a href="https://www.mysql.com/">https://www.mysql.com/</a><br>打开<a href="https://dev.mysql.com/downloads/installer/">MySQL windows 下载界面</a> ，选择第二个文件下载</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/sql%20%E4%B8%8B%E8%BD%BD.JPG" width="500" hegiht="400">（图）MySQL windows 下载</center><h3 id="安装-pysql"><a href="#安装-pysql" class="headerlink" title="安装 pysql"></a>安装 pysql</h3><p><strong>方法一：</strong> 命令安装 pyMySQL</p><pre><code>$ pip install PyMySQL</code></pre><p><strong>方法二：</strong> Pycharm 安装 pyMySQL</p><p>(1) 工具栏 <code>File</code>  →  <code>Setting</code>  →  <code>Project interpreter</code><br>(2) 点击“+”号  →  搜索 <code>pyMySQL</code>  →  点击左下角 <code>Install Package</code> 按钮，安装成功后，如下图所示:</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/%E5%AE%89%E8%A3%85%20PyMySQL.JPG" width="500" hegiht="400">（图）Pycharm 安装 pyMySQL</center><h3 id="安装-SQLyog"><a href="#安装-SQLyog" class="headerlink" title="安装 SQLyog"></a>安装 SQLyog</h3><p>（1）SQLyog 下载  </p><blockquote><p><strong><a href="https://pan.baidu.com/s/1V5asuo83MYqWDA840jRa-g">百度云盘</a></strong> 提取码：e9c6</p></blockquote><p>（2）安装成功后，连接 MySQL</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/SQLyog%20%E8%BF%9E%E6%8E%A5.JPG" width="500" hegiht="400">（图）连接 MySQL</center><h2 id="实例-爬取起点中文网VIP收藏榜数据"><a href="#实例-爬取起点中文网VIP收藏榜数据" class="headerlink" title="实例 爬取起点中文网VIP收藏榜数据"></a>实例 爬取起点中文网VIP收藏榜数据</h2><p>起点中文网VIP收藏榜网站：<a href="https://www.qidian.com/rank/vipcollect?style=1">https://www.qidian.com/rank/vipcollect?style=1</a></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/%E8%B5%B7%E7%82%B9%E6%94%B6%E8%97%8F%E6%A6%9C.JPG" width="600" hegiht="400">（图）VIP收藏榜</center><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>(1)网站地址构造。起点中文网VIP收藏榜共五页，每页25条数据。</p><p>第一页：<a href="https://www.qidian.com/rank/vipcollect?style=1">https://www.qidian.com/rank/vipcollect?style=1</a><br>第二页：<a href="https://www.qidian.com/rank/vipcollect?style=1&page=2">https://www.qidian.com/rank/vipcollect?style=1&amp;page=2</a><br>第三页：<a href="https://www.qidian.com/rank/vipcollect?style=1&page=3">https://www.qidian.com/rank/vipcollect?style=1&amp;page=3</a><br>……</p><p>经测试，第一页也可使用<a href="https://www.qidian.com/rank/vipcollect?style=1&page=1">https://www.qidian.com/rank/vipcollect?style=1&amp;page=1</a>进行访问。</p><p>如此，网页访问可构造为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">urls = [<span class="string">&#x27;https://www.qidian.com/rank/vipcollect?style=1&amp;page=&#123;&#125;&#x27;</span>.format(str(i)) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>)]</span><br><span class="line"><span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>（2）爬取目标</p><pre><code>小说的排名 book_rank 小说的名字 book_name 小说的作者 book_author 小说的分类 book_category 小说的状态 book_status 小说的封面地址 book_img 小说的链接地址 book_url </code></pre><p>（3）爬取目标数据提取</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/%E7%88%AC%E5%8F%96%E7%9B%AE%E6%A0%87.JPG" width="800" hegiht="600">（图）爬取目标</center><p>本次提取采用 BeautifulSoup，点击谷歌浏览器右键<code>检查</code>选项，可查找爬取目标数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入相应的库</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到爬取目标数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_books_url</span>(<span class="params">url</span>):</span></span><br><span class="line">    qd_html = requests.get(url, headers=headers)</span><br><span class="line">    soup = BeautifulSoup(qd_html.text, <span class="string">&#x27;lxml&#x27;</span>)  <span class="comment"># 解析数据</span></span><br><span class="line">    ranks = soup.select(<span class="string">&#x27;div.book-img-box &gt; span &#x27;</span>)</span><br><span class="line">    links = soup.select(<span class="string">&#x27;div.book-img-box &gt; a&#x27;</span>)</span><br><span class="line">    names = soup.select(<span class="string">&#x27;div.book-mid-info &gt; h4 &gt;a &#x27;</span>)</span><br><span class="line">    authors = soup.select(<span class="string">&#x27;div.book-mid-info &gt; p.author  &#x27;</span>)</span><br><span class="line">    imgs = soup.select(<span class="string">&#x27;div.book-img-box &gt; a &gt; img &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> rank, name, author, link, img <span class="keyword">in</span> zip(ranks, names, authors, links, imgs):</span><br><span class="line">        book_rank = rank.get_text()</span><br><span class="line">        book_name = name.get_text()</span><br><span class="line">        book_author = author.get_text().split(<span class="string">&#x27;|&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        book_category = author.get_text().split(<span class="string">&#x27;|&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">        book_status = author.get_text().split(<span class="string">&#x27;|&#x27;</span>)[<span class="number">2</span>]</span><br><span class="line">        book_url = link.get(<span class="string">&quot;href&quot;</span>)</span><br><span class="line">        book_img = img.get(<span class="string">&quot;src&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="创建-MySQL-数据库和表"><a href="#创建-MySQL-数据库和表" class="headerlink" title="创建 MySQL 数据库和表"></a>创建 MySQL 数据库和表</h3><h4 id="创建-MySQL-数据库和表-1"><a href="#创建-MySQL-数据库和表-1" class="headerlink" title="创建 MySQL 数据库和表"></a>创建 MySQL 数据库和表</h4><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">创建数据库</a></li><li class="tab"><a href="#tab标签列表-2">创建表</a></li><li class="tab"><a href="#tab标签列表-3">创建结果</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><ul><li>右键 <code>root@localhost</code>  →  <code>创建数据库 </code></li><li>输入数据库名称 <code>mydb</code></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93.JPG" width="400" hegiht="300">（图）创建数据库</center></div><div class="tab-pane" id="tab标签列表-2"><ul><li>右键 <code>mydb</code>  →  <code>表</code>  →  <code>创建表</code></li><li>输入表名称 <code>qidian_book</code>，引擎 <code>InnoDB</code>，字符集 <code>utf8</code>，其它默认。</li><li>输入表的列表名称和数据类型，如下所示，其他默认。</li></ul><pre><code>book_rank  textbook_name  textbook_author  textbook_category  textbook_status  textbook_img  textbook_url  text</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/mysql%20table.JPG" width="800" hegiht="600">（图）创建数据表</center></div><div class="tab-pane" id="tab标签列表-3"><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/%E6%95%B0%E6%8D%AE%E5%BA%93.JPG" width="400" hegiht="600">（图）数据库</center></div></div></div><h4 id="数据提交"><a href="#数据提交" class="headerlink" title="数据提交"></a>数据提交</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入相应的库</span></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接MySQL数据库 mydb</span></span><br><span class="line">conn = pymysql.connect(host=<span class="string">&#x27;localhost&#x27;</span>, user=<span class="string">&#x27;root&#x27;</span>, passwd=<span class="string">&#x27;1213&#x27;</span>, db=<span class="string">&#x27;mydb&#x27;</span>, port=<span class="number">3306</span>, charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交数据到 qidian_book 表中</span></span><br><span class="line">cursor.execute(</span><br><span class="line"><span class="string">&quot;insert into qidian_book (book_rank, book_name, book_author, book_category, book_status, book_url, book_img) values(%s, %s, %s, %s, %s, %s, %s)&quot;</span>, (str(book_rank), str(book_name), str(book_author), str(book_category), str(book_status), str(book_url), str(book_img)))</span><br><span class="line">conn.commit()</span><br></pre></td></tr></table></figure><h2 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h2><h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><figure class="highlight python"><figcaption><span>qidian_vipbook.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 –*-</span></span><br><span class="line"><span class="comment"># 采用 Request 和 BeautifulSoup 实现</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入相应的库</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接MySQL数据库 mydb</span></span><br><span class="line">conn = pymysql.connect(host=<span class="string">&#x27;localhost&#x27;</span>, user=<span class="string">&#x27;root&#x27;</span>, passwd=<span class="string">&#x27;1213&#x27;</span>, db=<span class="string">&#x27;mydb&#x27;</span>, port=<span class="number">3306</span>, charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加入请求头</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.87 Mobile Safari/537.36&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到爬取目标数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_books_url</span>(<span class="params">url</span>):</span></span><br><span class="line">    qd_html = requests.get(url, headers=headers)</span><br><span class="line">    soup = BeautifulSoup(qd_html.text, <span class="string">&#x27;lxml&#x27;</span>)  <span class="comment"># 解析数据</span></span><br><span class="line">    ranks = soup.select(<span class="string">&#x27;div.book-img-box &gt; span &#x27;</span>)</span><br><span class="line">    links = soup.select(<span class="string">&#x27;div.book-img-box &gt; a&#x27;</span>)</span><br><span class="line">    names = soup.select(<span class="string">&#x27;div.book-mid-info &gt; h4 &gt;a &#x27;</span>)</span><br><span class="line">    authors = soup.select(<span class="string">&#x27;div.book-mid-info &gt; p.author  &#x27;</span>)</span><br><span class="line">    imgs = soup.select(<span class="string">&#x27;div.book-img-box &gt; a &gt; img &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> rank, name, author, link, img <span class="keyword">in</span> zip(ranks, names, authors, links, imgs):</span><br><span class="line">        book_rank = rank.get_text()</span><br><span class="line">        book_name = name.get_text()</span><br><span class="line">        book_author = author.get_text().split(<span class="string">&#x27;|&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        book_category = author.get_text().split(<span class="string">&#x27;|&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">        book_status = author.get_text().split(<span class="string">&#x27;|&#x27;</span>)[<span class="number">2</span>]</span><br><span class="line">        book_url = link.get(<span class="string">&quot;href&quot;</span>)</span><br><span class="line">        book_img = img.get(<span class="string">&quot;src&quot;</span>)</span><br><span class="line">        <span class="comment"># 提交数据到 qidian_book 表中</span></span><br><span class="line">        cursor.execute(</span><br><span class="line">            <span class="string">&quot;insert into qidian_book (book_rank, book_name, book_author, book_category, book_status, book_url, book_img) values(%s, %s, %s, %s, %s, %s, %s)&quot;</span>, (str(book_rank), str(book_name), str(book_author), str(book_category), str(book_status), str(book_url), str(book_img)))</span><br><span class="line">        conn.commit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    urls = [<span class="string">&#x27;https://www.qidian.com/rank/vipcollect?style=1&amp;page=&#123;&#125;&#x27;</span>.format(str(i)) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>)]</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">        get_books_url(url)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h3><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8/mysql%20submmit.JPG" width="800" hegiht="600">（图）测试结果</center><div class="note warning">            <p>如果SQLyog连接MySQL时出现的2058错误。。。</p><p><strong>具体参考：</strong><br><a href="https://www.cnblogs.com/hualalalala/p/9344772.html">SQLyog连接MySQL时出现的2058错误解决方法</a></p><p><strong>解决方法：</strong><br>（1）windows 下cmd 登录 mysql -u root -p 登录你的 mysql 数据库，<br>（2）然后执行这条SQL命令：</p><pre><code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;password&#39;;其中 #password 是你自己设置的root密码，注意别忘了分号；</code></pre><p>（3）然后重新配置SQLyog的连接，则可连接成功了，就OK了。</p>          </div>]]></content>
      
      
      <categories>
          
          <category> 爬虫学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫学习 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬虫学习3：爬取酷狗TOP500排行榜</title>
      <link href="/2019/03/08/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A03%EF%BC%9A%E7%88%AC%E5%8F%96%E9%85%B7%E7%8B%97TOP500%E6%8E%92%E8%A1%8C%E6%A6%9C/"/>
      <url>/2019/03/08/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A03%EF%BC%9A%E7%88%AC%E5%8F%96%E9%85%B7%E7%8B%97TOP500%E6%8E%92%E8%A1%8C%E6%A6%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><img  src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/3/%E9%85%B7%E7%8B%97TOP500.JPG" width="600" hegiht="400"><a id="more"></a><h2 id="思路分析"><a href="#思路分析" class="headerlink" title="思路分析"></a>思路分析</h2><h3 id="查看网页HTML信息"><a href="#查看网页HTML信息" class="headerlink" title="查看网页HTML信息"></a>查看网页HTML信息</h3><p><a href="https://www.kugou.com/yy/rank/home/1-8888.html">https://www.kugou.com/yy/rank/home/1-8888.html</a></p><p>酷狗网页版不能翻页，通过观察，尝试更改数字1<br><a href="https://www.kugou.com/yy/rank/home/2-8888.html">https://www.kugou.com/yy/rank/home/2-8888.html</a><br><a href="https://www.kugou.com/yy/rank/home/3-8888.html">https://www.kugou.com/yy/rank/home/3-8888.html</a><br>发现可以实现翻页效果，因此更改home/后面数字即可。</p><h3 id="获取爬取目标"><a href="#获取爬取目标" class="headerlink" title="获取爬取目标"></a>获取爬取目标</h3><figure class="highlight html"><figcaption><span>网页源代码</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pc_temp_songlist &quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot; &quot;</span> <span class="attr">title</span>=<span class="string">&quot;陈雪凝 - 绿色&quot;</span> <span class="attr">data-index</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pc_temp_num&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>1<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.kugou.com/song/txskm8f.html&quot;</span> <span class="attr">data-active</span>=<span class="string">&quot;playDwn&quot;</span> <span class="attr">data-index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pc_temp_songname&quot;</span> <span class="attr">title</span>=<span class="string">&quot;陈雪凝 - 绿色&quot;</span> <span class="attr">hidefocus</span>=<span class="string">&quot;true&quot;</span>&gt;</span>陈雪凝 - 绿色<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pc_temp_tips_r&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pc_temp_time&quot;</span>&gt;</span>4:29<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot; &quot;</span> <span class="attr">title</span>=<span class="string">&quot;孤独诗人 - 渡我不渡她&quot;</span> <span class="attr">data-index</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pc_temp_num&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>2<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.kugou.com/song/th6cka5.html&quot;</span> <span class="attr">data-active</span>=<span class="string">&quot;playDwn&quot;</span> <span class="attr">data-index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pc_temp_songname&quot;</span> <span class="attr">title</span>=<span class="string">&quot;孤独诗人 - 渡我不渡她&quot;</span> <span class="attr">hidefocus</span>=<span class="string">&quot;true&quot;</span>&gt;</span>孤独诗人 - 渡我不渡她<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pc_temp_tips_r&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pc_temp_time&quot;</span>&gt;</span>3:02<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>要爬取的信息：排名、歌手-歌曲名、歌曲时长：</strong></p><pre><code> 排名: ranks = soup.select(&#39;span.pc_temp_num&#39;) 歌手-歌曲名: titles = soup.select(&#39;div.pc_temp_songlist &gt; ul &gt; li &gt; a&#39;) 歌曲时长: times = soup.select(&#39;span.pc_temp_tips_r &gt; span&#39;)</code></pre><h2 id="实例操作"><a href="#实例操作" class="headerlink" title="实例操作"></a>实例操作</h2><h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入库</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加入请求头</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取信息</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_info</span>(<span class="params">url</span>):</span></span><br><span class="line">    wb_data = requests.get(url,headers=headers)</span><br><span class="line">    soup = BeautifulSoup(wb_data.text,<span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    ranks = soup.select(<span class="string">&#x27;span.pc_temp_num&#x27;</span>)  <span class="comment"># 排行</span></span><br><span class="line">    titles = soup.select(<span class="string">&#x27;div.pc_temp_songlist &gt; ul &gt; li &gt; a&#x27;</span>) <span class="comment"># 歌手-歌曲名</span></span><br><span class="line">    times = soup.select(<span class="string">&#x27;span.pc_temp_tips_r &gt; span&#x27;</span>) <span class="comment"># 歌曲时长</span></span><br><span class="line">    <span class="keyword">for</span> rank,title,time <span class="keyword">in</span> zip(ranks,titles,times):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;rank&#x27;</span>:rank.get_text().strip(),</span><br><span class="line">            <span class="string">&#x27;singer&#x27;</span>:title.get_text().split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">0</span>],</span><br><span class="line">            <span class="string">&#x27;song&#x27;</span>:title.get_text().split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">1</span>],</span><br><span class="line">            <span class="string">&#x27;time&#x27;</span>:time.get_text().strip()  </span><br><span class="line">        &#125;</span><br><span class="line">        print(data)  <span class="comment"># 字典格式打印输出</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    urls = [<span class="string">&#x27;http://www.kugou.com/yy/rank/home/&#123;&#125;-8888.html&#x27;</span>.format(str(i)) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">24</span>)]</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls: <span class="comment"># 构造url</span></span><br><span class="line">        get_info(url)</span><br><span class="line">        time.sleep(<span class="number">1</span>) <span class="comment">#睡眠1秒</span></span><br></pre></td></tr></table></figure><h3 id="运行结果-部分"><a href="#运行结果-部分" class="headerlink" title="运行结果(部分)"></a>运行结果(部分)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#39;rank&#39;: &#39;1&#39;, &#39;singer&#39;: &#39;陈雪凝 &#39;, &#39;song&#39;: &#39; 绿色&#39;, &#39;time&#39;: &#39;4:29&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;2&#39;, &#39;singer&#39;: &#39;孤独诗人 &#39;, &#39;song&#39;: &#39; 渡我不渡她&#39;, &#39;time&#39;: &#39;3:02&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;3&#39;, &#39;singer&#39;: &#39;花姐 &#39;, &#39;song&#39;: &#39; 狂浪&#39;, &#39;time&#39;: &#39;3:01&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;4&#39;, &#39;singer&#39;: &#39;张敬轩 &#39;, &#39;song&#39;: &#39; 只是太爱你&#39;, &#39;time&#39;: &#39;4:14&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;5&#39;, &#39;singer&#39;: &#39;王琪 &#39;, &#39;song&#39;: &#39; 站着等你三千年&#39;, &#39;time&#39;: &#39;6:21&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;6&#39;, &#39;singer&#39;: &#39;陈柯宇 &#39;, &#39;song&#39;: &#39; 生僻字&#39;, &#39;time&#39;: &#39;3:36&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;7&#39;, &#39;singer&#39;: &#39;周杰伦 &#39;, &#39;song&#39;: &#39; 告白气球&#39;, &#39;time&#39;: &#39;3:35&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;8&#39;, &#39;singer&#39;: &#39;鱼大仙儿 &#39;, &#39;song&#39;: &#39; 我曾&#39;, &#39;time&#39;: &#39;4:46&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;9&#39;, &#39;singer&#39;: &#39;张紫豪 &#39;, &#39;song&#39;: &#39; 可不可以&#39;, &#39;time&#39;: &#39;4:00&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;10&#39;, &#39;singer&#39;: &#39;胡夏、郁可唯 &#39;, &#39;song&#39;: &#39; 知否知否&#39;, &#39;time&#39;: &#39;4:36&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;11&#39;, &#39;singer&#39;: &#39;半阳 &#39;, &#39;song&#39;: &#39; 一曲相思&#39;, &#39;time&#39;: &#39;2:48&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;12&#39;, &#39;singer&#39;: &#39;郭聪明 &#39;, &#39;song&#39;: &#39; 你会遇见更好的人&#39;, &#39;time&#39;: &#39;3:46&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;13&#39;, &#39;singer&#39;: &#39;陈雪凝 &#39;, &#39;song&#39;: &#39; 你的酒馆对我打了烊&#39;, &#39;time&#39;: &#39;4:11&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;14&#39;, &#39;singer&#39;: &#39;Jennie &#39;, &#39;song&#39;: &#39; SOLO&#39;, &#39;time&#39;: &#39;2:49&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;15&#39;, &#39;singer&#39;: &#39;展展与罗罗 &#39;, &#39;song&#39;: &#39; 沙漠骆驼&#39;, &#39;time&#39;: &#39;5:38&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;16&#39;, &#39;singer&#39;: &#39;奇然liya、沈谧仁 &#39;, &#39;song&#39;: &#39; 琵琶行&#39;, &#39;time&#39;: &#39;5:35&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;17&#39;, &#39;singer&#39;: &#39;SHAUN &#39;, &#39;song&#39;: &#39; Way Back Home&#39;, &#39;time&#39;: &#39;3:34&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;18&#39;, &#39;singer&#39;: &#39;小倩 &#39;, &#39;song&#39;: &#39; 比悲伤更悲伤的故事&#39;, &#39;time&#39;: &#39;4:36&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;19&#39;, &#39;singer&#39;: &#39;于文文 &#39;, &#39;song&#39;: &#39; 体面&#39;, &#39;time&#39;: &#39;4:42&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;20&#39;, &#39;singer&#39;: &#39;花姐 &#39;, &#39;song&#39;: &#39; 夜之光&#39;, &#39;time&#39;: &#39;3:10&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;21&#39;, &#39;singer&#39;: &#39;苏谭谭 &#39;, &#39;song&#39;: &#39; 渡我不渡她 (正式版)&#39;, &#39;time&#39;: &#39;2:18&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;22&#39;, &#39;singer&#39;: &#39;CORSAK、马吟吟 &#39;, &#39;song&#39;: &#39; 溯 (Reverse)&#39;, &#39;time&#39;: &#39;3:12&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;23&#39;, &#39;singer&#39;: &#39;贺一航 &#39;, &#39;song&#39;: &#39; 原来占据你内心的人不是我&#39;, &#39;time&#39;: &#39;4:33&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;24&#39;, &#39;singer&#39;: &#39;许佳慧 &#39;, &#39;song&#39;: &#39; 预谋&#39;, &#39;time&#39;: &#39;4:09&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;25&#39;, &#39;singer&#39;: &#39;广东雨神、许华升 &#39;, &#39;song&#39;: &#39; 陪你到底&#39;, &#39;time&#39;: &#39;4:00&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;26&#39;, &#39;singer&#39;: &#39;火箭少女101 &#39;, &#39;song&#39;: &#39; 卡路里&#39;, &#39;time&#39;: &#39;3:52&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;27&#39;, &#39;singer&#39;: &#39;李玉刚 &#39;, &#39;song&#39;: &#39; 清明上河图&#39;, &#39;time&#39;: &#39;5:08&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;28&#39;, &#39;singer&#39;: &#39;大壮 &#39;, &#39;song&#39;: &#39; 伪装&#39;, &#39;time&#39;: &#39;5:01&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;29&#39;, &#39;singer&#39;: &#39;廖晶 &#39;, &#39;song&#39;: &#39; 爱情小丑&#39;, &#39;time&#39;: &#39;4:57&#39;&#125;</span><br><span class="line">&#123;&#39;rank&#39;: &#39;30&#39;, &#39;singer&#39;: &#39;G.E.M.邓紫棋 &#39;, &#39;song&#39;: &#39; 倒数&#39;, &#39;time&#39;: &#39;3:49&#39;&#125;</span><br><span class="line">......</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 爬虫学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫学习 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬虫学习2：爬取北京地区短租房信息</title>
      <link href="/2019/03/07/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A02%EF%BC%9A%E7%88%AC%E5%8F%96%E5%8C%97%E4%BA%AC%E5%9C%B0%E5%8C%BA%E7%9F%AD%E7%A7%9F%E6%88%BF%E4%BF%A1%E6%81%AF/"/>
      <url>/2019/03/07/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A02%EF%BC%9A%E7%88%AC%E5%8F%96%E5%8C%97%E4%BA%AC%E5%9C%B0%E5%8C%BA%E7%9F%AD%E7%A7%9F%E6%88%BF%E4%BF%A1%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><img  src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/2/%E5%8C%97%E4%BA%AC%E5%B0%8F%E7%8C%AA%E7%A7%9F%E6%88%BF1.JPG" width="600" hegiht="400"><a id="more"></a><h2 id="思路分析"><a href="#思路分析" class="headerlink" title="思路分析"></a>思路分析</h2><p>要爬取网站：<a href="http://bj.xiaozhu.com/">http://bj.xiaozhu.com/</a></p><h3 id="查看网页HTML信息"><a href="#查看网页HTML信息" class="headerlink" title="查看网页HTML信息"></a>查看网页HTML信息</h3><p>第二页：<a href="http://bj.xiaozhu.com/search-duanzufang-p2-0/">http://bj.xiaozhu.com/search-duanzufang-p2-0/</a><br>第三页：<a href="http://bj.xiaozhu.com/search-duanzufang-p3-0/">http://bj.xiaozhu.com/search-duanzufang-p3-0/</a><br>以此类推，点击查看结果<br>第一页：<a href="http://bj.xiaozhu.com/search-duanzufang-p1-0/">http://bj.xiaozhu.com/search-duanzufang-p1-0/</a><br>第n页：<a href="http://bj.xiaozhu.com/search-duanzufang-pn-0/">http://bj.xiaozhu.com/search-duanzufang-pn-0/</a><br>能够实现，接着进行下一步。</p><h3 id="获取爬取目标"><a href="#获取爬取目标" class="headerlink" title="获取爬取目标"></a>获取爬取目标</h3><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/2/%E5%8C%97%E4%BA%AC%E5%B0%8F%E7%8C%AA%E7%A7%9F%E6%88%BF2.JPG" width="600" hegiht="400"></center><p>要爬取的信息：标题、地址、价格、房东名称、房东性别、房东头像链接。<br>例如：</p><pre><code>&#123;&#39;tittle&#39;: &#39;初见黎戈.温馨整租地铁景泰站天坛南门直达南站&#39;, &#39;address&#39;: &#39;北京市丰台区景泰西里西区&#39;, &#39;price&#39;: &#39;558&#39;, &#39;img&#39;: &#39;https://image.xiaozhustatic1.com/21/14,0,53,20357,376,375,56c14dc3.jpg&#39;, &#39;name&#39;: &#39;爱笑的婷哥&#39;, &#39;sex&#39;: &#39;女&#39;&#125;</code></pre><p><strong>查看信息：</strong><br>Chrome浏览器按F12打开开发者工具，查找相关元素；或者查看网页源代码</p><h4 id="获取标题、地址"><a href="#获取标题、地址" class="headerlink" title="获取标题、地址"></a>获取标题、地址</h4><figure class="highlight html"><figcaption><span>网页源代码</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pho_info&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">h4</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">em</span>&gt;</span>初见黎戈.温馨整租地铁景泰站天坛南门直达南站<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">                                       </span><br><span class="line">             <span class="tag">&lt;<span class="name">p</span> <span class="attr">title</span>=<span class="string">&quot;北京市丰台区景泰西里西区&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line">                                  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;pr5&quot;</span>&gt;</span>北京市丰台区景泰西里西区</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>获取标题、地址：</strong></p><pre><code>标题：tittles = soup.select(&#39;div.pho_info &gt; h4&#39;)地址：addresses = soup.select(&#39;span.pr5&#39;)</code></pre><h4 id="获取价格、房东名称、房东性别、房东头像链接"><a href="#获取价格、房东名称、房东性别、房东头像链接" class="headerlink" title="获取价格、房东名称、房东性别、房东头像链接"></a>获取价格、房东名称、房东性别、房东头像链接</h4><figure class="highlight html"><figcaption><span>网页源代码</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bg_box&quot;</span> <span class="attr">id</span>=<span class="string">&quot;floatRightBox&quot;</span> <span class="attr">style</span>=<span class="string">&quot;position: static;&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;day_top clearfix&quot;</span> <span class="attr">id</span>=<span class="string">&quot;pricePart&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;day_l&quot;</span>&gt;</span>¥<span class="tag">&lt;<span class="name">span</span>&gt;</span>558<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">em</span>&gt;</span>起<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;day_r&quot;</span>&gt;</span>每晚<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                          </span><br><span class="line">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;js_box clearfix&quot;</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;member_pic&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;member_ico1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                             <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://www.xiaozhu.com/fangdong/17313731801/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span></span><br><span class="line">                             <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://image.xiaozhustatic1.com/21/14,0,53,20357,376,375,56c14dc3.jpg&quot;</span>  // <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                         <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;w_240&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 215px;&quot;</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">h6</span>&gt;</span></span><br><span class="line">                                   <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;lorder_name&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://www.xiaozhu.com/fangdong/17313731801/&quot;</span> <span class="attr">title</span>=<span class="string">&quot;爱笑的婷哥&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>爱笑的婷哥<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                                   <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;member_girl_ico&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">                  </span><br></pre></td></tr></table></figure><p><strong>获取价格、房东名称、房东性别、房东头像链接：</strong></p><pre><code>价格：prices = soup.select(&#39;#pricePart &gt; div.day_l &gt; span&#39;)房东性别：sexs = soup.select(&#39;#floatRightBox &gt; div.js_box.clearfix &gt; div.member_pic &gt; div&#39;)房东头像链接：imgs = soup.select(&#39;#floatRightBox &gt; div.js_box.clearfix &gt; div.member_pic &gt; a &gt; img&#39;)房东姓名：names = soup.select(&#39;#floatRightBox &gt; div.js_box.clearfix &gt; div.w_240 &gt; h6 &gt; a&#39;)</code></pre><h3 id="加入请求头，伪装成浏览器"><a href="#加入请求头，伪装成浏览器" class="headerlink" title="加入请求头，伪装成浏览器"></a>加入请求头，伪装成浏览器</h3><p>Chrome浏览器按F12打开开发者工具，找到Network–&gt;Headers–&gt;User-Agent: 进行复制</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E4%B8%93%E7%94%A8/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/1/%E8%AF%B7%E6%B1%82%E5%A4%B4.JPG" width="300" hegiht="400"></center><p><strong>请求头</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Request Headers</span><br><span class="line">Provisional headers are shown</span><br><span class="line">Content-Type: text&#x2F;plain;charset&#x3D;UTF-8</span><br><span class="line">Origin: http:&#x2F;&#x2F;bj.xiaozhu.com</span><br><span class="line">Referer: http:&#x2F;&#x2F;bj.xiaozhu.com&#x2F;search-duanzufang-p2-0&#x2F;</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;72.0.3626.121 Safari&#x2F;537.36</span><br></pre></td></tr></table></figure><h3 id="从主页获取分页url"><a href="#从主页获取分页url" class="headerlink" title="从主页获取分页url"></a>从主页获取分页url</h3><figure class="highlight html"><figcaption><span>网页源代码</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;page_list&quot;</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;pic_list clearfix&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">lodgeunitid</span>=<span class="string">&quot;lodgeunit_32332047201&quot;</span> <span class="attr">latlng</span>=<span class="string">&quot;40.056149,116.444755&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://bj.xiaozhu.com/fangzi/32332047201.html&quot;</span> <span class="attr">class</span>=<span class="string">&quot;resule_img_a&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;lodgeunitpic&quot;</span> <span class="attr">title</span>=<span class="string">&quot;紧邻华贸城福熙大道乐想汇公寓美式一居品茶&quot;</span> <span class="attr">data-growing-title</span>=<span class="string">&quot;32332047201&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://image.xiaozhustatic3.com/12/14,0,15,28119,1800,1200,eb500b46.jpg&quot;</span> <span class="attr">lazy_src</span>=<span class="string">&quot;finish&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;紧邻华贸城福熙大道乐想汇公寓美式一居品茶&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 290px;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://bj.xiaozhu.com/fangzi/32113089701.html&quot;</span> <span class="attr">class</span>=<span class="string">&quot;resule_img_a&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;lodgeunitpic&quot;</span> <span class="attr">title</span>=<span class="string">&quot;初见黎戈.温馨整租地铁景泰站天坛南门直达南站&quot;</span> <span class="attr">data-growing-title</span>=<span class="string">&quot;32113089701&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://image.xiaozhustatic3.com/12/14,0,49,24365,1800,1200,2554932d.jpg&quot;</span> <span class="attr">lazy_src</span>=<span class="string">&quot;finish&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;初见黎戈.温馨整租地铁景泰站天坛南门直达南站&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 290px;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>获取分页url</strong></p><pre><code>links = soup.select(&#39;#page_list &gt; ul &gt; li &gt; a&#39;) #通过selector方法定位元素位置，提取信息href = link.get(&quot;href&quot;) get_info(href) #循环调用get_info()函数获取分页url</code></pre><h2 id="实例操作"><a href="#实例操作" class="headerlink" title="实例操作"></a>实例操作</h2><h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入相应的库</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加入请求头,伪装成浏览器</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断用户性别，</span></span><br><span class="line"><span class="comment">#Chrome浏览器按F12打开开发者工具，可以看到&lt;div class=&quot;member_ico1&quot;&gt;&lt;/div&gt;对应女性；&lt;div class=&quot;member_ico&quot;&gt;&lt;/div&gt;对应男性。</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">judgment_sex</span>(<span class="params">class_name</span>):</span></span><br><span class="line">  <span class="keyword">if</span> class_name == [<span class="string">&#x27;member_ico1&#x27;</span>]:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;女&#x27;</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">return</span>  <span class="string">&#x27;男&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_links</span>(<span class="params">url</span>):</span></span><br><span class="line">    wb_data = requests.get(url,headers=headers) <span class="comment">#请求网页</span></span><br><span class="line">    soup = BeautifulSoup(wb_data.text,<span class="string">&#x27;lxml&#x27;</span>)  <span class="comment">#解析数据</span></span><br><span class="line">    links = soup.select(<span class="string">&#x27;#page_list &gt; ul &gt; li &gt; a&#x27;</span>) <span class="comment">#通过selector方法定位元素位置，提取信息</span></span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">        href = link.get(<span class="string">&quot;href&quot;</span>) </span><br><span class="line">        get_info(href) <span class="comment">#循环调用get_info()函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取网页信息</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_info</span>(<span class="params">url</span>):</span></span><br><span class="line">    wb_data = requests.get(url,headers=headers)</span><br><span class="line">    soup = BeautifulSoup(wb_data.text,<span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    tittles = soup.select(<span class="string">&#x27;div.pho_info &gt; h4&#x27;</span>) <span class="comment">#标题</span></span><br><span class="line">    addresses = soup.select(<span class="string">&#x27;span.pr5&#x27;</span>) <span class="comment">#地址</span></span><br><span class="line">    prices = soup.select(<span class="string">&#x27;#pricePart &gt; div.day_l &gt; span&#x27;</span>) <span class="comment">#价格</span></span><br><span class="line">    imgs = soup.select(<span class="string">&#x27;#floatRightBox &gt; div.js_box.clearfix &gt; div.member_pic &gt; a &gt; img&#x27;</span>) <span class="comment">#房东头像链接</span></span><br><span class="line">    names = soup.select(<span class="string">&#x27;#floatRightBox &gt; div.js_box.clearfix &gt; div.w_240 &gt; h6 &gt; a&#x27;</span>) <span class="comment">#房东姓名</span></span><br><span class="line">    sexs = soup.select(<span class="string">&#x27;#floatRightBox &gt; div.js_box.clearfix &gt; div.member_pic &gt; div&#x27;</span>) <span class="comment">#房东性别</span></span><br><span class="line">    <span class="keyword">for</span> tittle, address, price, img, name, sex <span class="keyword">in</span> zip(tittles,addresses,prices,imgs,names,sexs):</span><br><span class="line">        data = &#123;   <span class="comment">#构造字典方式信息数据</span></span><br><span class="line">            <span class="string">&#x27;tittle&#x27;</span>:tittle.get_text().strip(),</span><br><span class="line">            <span class="string">&#x27;address&#x27;</span>:address.get_text().strip(),</span><br><span class="line">            <span class="string">&#x27;price&#x27;</span>:price.get_text(),</span><br><span class="line">            <span class="string">&#x27;img&#x27;</span>:img.get(<span class="string">&quot;src&quot;</span>),</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>:name.get_text(),</span><br><span class="line">            <span class="string">&#x27;sex&#x27;</span>:judgment_sex(sex.get(<span class="string">&quot;class&quot;</span>))</span><br><span class="line">        &#125; </span><br><span class="line">        print(data) <span class="comment">#通过字典打印</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 主函数</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: </span><br><span class="line">    urls = [<span class="string">&#x27;http://bj.xiaozhu.com/search-duanzufang-p&#123;&#125;-0/&#x27;</span>.format(number) <span class="keyword">for</span> number <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">14</span>)] <span class="comment">#构造网站前13页url</span></span><br><span class="line">    <span class="keyword">for</span> single_url <span class="keyword">in</span> urls:</span><br><span class="line">        get_links(single_url) <span class="comment">#循环调用get_links()函数</span></span><br><span class="line">        time.sleep(<span class="number">2</span>)  <span class="comment">#睡眠2秒</span></span><br></pre></td></tr></table></figure><h3 id="运行结果-部分"><a href="#运行结果-部分" class="headerlink" title="运行结果(部分)"></a>运行结果(部分)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#39;tittle&#39;: &#39;近国贸九龙山双地铁-南站西站地铁直达-旧时光&#39;, &#39;address&#39;: &#39;北京市朝阳区风度柏林&#39;, &#39;price&#39;: &#39;428&#39;, &#39;img&#39;: &#39;https:&#x2F;&#x2F;image.xiaozhustatic1.com&#x2F;21&#x2F;8,0,96,14129,356,356,8308d7cf.jpg&#39;, &#39;name&#39;: &#39;小马佳佳&#39;, &#39;sex&#39;: &#39;女&#39;&#125;</span><br><span class="line">&#123;&#39;tittle&#39;: &#39;初见黎戈.温馨整租地铁景泰站天坛南门直达南站&#39;, &#39;address&#39;: &#39;北京市丰台区景泰西里西区&#39;, &#39;price&#39;: &#39;558&#39;, &#39;img&#39;: &#39;https:&#x2F;&#x2F;image.xiaozhustatic1.com&#x2F;21&#x2F;14,0,53,20357,376,375,56c14dc3.jpg&#39;, &#39;name&#39;: &#39;爱笑的婷哥&#39;, &#39;sex&#39;: &#39;女&#39;&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 爬虫学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫学习 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬虫学习1：安装Requests、Lxml、Beautifulsoup4库</title>
      <link href="/2019/03/06/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A01%EF%BC%9A%E5%AE%89%E8%A3%85Requests%E3%80%81Lxml%E3%80%81Beautifulsoup4%E5%BA%93/"/>
      <url>/2019/03/06/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A01%EF%BC%9A%E5%AE%89%E8%A3%85Requests%E3%80%81Lxml%E3%80%81Beautifulsoup4%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/1/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0.jpg" width="600" hegiht="400"><a id="more"></a><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>安装<code>Requests</code>、<code>Lxml</code>、<code>Beautifulsoup4</code>库</p><ul><li><strong>Requests</strong> ：请求网站获取网页数据。</li><li><strong>Beautifulsoup4</strong> ：解析Requests库请求的网页，并把网页源代码解析成Soup文档，以便过滤提取数据。</li><li><strong>Lxml</strong> ：解析器</li></ul><p><code>Beautifulsoup</code>库官方推荐使用<code>lxml</code>作为解析器，效率更高。</p><h3 id="方法一：使用Pycharm安装"><a href="#方法一：使用Pycharm安装" class="headerlink" title="方法一：使用Pycharm安装"></a>方法一：使用Pycharm安装</h3><p>(1) File–&gt;Setting–&gt;Project Interpreter。<br>(2) 单击‘+’号，输入第三方库名称，单击Install Package进行安装。<br>(3) 单击‘-’号，可卸载第三方库。</p><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">1/2</a></li><li class="tab"><a href="#tab标签列表-2">2/2</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/1/pycharm%E5%AE%89%E8%A3%85%E5%BA%931.JPG" width="500" hegiht="300"></div><div class="tab-pane" id="tab标签列表-2"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/1/pycharm%E5%AE%89%E8%A3%85%E5%BA%932.JPG" width="500" hegiht="300"></div></div></div><h3 id="方法二：使用pip安装"><a href="#方法二：使用pip安装" class="headerlink" title="方法二：使用pip安装"></a>方法二：使用pip安装</h3><p>安装Python后，pip同时会进行安装。<br><strong>（1）使用cmd查看pip版本</strong> </p><pre><code>$ pip --version</code></pre><p><strong>终端显示:</strong></p><blockquote><p>C:\Users\tao&gt;pip –version<br>pip 10.0.1 from c:\users\tao\appdata\local\programs\python\python37\lib\site-packages\pip (python 3.7)</p></blockquote><p><strong>（2）使用cmd安装第三方库</strong><br>pip3 install packagename (packagename 为第三方库名称)</p><pre><code>$ pip3 install beautifulsoup4$ pip3 install requests$ pip3 install lxml</code></pre><p><strong>终端显示:</strong></p><blockquote><p>Successfully installed beautifulsoup4-4.7.1 soupsieve-1.9<br>Successfully installed certifi-2019.3.9 chardet-3.0.4 idna-2.8 requests-2.21.0 urllib3-1.24.1<br>Successfully installed lxml-4.3.3</p></blockquote><h3 id="方法三：使用whl安装"><a href="#方法三：使用whl安装" class="headerlink" title="方法三：使用whl安装"></a>方法三：使用whl安装</h3><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/1/whl%E5%AE%89%E8%A3%85%E5%BA%93.JPG" width="300" hegiht="200"></center><p>(1) 进入<a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/">https://www.lfd.uci.edu/~gohlke/pythonlibs/</a>，搜索第三方库<br>(2) 打开CMD命令提示符，输入以下命令：</p><pre><code>$ pip3 install wheel     # 第一次使用安装wheel $ cd C:\Users\tao\Downloads$ pip3 install lxml-4.3.3-cp37-cp37m-win_amd64.whl</code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫学习 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习4：创建工作空间与功能包</title>
      <link href="/2019/03/03/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A04%EF%BC%9A%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E4%B8%8E%E5%8A%9F%E8%83%BD%E5%8C%85/"/>
      <url>/2019/03/03/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A04%EF%BC%9A%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E4%B8%8E%E5%8A%9F%E8%83%BD%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script>    <div id="aplayer-AwBVGcuA" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="1308819790" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#555"    ></div><pre><code>$ mkdir -p ~/catkin_ws/src  //创建工作空间目录，存放src文件$ cd ~/catkin_ws/src  //进入src$ catkin_init_workspace   //初始化工作空间$ cd ~/catkin_ws  //进入工作空间$ catkin_make //编译，空目录也可以编译</code></pre><a id="more"></a><h2 id="创建工作空间"><a href="#创建工作空间" class="headerlink" title="创建工作空间"></a>创建工作空间</h2><h3 id="创建一个catkin-ws工作空间"><a href="#创建一个catkin-ws工作空间" class="headerlink" title="创建一个catkin_ws工作空间"></a>创建一个catkin_ws工作空间</h3><pre><code>$ mkdir -p ~/catkin_ws/src  //创建工作空间目录，存放src文件$ cd ~/catkin_ws/src  //进入src$ catkin_init_workspace   //初始化工作空间$ cd ~/catkin_ws  //进入工作空间$ catkin_make //编译，空目录也可以编译</code></pre><p><strong>说明：</strong></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/3/%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B41.JPG" width="400" hegiht="400">（图）工作空间catkin_ws</center><p>&emsp;&emsp;工作目录是对用户创建的功能包和其他开发人员公开的功能包进行存储和构建的空间。用户在该目录中执行与ROS有关的大部分操作。典型的工作空间一般包含以下四个目录空间：</p><ul><li>src 代码空间：存储功能包</li><li>build 编译空间：存储编译过程产生的文件</li><li>devel 开发空间：放置编译生成的可执行文件</li><li>install 安装空间：很多工作空间可能没有该空间。编译成功后，运行make install 将可执行文件安装到此空间，运行该空间中环境变量脚本，即可在终端运行这些可执行文件。</li></ul><h2 id="创建功能包"><a href="#创建功能包" class="headerlink" title="创建功能包"></a>创建功能包</h2><p>&emsp;&emsp;创建ROS功能包的命令如下。</p><pre><code>$ catkin_create_pkg [功能包名称] [依赖功能包1] ...[依赖功能包n]</code></pre><p>&emsp;&emsp;“catkin_create_pkg”命令在创建用户功能包时会生成catkin 构建系统所需的CMakeLists.txt和package.xml文件的包目录。</p><p>&emsp;&emsp;在一个代码空间内，可能会包含多个ROS工程包。而最基本ROS工程包中会包括CmakeLists.txt和Package.xml这两个文件，其中Package.xml中主要包含本项目信息和各种依赖（depends），而CmakeLists.txt中包含了如何编译和安装代码的信息。</p><h3 id="创建ros-learning功能包"><a href="#创建ros-learning功能包" class="headerlink" title="创建ros_learning功能包"></a>创建ros_learning功能包</h3><p>&emsp;&emsp;首先打开一个新的终端窗口（Ctrl+Alt+t）</p><pre><code>$ cs$ catkin_create_pkg ros_learning std_msgs rospy roscpp$ cm</code></pre><ul><li>std_msgs: ROS定义的的标准消息</li><li>rospy: 为了在ROS中使用Python</li><li>roscpp: 为了在ROS中使用C/C++</li></ul><p><strong>说明：</strong></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/3/%E5%8A%9F%E8%83%BD%E5%8C%851.JPG" width="400" hegiht="400">（图）创建ros_learning功能包</center><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/3/%E7%BB%88%E7%AB%AF%E6%98%BE%E7%A4%BA3.JPG" width="400" hegiht="400">（图）创建ros_learning功能包</center><ul><li>include → include目录</li><li>src → 源代码目录</li><li>CMakeLists.txt → 构建配置文件</li><li>package.xml → 功能包配置文件</li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
            <tag> Ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习3：ROS架构与通信机制</title>
      <link href="/2019/03/03/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A03%EF%BC%9AROS%E6%9E%B6%E6%9E%84%E4%B8%8E%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/"/>
      <url>/2019/03/03/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A03%EF%BC%9AROS%E6%9E%B6%E6%9E%84%E4%B8%8E%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><img src="https://album-1257031621.cos.ap-nanjing.myqcloud.com/read_more_photos/digitization-4751659_1920.jpg"></p><p>参考<a href="http://wiki.ros.org/ROS/Concepts">ROS基本概念</a>，</p>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习2：ROS安装教程</title>
      <link href="/2019/03/02/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A02%EF%BC%9AROS%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
      <url>/2019/03/02/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A02%EF%BC%9AROS%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;自2010年<a href="http://www.ros.org/">机器人操作系统ROS</a>发布以来，目前已经有12个<a href="http://wiki.ros.org/Distributions">迭代版本</a>，不同的ROS版本对应不同Ubuntu版本，版本选择错误，可能会出现不兼容、安装失败等问题。</p><p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/ROS%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/%E7%89%88%E6%9C%AC%E9%80%89%E6%8B%A91.JPG"></p><pre><code>- ROS Melodic Morenia主要针对Ubuntu 18.04（Bionic）版本；- ROS Lunar Loggerhead主要针对Ubuntu 17.04（Zesty）版本；- ROS Kinetic Kame主要针对Ubuntu 16.04（Xenial）版本。</code></pre><p>&emsp;&emsp;本文虚拟机运行<a href="http://releases.ubuntu.com/xenial/">Ubuntu 16.04.5 LTS (Xenial Xerus)</a>，以ROS版本 <a href="http://wiki.ros.org/kinetic">ROS Kinetic Kame</a>为例。</p><a id="more"></a><h2 id="安装ROS"><a href="#安装ROS" class="headerlink" title="安装ROS"></a>安装ROS</h2><ul><li>ROS官网：<a href="http://www.ros.org/">http://www.ros.org/</a></li><li>Ubuntu版本下载：<a href="http://releases.ubuntu.com/">http://releases.ubuntu.com/</a></li><li>基于Ubuntu安装ROS kinetic教程：<a href="http://wiki.ros.org/kinetic/Installation/Ubuntu">http://wiki.ros.org/kinetic/Installation/Ubuntu</a></li></ul><h3 id="选择镜像源"><a href="#选择镜像源" class="headerlink" title="选择镜像源"></a>选择镜像源</h3><p>&emsp;&emsp;（1）打开<code>系统设置</code> → <code>软件和更新</code>，设置如下图：</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/ROS%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/%E8%BD%AF%E4%BB%B6%E5%92%8C%E6%9B%B4%E6%96%B0.jpg" width="400" hegiht="300"></center><p>（2）在 <code>下载自</code> 中选择 <code>其他站点</code> ，然后在中国的条目下选择 <code>mirrors.ustc.edu.cn</code>或者<code>mirrors.tuna.tsinghua.edu.cn</code> 。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/ROS%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/ubuntu-%E8%BD%AF%E4%BB%B6%E6%BA%90%E8%AE%BE%E7%BD%AE%20%E4%B8%AD%E7%A7%91%E5%A4%A7%201.png" width="400" hegiht="300"></center><ul><li>中科大镜像：mirrors.ustc.edu.cn</li><li>清华大学镜像：mirrors.tuna.tsinghua.edu.cn</li></ul><h3 id="开始安装"><a href="#开始安装" class="headerlink" title="开始安装"></a>开始安装</h3><p><strong>（1）添加源sources.list</strong><br>选择一条国内的源，能够大大提高安装下载速度。</p><pre><code># 原始版本$ sudo sh -c &#39;echo &quot;deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list&#39;# 中科大镜像源 USTC$ sudo sh -c &#39;. /etc/lsb-release &amp;&amp; echo &quot;deb http://mirrors.ustc.edu.cn/ros/ubuntu/ $DISTRIB_CODENAME main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list&#39;# 清华大学镜像源 Tsinghua University$ sudo sh -c &#39;. /etc/lsb-release &amp;&amp; echo &quot;deb http://mirrors.tuna.tsinghua.edu.cn/ros/ubuntu/ $DISTRIB_CODENAME main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list&#39;</code></pre><p><strong>（2）设置key</strong></p><pre><code>$ sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-key 421C365BD9FF1F717815A3895523BAEEB01FA116</code></pre><p><strong>（3）确保软件处于最新版</strong></p><pre><code>$ sudo apt-get update</code></pre><p><strong>（4）安装ROS</strong><br>&emsp;&emsp;ROS安装时间有点长。。。完全取决于网速。</p><pre><code>安装桌面完整版: (推荐) : 包含ROS、rqt、rviz、机器人通用库、2D/3D 模拟器、导航以及2D/3D感知$ sudo apt-get install ros-kinetic-desktop-full基础版安装: (简版) 包含ROS核心软件包、构建工具以及通信相关的程序库，无GUI工具。适用于树莓派。 $ sudo apt-get install ros-kinetic-ros-base</code></pre><p><strong>（5）安装rosdep</strong><br>&emsp;&emsp;在使用ROS之前，需要初始化rosdep。rosdep可以轻松地为要编译的源安装系统依赖项，并且需要在ROS中运行一些核心组件。</p><pre><code>$ sudo rosdep init$ rosdep update</code></pre><p><strong>（6）配置环境变量</strong></p><pre><code>$ echo &quot;source /opt/ros/kinetic/setup.bash&quot; &gt;&gt; ~/.bashrc$ source ~/.bashrc</code></pre><p><strong>（7）安装依赖包</strong><br>&emsp;&emsp;rosinstall是一种常用的命令行工具，使您可以使用一个命令轻松下载ROS包的许多源树。</p><pre><code>$ sudo apt-get install python-rosinstall python-rosinstall-generator python-wstool build-essential</code></pre><h2 id="测试ROS"><a href="#测试ROS" class="headerlink" title="测试ROS"></a>测试ROS</h2><p>&emsp;&emsp;安装完成后，测试ROS安装效果。输入命令<code>roscore</code>，启动ROS。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/ROS%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/kinetic.png" width="400" hegiht="400">（图）启动ROS</center><h2 id="卸载ROS"><a href="#卸载ROS" class="headerlink" title="卸载ROS"></a>卸载ROS</h2><pre><code>$ sudo apt-get purge ros-*卸载ros$ sudo rm -rf /etc/ros移除ros$ gedit ~/.bashrc移除环境变量，删除最后一行关于当前ros版本的变量。</code></pre><p>&emsp;&emsp;卸载成功的效果就是/opt下的ROS文件夹被删除，原先的ROS以及曾经安装在ROS中的package也没有了。</p><h2 id="ROS配置"><a href="#ROS配置" class="headerlink" title="ROS配置"></a>ROS配置</h2><p>&emsp;&emsp;要加载一个配置文件，就像在ROS安装过程中使用的以下命令一样，每次打开新的终端窗口时都必须运行它。</p><pre><code>$ source /opt/ros/kinetic/setup.bash$ source ~/catkin_ws/devel/setup.bash</code></pre><p>  为了避免这个繁琐的任务，可以设置终端，使得每次打开新的终端窗口时，都读入配置文件。另外，还将常用的命令简化为快捷命令。</p><p>（1）打开<code>~/.bashrc</code>配置文件：</p><pre><code>$ gedit ~/.bashrc</code></pre><p>（2）在<code>~/.bashrc</code>配置文件最后添加：</p><figure class="highlight plain"><figcaption><span>~/.bashrc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Set ROS Kinetic</span><br><span class="line">source &#x2F;opt&#x2F;ros&#x2F;kinetic&#x2F;setup.bash</span><br><span class="line">source ~&#x2F;catkin_ws&#x2F;devel&#x2F;setup.bash</span><br><span class="line"></span><br><span class="line"># Set ROS alias command</span><br><span class="line">alias cw&#x3D;&#39;cd ~&#x2F;catkin_ws&#39;</span><br><span class="line">alias cs&#x3D;&#39;cd ~&#x2F;catkin_ws&#x2F;src&#39;</span><br><span class="line">alias cm&#x3D;&#39;cd ~&#x2F;catkin_ws &amp;&amp; catkin_make&#39;</span><br></pre></td></tr></table></figure><p>说明：</p><ul><li>cw：进入~/catkin_ws，预设的catkin工作目录</li><li>cs：进入catkin工作目录中保存源文件的~/catkin_ws/src目录</li><li>cm：在移动到catkin工作目录~/catkin_ws之后，用catkin_make命令构建ROS功能包</li></ul><p>（3）最后在终端运行：</p><pre><code>$ source ~/.bashrc</code></pre><h2 id="容易出现的问题"><a href="#容易出现的问题" class="headerlink" title="容易出现的问题"></a>容易出现的问题</h2><ul><li><strong>无法获得锁问题？</strong></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/ROS%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/%E6%97%A0%E6%B3%95%E8%8E%B7%E5%BE%97%E9%94%81%E9%97%AE%E9%A2%98.png" width="600" hegiht="400">（图）无法获得锁问题</center><p><strong>解决办法：</strong></p><p>打开终端，输入强制解锁命令：</p><pre><code>$ sudo rm /var/cache/apt/archives/lock$ sudo rm /var/lib/dpkg/lock</code></pre><ul><li><strong>输入命令 sudo apt-get update 时出现 Hash 校验和不符问题</strong></li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/ROS%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/Hash%E6%A0%A1%E9%AA%8C%E5%92%8C%E4%B8%8D%E7%AC%A6.png" width="600" hegiht="800">（图）Hash 校验和不符问题</center><p><strong>解决办法：</strong></p><p>打开终端，使用命令清除临时文件：</p><pre><code>$ sudo apt-get clean$ sudo rm -rf /var/lib/apt/lists/*</code></pre><ul><li><strong>安装ROS选择中科大镜像源后，sudo apt-get update 出现没有公钥问题</strong></li></ul><pre><code>W: GPG 错误：http://mirrors.ustc.edu.cn/ros/ubuntu xenial InRelease: 由于没有公钥，无法验证下列签名： NO_PUBKEY F42ED6FBAB17C654W: 仓库 “http://mirrors.ustc.edu.cn/ros/ubuntu xenial InRelease” 没有数字签名。N: 无法认证来自该源的数据，所以使用它会带来潜在风险。N: 参见 apt-secure(8) 手册以了解仓库创建和用户配置方面的细节。</code></pre><p><strong>解决办法：</strong></p><p>打开终端，安装钥匙</p><pre><code>$ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys F42ED6FBAB17C654</code></pre>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
            <tag> Ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROS入门学习1：机器人操作系统ROS</title>
      <link href="/2019/03/01/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A01%EF%BC%9A%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9FROS/"/>
      <url>/2019/03/01/ROS%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A01%EF%BC%9A%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9FROS/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;<a href="https://www.ros.org/">ROS</a>是机器人操作系统（Robot Operating System）的英文缩写。ROS系统是起源于2007年斯坦福大学人工智能实验室的项目与机器人技术公司Willow Garage的个人机器人项目（Personal Robots Program）之间的合作，2008年之后就由Willow Garage来进行推动。从2010年3月2日发布的第一版ROS Box Turtle至今（截止到2019年8月）已有12个版本。</p><p>&emsp;&emsp;推荐两个长期维护的<a href="http://wiki.ros.org/Distributions">ROS版本</a>：</p><table><thead><tr><th align="center">ROS版本</th><th align="center">发布日期</th><th align="center">海报</th><th align="center">停止支持时间</th><th align="center">对应Ubuntu系统</th></tr></thead><tbody><tr><td align="center"><a href="http://wiki.ros.org/melodic">ROS Melodic Morenia</a></td><td align="center">May 23rd, 2018</td><td align="center"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/1/melodic_with_bg.png" width="100" hegiht="100"></td><td align="center">May, 2023(Bionic EOL)</td><td align="center">Ubuntu 18.04 (Bionic)</td></tr><tr><td align="center"><a href="http://wiki.ros.org/kinetic">ROS Kinetic Kame</a></td><td align="center">May 23rd, 2017</td><td align="center"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/1/kinetic.png" width="100" hegiht="100"></td><td align="center">April, 2021(Xenial EOL)</td><td align="center">Ubuntu 16.04 (Xenial)</td></tr></tbody></table><a id="more"></a><h2 id="RoboWare-Studio"><a href="#RoboWare-Studio" class="headerlink" title="RoboWare Studio"></a>RoboWare Studio</h2><p>&emsp;&emsp;ROS编辑器有多种，这里推荐RoboWare Studio编辑器，对ROS支持较好。<a href="http://www.roboware.me/">Roboware官网</a>可能进不去，可选择Github下载地址：<a href="https://github.com/TonyRobotics/RoboWare/tree/master/Studio">https://github.com/TonyRobotics/RoboWare/tree/master/Studio</a></p><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/ROS%E5%AD%A6%E4%B9%A0/1/20190601131328631.png"></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul><li>为了支持Python调试功能，需要安装pylint：</li></ul><pre><code>$ sudo apt-get install python-pip$ sudo python -m pip install pylint</code></pre><ul><li>为了获得更好的代码阅读体验，自动格式化整理代码，需要安装clang-format：</li></ul><pre><code>$ sudo apt-get install clang-format-3.8</code></pre><ul><li>选择<a href="https://github.com/TonyRobotics/RoboWare/tree/master/Studio](https://github.com/TonyRobotics/RoboWare/tree/master/Studio">RoboWare Studio版本</a>，这里以 <code>roboware-studio_1.1.0-1514335284_amd64.deb</code> 为例。</li></ul><pre><code>$ cd ~/下载/$ sudo dpkg -i roboware-studio_1.1.0-1514335284_amd64.deb</code></pre><h2 id="ROS学习资料"><a href="#ROS学习资料" class="headerlink" title="ROS学习资料"></a>ROS学习资料</h2><p>ROS资料相对较少，这里整理一些ROS学习资料，供参考。</p><h3 id="学习网站"><a href="#学习网站" class="headerlink" title="学习网站"></a>学习网站</h3><ul><li>ROS 官方教程：<a href="http://wiki.ros.org/cn">http://wiki.ros.org/cn</a></li><li>古月居：<a href="http://www.guyuehome.com/">http://www.guyuehome.com/</a> </li><li>易科机器人实验室：<a href="http://blog.exbot.net/">http://blog.exbot.net/</a></li><li>创客智造：<a href="https://www.ncnynl.com/">https://www.ncnynl.com/</a></li><li>ROS小课堂：<a href="http://www.corvin.cn/">http://www.corvin.cn/</a></li></ul><h3 id="机器人项目"><a href="#机器人项目" class="headerlink" title="机器人项目"></a>机器人项目</h3><ul><li>Pi Robot：<a href="http://www.pirobot.org/">http://www.pirobot.org</a></li><li>Turtlebot：<a href="https://www.turtlebot.com/">https://www.turtlebot.com/</a></li><li>Turtlebot ROS wiki：<a href="http://wiki.ros.org/Robots/TurtleBot">http://wiki.ros.org/Robots/TurtleBot</a></li><li>Turtlebot3学习：<a href="http://emanual.robotis.com/docs/en/platform/turtlebot3/overview/">http://emanual.robotis.com/docs/en/platform/turtlebot3/overview/</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS入门学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS入门学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo博客：next主题添加友链页面</title>
      <link href="/2019/02/13/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%8F%8B%E9%93%BE%E9%A1%B5%E9%9D%A2/"/>
      <url>/2019/02/13/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%8F%8B%E9%93%BE%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><strong>效果预览：</strong></p><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%20%E5%8F%8B%E4%BA%BA%E5%B8%90/%E5%8F%8B%E4%BA%BA%E5%B8%90.jpg" width="600" hegiht="400" ><a id="more"></a><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul><li>打开<code>/blog/themes/next/languages/zh-CN.yml</code>文档，menu下添加中文友链</li></ul><figure class="highlight yml"><figcaption><span>zh-CN.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line"><span class="string">+</span> <span class="attr">links:</span> <span class="string">友链</span></span><br></pre></td></tr></table></figure><ul><li>修改主题配置文件<code>/blog/themes/next/config.yaml</code></li></ul><figure class="highlight c"><figcaption><span>config.yaml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"># 菜单添加友链页面</span><br><span class="line">menu:</span><br><span class="line">  home: / || home</span><br><span class="line">  <span class="meta">#about: /about/ || user</span></span><br><span class="line">  tags: /tags/ || tags</span><br><span class="line">  categories: /categories/ || th</span><br><span class="line">  archives: /archives/ || archive</span><br><span class="line">  photos: /photos/ || image</span><br><span class="line">+ links: /links/ || leaf</span><br><span class="line">  <span class="meta">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="meta">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="meta">#commonweal: /404/ || heartbeat</span></span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"># 末尾友情链接</span><br><span class="line">mylinks:</span><br><span class="line">  - nickname: XiaoXiaoTao     # 昵称</span><br><span class="line">    avatar: https:<span class="comment">//hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8D%9A%E5%AE%A2%E8%83%8C%E6%99%AF%E5%A4%B4%E5%83%8F/%E5%B0%8F%E5%A5%B3%E5%AD%A9%E5%A4%B4%E5%83%8F.jpg   # 头像地址</span></span><br><span class="line">    site: https:<span class="comment">//xiaoxiaotaoya.github.io/  #友链地址</span></span><br><span class="line">    info: 停止更新的老博客</span><br><span class="line"></span><br><span class="line">  - nickname: 创客智造     # 昵称</span><br><span class="line">    avatar: https:<span class="comment">//www.ncnynl.com/usr/themes/default/img/ckzz.png   # 头像地址</span></span><br><span class="line">    site: https:<span class="comment">//www.ncnynl.com/  #友链地址</span></span><br><span class="line">    info: ROS机器人教程</span><br><span class="line">    </span><br><span class="line">  - nickname: Sanarous     # 昵称</span><br><span class="line">    avatar: https:<span class="comment">//site-1258928558.cos.ap-guangzhou.myqcloud.com/javadoop.png   # 头像地址</span></span><br><span class="line">    site: https:<span class="comment">//bestzuo.cn  #友链地址</span></span><br><span class="line">    info: 码农人生</span><br><span class="line">    </span><br><span class="line">  - nickname: Leaf<span class="number">&#x27;</span>s Blog</span><br><span class="line">    avatar: https:<span class="comment">//www.liaofuzhan.com/images/beichen.png</span></span><br><span class="line">    site: https:<span class="comment">//www.liaofuzhan.com</span></span><br><span class="line">    info: 因心造境，风云由我！</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="新建友链文章和模板页面"><a href="#新建友链文章和模板页面" class="headerlink" title="新建友链文章和模板页面"></a>新建友链文章和模板页面</h2><ul><li>新建相册文章；修改<code>D:/blog/source/links/index.md</code></li></ul><pre><code>$ hexo new page links</code></pre><figure class="highlight c"><figcaption><span>index.md</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 友人帐</span><br><span class="line">date: <span class="number">2020</span><span class="number">-03</span><span class="number">-13</span> <span class="number">09</span>:<span class="number">38</span>:<span class="number">29</span></span><br><span class="line">layout: <span class="string">&quot;links&quot;</span></span><br><span class="line">comments: <span class="literal">false</span></span><br><span class="line">---</span><br></pre></td></tr></table></figure><ul><li>创建友链模板<code>/blog/themes/next/layout/links.swig</code></li></ul><figure class="highlight plain"><figcaption><span>links.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset&#x3D;&#39;utf-8&#39;&gt;</span><br><span class="line">&#123;% extends &#39;_layout.swig&#39; %&#125;</span><br><span class="line">&#123;% import &#39;_macro&#x2F;post-collapse.swig&#39; as post_template with context %&#125;</span><br><span class="line">&#123;% import &#39;_macro&#x2F;sidebar.swig&#39; as sidebar_template with context %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">  &#123;######################&#125;</span><br><span class="line">  &#123;### LINKS BLOCK ###&#125;</span><br><span class="line">  &#123;######################&#125;</span><br><span class="line">  </span><br><span class="line">    &lt;div id&#x3D;&quot;links&quot;&gt;</span><br><span class="line">    &lt;div id&#x3D;&quot;links&quot;&gt;</span><br><span class="line">        &lt;style&gt;</span><br><span class="line">            .links-content&#123;</span><br><span class="line">                margin-top:1rem;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .link-navigation::after &#123;</span><br><span class="line">                content: &quot; &quot;;</span><br><span class="line">                display: block;</span><br><span class="line">                clear: both;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .card &#123;</span><br><span class="line">                width: 35%;</span><br><span class="line">                font-size: 1rem;</span><br><span class="line">                padding: 20px 20px;</span><br><span class="line">                border-radius: 4px;</span><br><span class="line">                transition-duration: 0.15s;</span><br><span class="line">                margin-bottom: 1rem;</span><br><span class="line">                display:flex;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @media(max-width: 1400px)&#123;</span><br><span class="line">                .card&#123;</span><br><span class="line">                    width: 35% !important;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .card:nth-child(odd) &#123;</span><br><span class="line">                float: left;</span><br><span class="line">            &#125;</span><br><span class="line">            .card:nth-child(even) &#123;</span><br><span class="line">                float: right;</span><br><span class="line">            &#125;</span><br><span class="line">            .card:hover &#123;</span><br><span class="line">                transform: scale(1.1);</span><br><span class="line">                box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.12), 0 0 6px 0 rgba(0, 0, 0, 0.04);</span><br><span class="line">            &#125;</span><br><span class="line">            .card a &#123;</span><br><span class="line">                border:none; </span><br><span class="line">            &#125;</span><br><span class="line">            .card .ava &#123;</span><br><span class="line">                width: 3rem!important;</span><br><span class="line">                height: 3rem!important;</span><br><span class="line">                margin:0!important;</span><br><span class="line">                margin-right: 1em!important;</span><br><span class="line">                border-radius:4px;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">            .card .card-header &#123;</span><br><span class="line">                font-style: italic;</span><br><span class="line">                overflow: hidden;</span><br><span class="line">                width: 100%;</span><br><span class="line">            &#125;</span><br><span class="line">            .card .card-header a &#123;</span><br><span class="line">                font-style: normal;</span><br><span class="line">                color: #2bbc8a;</span><br><span class="line">                font-weight: bold;</span><br><span class="line">                text-decoration: none;</span><br><span class="line">            &#125;</span><br><span class="line">            .card .card-header a:hover &#123;</span><br><span class="line">                color: #d480aa;</span><br><span class="line">                text-decoration: none;</span><br><span class="line">            &#125;</span><br><span class="line">            .card .card-header .info &#123;</span><br><span class="line">                font-style:normal;</span><br><span class="line">                color:#a3a3a3;</span><br><span class="line">                font-size:14px;</span><br><span class="line">                min-width: 0;</span><br><span class="line">                overflow: hidden;</span><br><span class="line">                white-space: nowrap;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            span.focus-links &#123;</span><br><span class="line">                font-style: normal;</span><br><span class="line">                margin-left: 10px;</span><br><span class="line">                position: unset;</span><br><span class="line">                left: 0;</span><br><span class="line">                padding: 0 7px 0 5px;</span><br><span class="line">                font-size: 11px;</span><br><span class="line">                border-color: #42c02e;</span><br><span class="line">                border-radius: 40px;</span><br><span class="line">                line-height: 24px;</span><br><span class="line">                height: 22px;</span><br><span class="line">                color: #fff !important;</span><br><span class="line">                background-color: #42c02e;</span><br><span class="line">                display: inline-block;</span><br><span class="line">            &#125;</span><br><span class="line">            span.focus-links:hover&#123;</span><br><span class="line">                background-color: #318024;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .friends-btn&#123;</span><br><span class="line">                text-align: center;</span><br><span class="line">                color: #555!important;</span><br><span class="line">                background-color: #fff;</span><br><span class="line">                border-radius: 3px;</span><br><span class="line">                font-size: 15px;</span><br><span class="line">                box-shadow: inset 0 0 10px 0 rgba(0,0,0,.35);</span><br><span class="line">                border: none!important;</span><br><span class="line">                transition-property: unset;</span><br><span class="line">                padding: 0 15px;</span><br><span class="line">                margin: inherit;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .friends-btn:hover&#123;</span><br><span class="line">                color: rgb(255, 255, 255) !important;</span><br><span class="line">                border-radius: 3px;</span><br><span class="line">                font-size: 15px;</span><br><span class="line">                box-shadow: inset 0px 0px 10px 0px rgba(0, 0, 0, 0.35);</span><br><span class="line">                background-image: linear-gradient(90deg, #a166ab 0%, #ef4e7b 25%, #f37055 50%, #ef4e7b 75%, #a166ab 100%);</span><br><span class="line">                margin: inherit;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &lt;&#x2F;style&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;posts-expand&quot;&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;post-block&quot; lang&#x3D;&quot;&#123;&#123; page.lang or page.language or config.language &#125;&#125;&quot;&gt;</span><br><span class="line">&#123;% include &#39;_partials&#x2F;page&#x2F;page-header.swig&#39; %&#125;</span><br><span class="line">&lt;div class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;links-content&quot;&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;link-navigation&quot;&gt;</span><br><span class="line">&#123;% for link in theme.mylinks %&#125; </span><br><span class="line">&lt;div class&#x3D;&quot;card&quot;&gt;</span><br><span class="line">&lt;img class&#x3D;&quot;ava&quot; src&#x3D;&quot;&#123;&#123; link.avatar &#125;&#125;&quot;&#x2F;&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;card-header&quot;&gt;</span><br><span class="line">&lt;div&gt;&lt;a href&#x3D;&quot;&#123;&#123; link.site &#125;&#125;&quot; target&#x3D;&quot;_blank&quot;&gt; &#123;&#123; link.nickname &#125;&#125;&lt;&#x2F;a&gt; &lt;a href&#x3D;&quot;&#123;&#123; link.site &#125;&#125;&quot;&gt;&lt;span class&#x3D;&quot;focus-links&quot;&gt;+关注&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;info&quot;&gt;&#123;&#123; link.info &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">            &lt;&#x2F;div&gt;</span><br><span class="line">            &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">  &#123;##########################&#125;</span><br><span class="line">  &#123;### END LINKS BLOCK ###&#125;</span><br><span class="line">  &#123;##########################&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block sidebar %&#125;</span><br><span class="line">  &#123;&#123; sidebar_template.render(true) &#125;&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><ul><li>输入命令，查看创建效果</li></ul><pre><code>$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://www.liaofuzhan.com/posts/1123041323.html">hexo博客：添加友链页面</a></li><li><a href="https://bestzuo.cn/posts/2016690040.html">hexo博客next主题自定义友情链接页面</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> hexo博客 </category>
          
          <category> next主题优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo博客 </tag>
            
            <tag> next主题优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo博客：一些好用的Hexo主题和插件</title>
      <link href="/2019/02/11/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9A%E4%B8%80%E4%BA%9B%E5%A5%BD%E7%9C%8B%E7%9A%84Hexo%E4%B8%BB%E9%A2%98/"/>
      <url>/2019/02/11/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9A%E4%B8%80%E4%BA%9B%E5%A5%BD%E7%9C%8B%E7%9A%84Hexo%E4%B8%BB%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>Hexo主题有很多选择，这里列出评价比较高的一些主题。。。</p><a id="more"></a><h2 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h2><h3 id="blog根目录下文件介绍"><a href="#blog根目录下文件介绍" class="headerlink" title="blog根目录下文件介绍"></a>blog根目录下文件介绍</h3><pre><code>.├── _config.yml 网站的配置文件├── package.json 应用程序信息├── node_modules 依赖包├── scaffolds 文章模板文件夹├── public 存放生成的页面├── source 存放用户资源|   └── posts 存放文章部分└── themes 主题文件夹，Hexo会根据主题来生成静态页面。</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E5%8D%9A%E5%AE%A2%E6%A0%B9%E7%9B%AE%E5%BD%95.jfif" width="600" hegiht="400" >（图）博客根目录下</center><h3 id="config-yml配置文件"><a href="#config-yml配置文件" class="headerlink" title="_config.yml配置文件"></a>_config.yml配置文件</h3><p>_config.yml配置文件有两个：</p><ul><li>站点配置文件：blog根目录下_config.yml</li><li>主题配置文件：主题目录下_config.yml</li></ul><h2 id="主题选择"><a href="#主题选择" class="headerlink" title="主题选择"></a>主题选择</h2><p>参考 <a href="https://hexo.io/themes/">Hexo主题</a>官网，列出评价比较高的一些主题：</p><p><a href="https://github.com/theme-next/hexo-theme-next">NexT</a></p><p>&emsp;&emsp; <a href="https://theme-next.org/">Demo</a> || <a href="http://theme-next.iissnan.com/">配置文档</a></p><p><a href="https://github.com/litten/hexo-theme-yilia">Yilia</a></p><p>&emsp;&emsp; <a href="http://litten.me/">Demo</a> || <a href="https://github.com/litten/hexo-theme-yilia/blob/master/README.md">配置文档</a></p><p><a href="https://github.com/yscoder/hexo-theme-indigo">Indigo</a><br>&emsp;&emsp; <a href="https://yscoder.github.io/">Demo</a> || <a href="https://github.com/yscoder/hexo-theme-indigo/wiki">配置文档</a></p><p><a href="https://github.com/blinkfox/hexo-theme-matery">Matery</a><br>&emsp;&emsp; <a href="https://blinkfox.github.io/">Demo</a> || <a href="https://github.com/blinkfox/hexo-theme-matery/blob/develop/README_CN.md">配置文档</a></p><p><a href="https://github.com/xaoxuu/hexo-theme-material-x">Material-X</a><br>&emsp;&emsp; <a href="https://mxclub.github.io/">Demo</a> || <a href="https://xaoxuu.com/wiki/material-x/">配置文档</a></p><p><a href="https://github.com/tufu9441/maupassant-hexo">Maupassant</a><br>&emsp;&emsp; <a href="https://www.haomwei.com/">Demo</a> || <a href="https://www.haomwei.com/technology/maupassant-hexo.html">配置文档</a></p><p><a href="https://github.com/Molunerfinn/hexo-theme-melody">melody</a><br>&emsp;&emsp; <a href="https://molunerfinn.com/">Demo</a> </p><p><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a><br>&emsp;&emsp; <a href="https://demo.jerryc.me/">Demo</a></p><h2 id="插件选择"><a href="#插件选择" class="headerlink" title="插件选择"></a>插件选择</h2><h3 id="博客文章加密插件-encrypt"><a href="#博客文章加密插件-encrypt" class="headerlink" title="博客文章加密插件 encrypt"></a>博客文章加密插件 encrypt</h3><p><strong>github:</strong> <a href="https://github.com/MikeCoder/hexo-blog-encrypt">https://github.com/MikeCoder/hexo-blog-encrypt</a></p><ul><li>在博客根目录下打开Git终端：</li></ul><pre><code>$ npm install --save hexo-blog-encrypt</code></pre><ul><li>在站点配置文件config.yaml启用插件：</li></ul><figure class="highlight c"><figcaption><span>config.yaml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Security</span><br><span class="line">## 文章加密 hexo-blog-encrypt</span><br><span class="line">encrypt:</span><br><span class="line">    enable: <span class="literal">true</span></span><br></pre></td></tr></table></figure><ul><li>在博客文章头部添加密码，例如：</li></ul><pre><code>---title: hexo博客：一些好用的Hexo主题和插件date: 2019/2/11 16:50:24   categories: - hexo博客tags: [hexo博客]password: 3063abstract: 有东西被加密了, 请输入密码查看.message: 您好, 这里需要密码.wrong_pass_message: 抱歉, 这个密码看着不太对, 请再试试.---</code></pre><p>password: 是该博客加密使用的密码<br>abstract: 是该博客的摘要，会显示在博客的列表页<br>message: 这个是博客查看时，密码输入框上面的描述性文字</p><h3 id="音乐播放插件-Aplayer"><a href="#音乐播放插件-Aplayer" class="headerlink" title="音乐播放插件 Aplayer"></a>音乐播放插件 Aplayer</h3><p><strong>github:</strong> <a href="https://github.com/MoePlayer/hexo-tag-aplayer">https://github.com/MoePlayer/hexo-tag-aplayer</a></p><p><strong>特点：</strong></p><blockquote><p>APlayer 播放器的 Hexo 标签插件（现已支持 MetingJS）<br>MetingJS 是基于Meting API 的 APlayer 衍生播放器，引入 MetingJS 后，播放器将支持对于 QQ音乐、网易云音乐、虾米、酷狗、百度等平台的音乐播放。</p></blockquote><ul><li>在博客根目录下打开Git终端：</li></ul><pre><code>$ npm install –save hexo-tag-aplayer</code></pre><ul><li>在站点配置文件config.yaml启用插件：</li></ul><figure class="highlight c"><figcaption><span>config.yaml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 音乐播放器 hexo-tag-aplayer</span><br><span class="line">aplayer:</span><br><span class="line">meting: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>在文章任意部分添加播放器，如网易云音乐 <a href="https://music.163.com/#/song?id=455359884">https://music.163.com/#/song?id=455359884</a></p><pre><code>&#123;% meting "455359884" "netease" "song" "theme:#555" "mutex:true" "listmaxheight:340px" "preload:auto" %&#125;</code></pre><p>效果</p>    <div id="aplayer-zegNTBsq" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="455359884" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#555"    ></div>]]></content>
      
      
      <categories>
          
          <category> hexo博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo博客 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo博客：next主题搭建二级分类相册</title>
      <link href="/2019/02/10/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9Anext%E4%B8%BB%E9%A2%98%E6%90%AD%E5%BB%BA%E4%BA%8C%E7%BA%A7%E5%88%86%E7%B1%BB%E7%9B%B8%E5%86%8C/"/>
      <url>/2019/02/10/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9Anext%E4%B8%BB%E9%A2%98%E6%90%AD%E5%BB%BA%E4%BA%8C%E7%BA%A7%E5%88%86%E7%B1%BB%E7%9B%B8%E5%86%8C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;今天突然想给博客搭建相册，浏览了不少关于hexo搭建相册教程，发现很多下面这样子的，还是很漂亮的。自己尝试了一番，相册需要缩略图和原图两个文件夹，其中缩略图都是裁剪好后的正方形，感觉不是自己想要的。</p><p><a href="http://www.lawlite.me/photos/">http://www.lawlite.me/photos/</a></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%E6%B7%BB%E5%8A%A0%E7%9B%B8%E5%86%8C/%E4%B8%8D%E5%B8%A6%E5%88%86%E7%B1%BB%E7%9A%84%E7%9B%B8%E5%86%8C.jpg" width="600" hegiht="400" >（图）不带分类的相册 </center><p>&emsp;&emsp;后来发现<a href="https://me.idealli.com/post/73ad4183.html">给hexo静态博客添加动态相册功能</a>和<a href="https://liyangzone.com/2019/07/22/hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E4%B8%80%E7%BA%A7%E5%88%86%E7%B1%BB%E7%9B%B8%E5%86%8C/">hexo博客添加一级分类相册功能</a>两位大佬的博客相册为两级结构，不用一下子加载整个网页的图片，很喜欢这种布局。于是花费两天时间，参考<a href="https://houmin.cc/posts/d487dd02/">Hexo NexT主题添加多级相册功能</a>，搭建了属于自己的相册。</p><div class="tabs" id="相册"><ul class="nav-tabs"><li class="tab active"><a href="#相册-1">一级相册</a></li><li class="tab"><a href="#相册-2">二级相册</a></li></ul><div class="tab-content"><div class="tab-pane active" id="相册-1"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%E6%B7%BB%E5%8A%A0%E7%9B%B8%E5%86%8C/%E4%B8%80%E7%BA%A7%E7%9B%B8%E5%86%8C.jpg" width="600" hegiht="400" ></div><div class="tab-pane" id="相册-2"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%E6%B7%BB%E5%8A%A0%E7%9B%B8%E5%86%8C/%E4%BA%8C%E7%BA%A7%E7%9B%B8%E5%86%8C.jpg" width="600" hegiht="400" ></div></div></div><a id="more"></a><h2 id="整体结构"><a href="#整体结构" class="headerlink" title="整体结构"></a>整体结构</h2><p>&emsp;&emsp;本文相册是根据腾讯COS实现的，先创建相册一级目录和相册模板，    运行编写好的blog_cos.py文件，自动将下载的图片数据存放到galleries.yaml文件中，并根据腾讯COS相册文件结构创建对应的的二级相册目录。</p><pre><code>- /blog/source_data/galleries.yaml  存放所有图片数据- /blog/source/photos    相册一级目录    - /blog/source/photos/index.md        相册一级目录对应的index.md    - /blog/source/photos/WLOP            相册二级目录    - /blog/source/photos/尼尔机械纪元    相册二级目录    - ...    - /blog/source/photos/blog_cos.py    从腾讯COS下载图片数据并创建相册二级目录- /blog/themes/next/layout/photos.swig    一级相册模板- /blog/themes/next/layout/photo.swig    二级相册模板</code></pre><div class="note info">            <p>腾讯COS相册存储为两级结构，如我的腾讯COS在galleries文件夹下创建WLOP、尼尔机械纪元、大学生活等子文件夹。</p>          </div><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul><li>打开<code>/blog/themes/next/languages/zh-CN.yml</code>文档，menu下添加中文相册</li></ul><figure class="highlight yml"><figcaption><span>zh-CN.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">photos:</span> <span class="string">相册</span></span><br></pre></td></tr></table></figure><ul><li>修改主题配置文件<code>/blog/themes/next/config.yaml</code></li></ul><figure class="highlight c"><figcaption><span>config.yaml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># 添加相册css风格,如果已有则不需要创建</span><br><span class="line"># Define custom file paths.</span><br><span class="line"># Create your custom files in site directory `source/_data` <span class="keyword">and</span> uncomment needed files below.</span><br><span class="line">custom_file_path:</span><br><span class="line">  head: source/_data/head.swig</span><br><span class="line">  <span class="meta">#header: source/_data/header.swig</span></span><br><span class="line">  sidebar: source/_data/sidebar.swig</span><br><span class="line">  #postMeta: source/_data/post-meta.swig</span><br><span class="line">  #postBodyEnd: source/_data/post-body-end.swig</span><br><span class="line">  <span class="meta">#footer: source/_data/footer.swig</span></span><br><span class="line">  #bodyEnd: source/_data/body-end.swig</span><br><span class="line">  <span class="meta">#variable: source/_data/variables.styl</span></span><br><span class="line">  <span class="meta">#mixin: source/_data/mixins.styl</span></span><br><span class="line">  style: source/_data/styles.styl</span><br><span class="line"></span><br><span class="line"># 腾讯COS相册链接</span><br><span class="line">photos_info:</span><br><span class="line">  cos_url: https:<span class="comment">//hexo-1257031621.cos.ap-chengdu.myqcloud.com/galleries/</span></span><br><span class="line"></span><br><span class="line"># 添加相册</span><br><span class="line">menu:</span><br><span class="line">  home: / || home</span><br><span class="line">  <span class="meta">#about: /about/ || user</span></span><br><span class="line">  tags: /tags/ || tags</span><br><span class="line">  categories: /categories/ || th</span><br><span class="line">  archives: /archives/ || archive</span><br><span class="line">  photos: /photos/ || image</span><br><span class="line">  <span class="meta">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="meta">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="meta">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure><ul><li>在<code>source/_data/styles.styl</code>文件末尾添加相册css风格</li></ul><figure class="highlight styl"><figcaption><span>styles.styl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//相册风格</span></span><br><span class="line">.gallery-wrapper&#123;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">5%</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.gallery-wrapper</span> .gallery-box&#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span> !important;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.gallery-box&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">30%</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: auto;</span><br><span class="line">  <span class="attribute">left</span>: auto;</span><br><span class="line">  <span class="attribute">right</span>: auto;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.gallery-wrapper</span> <span class="selector-class">.gallery-item</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  -moz-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> <span class="number">0</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.22</span>);</span><br><span class="line">  -webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> <span class="number">0</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.22</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> <span class="number">0</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.22</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.gallery-cover-box&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">60%</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">background</span>: center center no-repeat;</span><br><span class="line">  -webkit-<span class="attribute">background-size</span>: cover;</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.gallery-cover-box</span> <span class="selector-class">.gallery-cover-img</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: translate(-<span class="number">50%</span>,-<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.gallery-item</span> .gallery-name&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.waterfall</span> &#123;</span><br><span class="line">  <span class="attribute">column-count</span>: <span class="number">4</span>;</span><br><span class="line">  <span class="attribute">column-gap</span>: <span class="number">1em</span>;</span><br><span class="line">&#125;</span><br><span class="line">.photo-wrapper&#123;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.photo-item</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0</span>;</span><br><span class="line">  -moz-<span class="attribute">page-break-inside</span>: avoid;</span><br><span class="line">  -webkit-column-<span class="attribute">break-inside</span>: avoid;</span><br><span class="line">  <span class="attribute">break-inside</span>: avoid;</span><br><span class="line">  <span class="attribute">background</span>: white;</span><br><span class="line">  -moz-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> <span class="number">0</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.22</span>);</span><br><span class="line">  -webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> <span class="number">0</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.22</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> <span class="number">0</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.22</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.photo-item</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.photo-item</span> .photo-name&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#dddddd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.gallery-header&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">25px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">35px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.95</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*适配移动端布局*/</span></span><br><span class="line">@media only screen and (<span class="attribute">max-width</span>: <span class="number">601px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.waterfall</span> &#123;</span><br><span class="line">    <span class="attribute">column-count</span>: <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">column-gap</span>: <span class="number">1em</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="建立相册目录和模板"><a href="#建立相册目录和模板" class="headerlink" title="建立相册目录和模板"></a>建立相册目录和模板</h2><ul><li>创建相册目录<code>/blog/source/photos</code></li></ul><pre><code>$ hexo new page photos</code></pre><figure class="highlight c"><figcaption><span>index.md</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: photos</span><br><span class="line">date: <span class="number">2020</span><span class="number">-03</span><span class="number">-01</span> <span class="number">22</span>:<span class="number">43</span>:<span class="number">35</span></span><br><span class="line">layout: <span class="string">&quot;photos&quot;</span></span><br><span class="line">comments: <span class="literal">false</span></span><br><span class="line">---</span><br></pre></td></tr></table></figure><ul><li>创建一级相册模板<code>/blog/themes/next/layout/photos.swig</code></li></ul><figure class="highlight c"><figcaption><span>photos.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;_layout.swig&#x27; %&#125;</span><br><span class="line">&#123;% import &#x27;_macro/post-collapse.swig&#x27; as post_template with context %&#125;</span><br><span class="line">&#123;% import &#x27;_macro/sidebar.swig&#x27; as sidebar_template with context %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">posts</span>-<span class="title">expand</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;div class=&quot;gallery-header&quot; lang=&quot;&#123;&#123; page.lang or page.language or config.language &#125;&#125;&quot;&gt;</span></span><br><span class="line">            &#123;% include &#x27;_partials/page/page-header.swig&#x27; %&#125;</span><br><span class="line">&lt;/div&gt; </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">gallery</span>-<span class="title">wrapper</span>&quot;&gt;</span></span><br><span class="line"><span class="class">&#123;</span>% <span class="keyword">for</span> galleries in site.data.galleries %&#125;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">gallery</span>-<span class="title">box</span>&quot;&gt;</span></span><br><span class="line"><span class="class">&lt;a href=&quot;./&#123;&#123; galleries.name &#125;&#125;&quot; class=&quot;gallery-item&quot; data-aos=&quot;zoom-in-up&quot;&gt;</span></span><br><span class="line"><span class="class">&lt;div class=&quot;gallery-cover-box&quot; style=&quot;background-image: url(&#123;&#123;theme.photos_info.cos_url&#125;&#125;/&#123;&#123; galleries.name &#125;&#125;/&#123;&#123; galleries.cover &#125;&#125;)&quot;&gt;</span></span><br><span class="line"><span class="class">&lt;/div&gt;</span></span><br><span class="line"><span class="class">&lt;p class=&quot;gallery-name&quot;&gt;</span></span><br><span class="line"><span class="class">&#123;</span>&#123; galleries.name &#125;&#125;</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block sidebar %&#125;</span><br><span class="line">  &#123;&#123; sidebar_template.render(<span class="literal">true</span>) &#125;&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><ul><li>创建二级相册模板<code>/blog/themes/next/layout/photo.swig</code></li></ul><figure class="highlight"><figcaption><span>photo.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset=&#x27;utf-8&#x27;&gt;</span><br><span class="line">&lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;/css/gallery.css&quot;</span>&gt;</span><br><span class="line">&lt;link rel=<span class="string">&quot;stylesheet&quot;</span> type=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;https://cdn.jsdelivr.net/npm/fancybox@3.0.1/dist/css/jquery.fancybox.css&quot;</span>&gt;</span><br><span class="line">&lt;link rel=<span class="string">&quot;stylesheet&quot;</span> type=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&#123;% extends &#x27;_layout.swig&#x27; %&#125;</span><br><span class="line">&#123;% import &#x27;_macro/post-collapse.swig&#x27; as post_template with context %&#125;</span><br><span class="line">&#123;% import &#x27;_macro/sidebar.swig&#x27; as sidebar_template with context %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">posts</span>-<span class="title">expand</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;div class=&quot;post-block&quot; lang=&quot;&#123;&#123; page.lang or page.language or config.language &#125;&#125;&quot;&gt;</span></span><br><span class="line">            &#123;% include &#x27;_partials/page/page-header.swig&#x27; %&#125;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">container</span>&quot;&gt;</span></span><br><span class="line"><span class="class">&lt;div class=&quot;photo-wrapper&quot;&gt;</span></span><br><span class="line"><span class="class">&lt;div class=&quot;waterfall&quot; id=&quot;mygallery&quot;&gt;</span></span><br><span class="line">&#123;% for i in range(site.data.galleries.length) %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> site.data.galleries[i].name == page.title %&#125;</span><br><span class="line">&#123;% <span class="keyword">for</span> photo in site.data.galleries[i].photos  %&#125;</span><br><span class="line">&lt;a class=<span class="string">&quot;photo-item&quot;</span> rel=<span class="string">&quot;example_group&quot;</span> data-fancybox=<span class="string">&quot;images&quot;</span> href=<span class="string">&quot;&#123;&#123;theme.photos_info.cos_url&#125;&#125;/&#123;&#123;page.title&#125;&#125;/&#123;&#123;photo&#125;&#125;&quot;</span> &gt;&lt;img alt=<span class="string">&quot;&#123;&#123;photo&#125;&#125;&quot;</span> src=<span class="string">&quot;&#123;&#123;theme.photos_info.cos_url&#125;&#125;/&#123;&#123;page.title&#125;&#125;/&#123;&#123;photo&#125;&#125;&quot;</span> /&gt; &lt;/a&gt;</span><br><span class="line">&#123;%- endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;%- endfor %&#125;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block sidebar %&#125;</span><br><span class="line">  &#123;&#123; sidebar_template.render(<span class="literal">true</span>) &#125;&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script src=<span class="string">&quot;https://cdn.jsdelivr.net/npm/fancybox@3.0.1/dist/js/jquery.fancybox.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">  $(<span class="string">&quot;a[rel=example_group]&quot;</span>).fancybox();</span><br><span class="line">  $(<span class="string">&quot;#mygallery&quot;</span>).justifiedGallery(&#123;margins: <span class="number">5</span>, rowHeight: <span class="number">100</span>&#125;);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="下载图片数据并创建相应二级相册目录"><a href="#下载图片数据并创建相应二级相册目录" class="headerlink" title="下载图片数据并创建相应二级相册目录"></a>下载图片数据并创建相应二级相册目录</h2><p>&emsp;&emsp;首先在腾讯COS创建两级相册目录，并上传图片。再运行<code>/blog/source/photos/blog_cos.py</code>文件，会自动将下载的图片数据存放到 galleries.yaml 文件中，并根据腾讯COS相册文件结构创建对应的的二级相册目录。</p><figure class="highlight python"><figcaption><span>blog_cos.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> qcloud_cos <span class="keyword">import</span> CosConfig</span><br><span class="line"><span class="keyword">from</span> qcloud_cos <span class="keyword">import</span> CosS3Client</span><br><span class="line"><span class="keyword">from</span> qcloud_cos <span class="keyword">import</span> CosServiceError</span><br><span class="line"><span class="keyword">from</span> qcloud_cos <span class="keyword">import</span> CosClientError</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line"><span class="comment"># 腾讯云COSV5Python SDK, 目前可以支持Python2.6与Python2.7以及Python3.x</span></span><br><span class="line"><span class="comment"># pip安装指南:pip install -U cos-python-sdk-v5</span></span><br><span class="line"><span class="comment"># cos最新可用地域,参照https://www.qcloud.com/document/product/436/6224</span></span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.INFO, stream=sys.stdout)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置用户属性, 包括secret_id, secret_key, region</span></span><br><span class="line"><span class="comment"># appid已在配置中移除,请在参数Bucket中带上appid。Bucket由bucketname-appid组成</span></span><br><span class="line">secret_id = <span class="string">&#x27;*******************&#x27;</span>     <span class="comment"># 替换为用户的secret_id</span></span><br><span class="line">secret_key = <span class="string">&#x27;*******************&#x27;</span>     <span class="comment"># 替换为用户的secret_key</span></span><br><span class="line">region = <span class="string">&#x27;ap-chengdu&#x27;</span>    <span class="comment"># 替换为用户的region</span></span><br><span class="line">token = <span class="literal">None</span>               <span class="comment"># 使用临时密钥需要传入Token，默认为空,可不填</span></span><br><span class="line">config = CosConfig(Region=region, SecretId=secret_id, SecretKey=secret_key, Token=token)  <span class="comment"># 获取配置对象</span></span><br><span class="line">client = CosS3Client(config)</span><br><span class="line">print(<span class="string">&quot;已连接腾讯COS&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">galleries = []</span><br><span class="line">json_name = <span class="string">&quot;galleries.yaml&quot;</span>    <span class="comment"># 图片数据文件名称</span></span><br><span class="line">bucket_name = <span class="string">&quot;hexo-1257031621&quot;</span>      <span class="comment"># 腾讯COS存储桶名称</span></span><br><span class="line">photos_name = <span class="string">&quot;galleries/&quot;</span>      <span class="comment"># 腾讯COS一级相册目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># json文件保存路径 例：D://blog/source/_data/galleries.json</span></span><br><span class="line">cwd = os.getcwd().replace(<span class="string">&quot;photos&quot;</span>, <span class="string">&quot;_data&quot;</span>)</span><br><span class="line">json_cwd = os.path.join(cwd, json_name).replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).replace(<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;:/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 json 文件是否已存在</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">json_file_exists</span>():</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(json_cwd):</span><br><span class="line">        os.remove(json_cwd)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取相册数据信息</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_galleries_data</span>():</span></span><br><span class="line">    <span class="keyword">global</span> galleries_name</span><br><span class="line">    galleries_name = []</span><br><span class="line">    <span class="comment"># 查询相册目录下所有内容</span></span><br><span class="line">    response = client.list_objects(</span><br><span class="line">        Bucket= bucket_name,</span><br><span class="line">        Prefix= photos_name,</span><br><span class="line">        Delimiter=<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    )</span><br><span class="line">    CommonPrefixes = response[<span class="string">&#x27;CommonPrefixes&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> Prefixes <span class="keyword">in</span> CommonPrefixes:</span><br><span class="line">        Prefix = Prefixes[<span class="string">&#x27;Prefix&#x27;</span>]</span><br><span class="line">        gallery_name = Prefix.split(<span class="string">&quot;/&quot;</span>)[<span class="number">1</span>]</span><br><span class="line">        galleries_name.append(gallery_name)</span><br><span class="line">        <span class="comment"># 查询相册目录下所有子文件夹内容</span></span><br><span class="line">        response = client.list_objects(</span><br><span class="line">            Bucket= bucket_name,</span><br><span class="line">            Prefix= photos_name + gallery_name + <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">            Delimiter=<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">        )</span><br><span class="line">        contents = response[<span class="string">&#x27;Contents&#x27;</span>]</span><br><span class="line">        <span class="comment"># 子文件夹所有照片添加到 photos_list 列表</span></span><br><span class="line">        photos_list = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(contents)):</span><br><span class="line">            content = contents[i][<span class="string">&#x27;Key&#x27;</span>].split(<span class="string">&quot;/&quot;</span>)[<span class="number">2</span>]</span><br><span class="line">            photos_list.append(content)</span><br><span class="line">        <span class="keyword">del</span> photos_list[<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># 相册添加到 gallery_dict 字典中</span></span><br><span class="line">        gallery_dict = dict(name=<span class="number">1</span>, cover=<span class="number">1</span>, description=<span class="number">1</span>, photos=<span class="number">1</span>)</span><br><span class="line">        gallery_dict.update(name = gallery_name)</span><br><span class="line">        gallery_dict.update(cover = photos_list[<span class="number">0</span>])</span><br><span class="line">        gallery_dict.update(photos = photos_list[<span class="number">0</span>:])</span><br><span class="line">        photos_list.clear()</span><br><span class="line">        <span class="comment"># 所有相册添加到 galleries 列表中</span></span><br><span class="line">        galleries.append(gallery_dict)</span><br><span class="line">    print(<span class="string">&quot;生成相册数据完成&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据写入</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">galleries_data_write</span>():</span></span><br><span class="line">    <span class="keyword">with</span> open(json_cwd, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="comment"># 修整数据格式</span></span><br><span class="line">        data0 = str(galleries).replace(<span class="string">&quot;&#125;, &#123;&quot;</span> , <span class="string">&quot;&#125;,\n &#123;&quot;</span>)</span><br><span class="line">        data1 = data0.replace(<span class="string">&quot;[&#123;&quot;</span>, <span class="string">&quot;[\n &#123;&quot;</span>)</span><br><span class="line">        data = data1.replace(<span class="string">&quot;&#125;]&quot;</span>, <span class="string">&quot;&#125;\n]&quot;</span>)</span><br><span class="line">        file.write(data)</span><br><span class="line">        print(<span class="string">&quot;数据写入完成&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建文件夹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mkdir_galleries</span>(<span class="params">file</span>):</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(file):</span><br><span class="line">        shutil.rmtree(file)</span><br><span class="line">    os.mkdir(file)</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 创建二级相册目录和对应的index.md文件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">galleries_index</span>():</span></span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> galleries_name:</span><br><span class="line">        gallery_index_dict= dict(title = name, layout = <span class="string">&#x27;photo&#x27;</span>, comments = <span class="string">&quot;false&quot;</span>)</span><br><span class="line">        mkdir_galleries(name)</span><br><span class="line">        gallery_index_cwd = os.path.join(os.getcwd(), name , <span class="string">&quot;index.md&quot;</span>).replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).replace(<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;:/&#x27;</span>)</span><br><span class="line">        <span class="keyword">with</span> open(gallery_index_cwd, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            data0 = str(gallery_index_dict)</span><br><span class="line">            data1 = data0.replace(<span class="string">&quot;&#123;&quot;</span>, <span class="string">&quot;---\n&quot;</span>).replace(<span class="string">&quot;,&quot;</span>,<span class="string">&quot;\n&quot;</span>).replace(<span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;\n---&quot;</span>)</span><br><span class="line">            data = data1.replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;photo&quot;</span>,<span class="string">&#x27;&#x27;&#x27;&quot;photo&quot;&#x27;&#x27;&#x27;</span>).replace(<span class="string">&quot; layout&quot;</span>,<span class="string">&quot;layout&quot;</span>).replace(<span class="string">&quot; comments&quot;</span>,<span class="string">&quot;comments&quot;</span>)</span><br><span class="line">            file.write(data)</span><br><span class="line">    print(<span class="string">&quot;index数据写入完成&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    json_file_exists()      <span class="comment"># 查看 json 文件是否已存在</span></span><br><span class="line">    get_galleries_data()    <span class="comment"># 获取相册数据信息</span></span><br><span class="line">    galleries_data_write()    <span class="comment"># 图像数据写入</span></span><br><span class="line">    galleries_index()         <span class="comment"># 创建二级相册目录和对应的index.md文件</span></span><br></pre></td></tr></table></figure><div class="note warning">            <ol><li>blog_cos.py必须放在<code>/blog/source/photos/</code>文件夹下。</li><li>运行blog_cos.py前需要安装 <code>pip install -U cos-python-sdk-v5</code></li><li>设置用户属性, 包括secret_id, secret_key, region</li><li>可修改腾讯COS存储桶名称bucket_name、腾讯COS一级相册目录photos_name、图片数据文件名称json_name</li></ol>          </div><h2 id="腾讯COS跨域访问cors设置"><a href="#腾讯COS跨域访问cors设置" class="headerlink" title="腾讯COS跨域访问cors设置"></a>腾讯COS跨域访问cors设置</h2><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">1.找到存储桶</a></li><li class="tab"><a href="#tab标签列表-2">2.找到cors设置</a></li><li class="tab"><a href="#tab标签列表-3">3.修改cors规则</a></li><li class="tab"><a href="#tab标签列表-4">4.修改访问权限</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%E6%B7%BB%E5%8A%A0%E7%9B%B8%E5%86%8C/%E6%89%BE%E5%88%B0%E5%AD%98%E5%82%A8%E6%A1%B6.jpg" width="600" hegiht="400" ></div><div class="tab-pane" id="tab标签列表-2"><p>   在基础配置中找到cors设置<br><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%E6%B7%BB%E5%8A%A0%E7%9B%B8%E5%86%8C/%E6%89%BE%E5%88%B0cors%E8%AE%BE%E7%BD%AE.jpg" width="600" hegiht="400" ></p></div><div class="tab-pane" id="tab标签列表-3"><p>   操作选择GET，其他默认都填成*，如下图：<br><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%E6%B7%BB%E5%8A%A0%E7%9B%B8%E5%86%8C/%E4%BF%AE%E6%94%B9cors%E8%A7%84%E5%88%99.jpg" width="600" hegiht="400" ></p></div><div class="tab-pane" id="tab标签列表-4"><p>   一般情况下默认是共有读私有写，policy权限就不要设置了<br><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%E6%B7%BB%E5%8A%A0%E7%9B%B8%E5%86%8C/%E8%AF%BB%E5%86%99%E6%9D%83%E9%99%90.png" width="600" hegiht="400" ></p></div></div></div>]]></content>
      
      
      <categories>
          
          <category> hexo博客 </category>
          
          <category> next主题优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo博客 </tag>
            
            <tag> next主题优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo博客：next主题优化</title>
      <link href="/2019/02/08/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9Anext%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96/"/>
      <url>/2019/02/08/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9Anext%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>next主题：<a href="https://github.com/theme-next/hexo-theme-next">https://github.com/theme-next/hexo-theme-next</a></p><p>博客根目录下安装：</p><pre><code>## 本地搜索插件$ npm install hexo-generator-searchdb --save</code></pre><p>主题根目录下安装：</p><pre><code>## 图片弹出效果$ git clone https://github.com/theme-next/theme-next-fancybox3 source/lib/fancybox## 顶部加载条$ git clone https://github.com/theme-next/theme-next-pace source/lib/pace</code></pre><a id="more"></a><h2 id="前提准备"><a href="#前提准备" class="headerlink" title="前提准备"></a>前提准备</h2><ul><li>参考主题配置文件<code>config.yml</code>，</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define custom file paths.</span></span><br><span class="line"><span class="comment"># Create your custom files in site directory `source/_data` and uncomment needed files below.</span></span><br><span class="line"><span class="attr">custom_file_path:</span></span><br><span class="line">  <span class="comment">#head: source/_data/head.swig</span></span><br><span class="line">  <span class="comment">#header: source/_data/header.swig</span></span><br><span class="line">  <span class="comment">#sidebar: source/_data/sidebar.swig</span></span><br><span class="line">  <span class="comment">#postMeta: source/_data/post-meta.swig</span></span><br><span class="line">  <span class="comment">#postBodyEnd: source/_data/post-body-end.swig</span></span><br><span class="line">  <span class="comment">#footer: source/_data/footer.swig</span></span><br><span class="line">  <span class="comment">#bodyEnd: source/_data/body-end.swig</span></span><br><span class="line">  <span class="comment">#variable: source/_data/variables.styl</span></span><br><span class="line">  <span class="comment">#mixin: source/_data/mixins.styl</span></span><br><span class="line">  <span class="comment">#style: source/_data/styles.styl</span></span><br></pre></td></tr></table></figure><ul><li>根据需要，创建对应文件，并在主题配置文件<code>config.yml</code>去掉注释。</li></ul><h2 id="头像效果设置"><a href="#头像效果设置" class="headerlink" title="头像效果设置"></a>头像效果设置</h2><h3 id="修改头像样式（默认方形）"><a href="#修改头像样式（默认方形）" class="headerlink" title="修改头像样式（默认方形）"></a>修改头像样式（默认方形）</h3><ul><li>打开主题配置文件<code>config.yml</code>，设置头像url或圆形头像旋转效果</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sidebar Avatar</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="comment"># Replace the default image and set the url here.</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/next/0001.jpg</span> <span class="comment">#/images/avatar.gif</span></span><br><span class="line">  <span class="comment"># If true, the avatar would be dispalyed in circle.</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># If true, the avatar would be rotated with the cursor.</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="设置头像动态特效"><a href="#设置头像动态特效" class="headerlink" title="设置头像动态特效"></a>设置头像动态特效</h3><ul><li>头像动态效果可在 <a href="https://daneden.github.io/animate.css/">https://daneden.github.io/animate.css/</a> 选择css样式：</li></ul><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%20%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96/animate_jello.JPG" width="400" hegiht="300" >（图）animate_jello样式 </center><ul><li>打开<code>source/_data/head.swig</code>，末尾添加以下内容：</li></ul><figure class="highlight plain"><figcaption><span>head.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link href&#x3D;&quot;&#x2F;&#x2F;cdn.bootcss.com&#x2F;animate.css&#x2F;3.5.0&#x2F;animate.min.css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;</span><br></pre></td></tr></table></figure><p>－　打开<code>source/_data/styles.styl</code>，添加以下内容：</p><figure class="highlight"><figcaption><span>styles.styl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 头像动态效果</span></span><br><span class="line"><span class="selector-class">.site-author-image</span>:hover &#123;</span><br><span class="line">  -webkit-<span class="attribute">animation</span>: jello <span class="number">1s</span>;</span><br><span class="line">  <span class="attribute">animation</span>: jello <span class="number">1s</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="点击头像跳转到首页"><a href="#点击头像跳转到首页" class="headerlink" title="点击头像跳转到首页"></a>点击头像跳转到首页</h3><ul><li>修改<code>themes\next\layout\_partials\sidebar\site-overview.swig</code>文件</li></ul><figure class="highlight plain"><figcaption><span>site-overview.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;&#x2F;&quot; &gt;&lt;img class&#x3D;&quot;site-author-image&quot; itemprop&#x3D;&quot;image&quot; alt&#x3D;&quot;&#123;&#123; author &#125;&#125;&quot;</span><br><span class="line">  src&#x3D;&quot;&#123;&#123; url_for(theme.avatar.url or theme.images + &#39;&#x2F;avatar.gif&#39;) &#125;&#125;&quot;&gt;&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure><h2 id="添加站内搜索"><a href="#添加站内搜索" class="headerlink" title="添加站内搜索"></a>添加站内搜索</h2><ul><li>Next集成了站内搜索功能，博客根目录下安装：</li></ul><pre><code>$ npm install hexo-generator-searchdb --save</code></pre><ul><li>打开主题配置文件<code>config.yml</code></li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Local Search</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/hexo-generator-searchdb</span></span><br><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If auto, trigger search by changing input.</span></span><br><span class="line">  <span class="comment"># If manual, trigger search by pressing enter key or search button.</span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span></span><br><span class="line">  <span class="comment"># Show top n results per article, show all results by setting to -1</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># Unescape html strings to the readable one.</span></span><br><span class="line">  <span class="attr">unescape:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Preload the search data when the page loads.</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/next%20%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96/%E6%9C%AC%E5%9C%B0%E6%90%9C%E7%B4%A2.JPG" width="600" hegiht="400" >（图）站内搜索 </center><h2 id="图片弹出效果"><a href="#图片弹出效果" class="headerlink" title="图片弹出效果"></a>图片弹出效果</h2><p>参考 <a href="https://github.com/theme-next/theme-next-fancybox3">https://github.com/theme-next/theme-next-fancybox3</a></p><ul><li>进入next主题目录下，安装 <code>theme-next-fancybox3</code></li></ul><pre><code>$ git clone https://github.com/theme-next/theme-next-fancybox3 source/lib/fancybox</code></pre><ul><li>打开主题配置文件<code>config.yml</code></li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># FancyBox is a tool that offers a nice and elegant way to add zooming functionality for images.</span></span><br><span class="line"><span class="comment"># For more information: https://fancyapps.com/fancybox</span></span><br><span class="line"><span class="attr">fancybox:</span> <span class="literal">true</span></span><br><span class="line"><span class="string">......</span></span><br><span class="line">  <span class="comment"># FancyBox</span></span><br><span class="line">  <span class="comment"># jquery: //cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js</span></span><br><span class="line">  <span class="comment"># fancybox: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js</span></span><br><span class="line">  <span class="comment"># fancybox_css: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css</span></span><br><span class="line">  <span class="attr">jquery:</span> <span class="string">//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js</span></span><br><span class="line">  <span class="attr">fancybox:</span> <span class="string">//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js</span></span><br><span class="line">  <span class="attr">fancybox_css:</span> <span class="string">//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css</span></span><br><span class="line"><span class="string">......</span></span><br></pre></td></tr></table></figure><h2 id="添加Valine评论系统"><a href="#添加Valine评论系统" class="headerlink" title="添加Valine评论系统"></a>添加Valine评论系统</h2><ul><li>打开主题配置文件<code>config.yml</code>，查询最新 <a href="https://www.jsdelivr.com/package/npm/valine">https://www.jsdelivr.com/package/npm/valine</a> 。</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">......</span></span><br><span class="line"><span class="comment"># Valine</span></span><br><span class="line"><span class="comment"># You can get your appid and appkey from https://leancloud.cn</span></span><br><span class="line"><span class="comment"># For more information: https://valine.js.org, https://github.com/xCss/Valine</span></span><br><span class="line"><span class="attr">valine:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># When enable is set to be true, leancloud_visitors is recommended to be closed for the re-initialization problem within different leancloud adk version</span></span><br><span class="line">  <span class="attr">appid:</span> <span class="string">i8TtPgUgH7Wk2kaxYnyRJey7-gzGzoHsz</span> <span class="comment"># Your leancloud application appid</span></span><br><span class="line">  <span class="attr">appkey:</span> <span class="string">9cQ6Jqy7mB6H41sLftQ4Cmo8</span> <span class="comment"># Your leancloud application appkey</span></span><br><span class="line">  <span class="attr">notify:</span> <span class="literal">false</span> <span class="comment"># Mail notifier. See: https://github.com/xCss/Valine/wiki</span></span><br><span class="line">  <span class="attr">verify:</span> <span class="literal">false</span> <span class="comment"># Verification code</span></span><br><span class="line">  <span class="attr">placeholder:</span> <span class="string">Just</span> <span class="string">go</span> <span class="string">go</span> <span class="comment"># Comment box placeholder</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="string">mm</span> <span class="comment"># Gravatar style</span></span><br><span class="line">  <span class="attr">guest_info:</span> <span class="string">nick,mail,link</span> <span class="comment"># Custom comment header</span></span><br><span class="line">  <span class="attr">pageSize:</span> <span class="number">10</span> <span class="comment"># Pagination size</span></span><br><span class="line">  <span class="attr">language:</span> <span class="comment"># Language, available values: en, zh-cn</span></span><br><span class="line">  <span class="attr">visitor:</span> <span class="literal">false</span> <span class="comment"># leancloud-counter-security is not supported for now. When visitor is set to be true, appid and appkey are recommended to be the same as leancloud_visitors&#x27; for counter compatibility. Article reading statistic https://valine.js.org/visitor.html</span></span><br><span class="line">  <span class="attr">comment_count:</span> <span class="literal">true</span> <span class="comment"># If false, comment count will only be displayed in post page, not in home page</span></span><br><span class="line">  <span class="attr">recordIP:</span> <span class="literal">false</span> <span class="comment"># Whether to record the commenter IP</span></span><br><span class="line">  <span class="attr">serverURLs:</span> <span class="comment"># When the custom domain name is enabled, fill it in here (it will be detected automatically by default, no need to fill in)</span></span><br><span class="line">  <span class="comment">#post_meta_order: 0</span></span><br><span class="line"><span class="string">......</span></span><br><span class="line">  <span class="comment"># Valine</span></span><br><span class="line">  <span class="comment"># valine: //cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js</span></span><br><span class="line">  <span class="comment"># valine: //cdnjs.cloudflare.com/ajax/libs/valine/1.3.10/Valine.min.js</span></span><br><span class="line">  <span class="attr">valine:</span> <span class="string">https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js</span></span><br><span class="line"><span class="string">......</span></span><br></pre></td></tr></table></figure><h2 id="鼠标点击特效四种"><a href="#鼠标点击特效四种" class="headerlink" title="鼠标点击特效四种"></a>鼠标点击特效四种</h2><h3 id="选项配置"><a href="#选项配置" class="headerlink" title="选项配置"></a>选项配置</h3><ul><li>在主题配置文件<code>config.yml</code>中添加</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cursor_effect:</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">love</span>  <span class="comment"># fireworks：礼花 | explosion：爆炸 | love：浮出爱心 | text：浮出文字</span></span><br></pre></td></tr></table></figure><ul><li>新建 <code>themes\next\layout\custom.swig</code> 文件</li></ul><figure class="highlight plain"><figcaption><span>custom.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.cursor_effect %&#125;</span><br><span class="line">  &#123;% if theme.cursor_effect.type &#x3D;&#x3D; &quot;fireworks&quot; %&#125;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;cursor&#x2F;fireworks.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">  &#123;% elseif theme.cursor_effect.type &#x3D;&#x3D; &quot;explosion&quot; %&#125;</span><br><span class="line">    &lt;canvas class&#x3D;&quot;fireworks&quot; style&#x3D;&quot;position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;&quot; &gt;&lt;&#x2F;canvas&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;&#x2F;&#x2F;cdn.bootcss.com&#x2F;animejs&#x2F;2.2.0&#x2F;anime.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;cursor&#x2F;explosion.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">  &#123;% elseif theme.cursor_effect.type &#x3D;&#x3D; &quot;love&quot; %&#125;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;cursor&#x2F;love.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">  &#123;% elseif theme.cursor_effect.type &#x3D;&#x3D; &quot;text&quot; %&#125;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;cursor&#x2F;text.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><ul><li>在 <code>themes\next\layout\layout.swig</code> 文件中添加</li></ul><figure class="highlight plain"><figcaption><span>layout.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line">+  &#123;% include &#39;custom.swig&#39; %&#125;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><h3 id="点击桃心效果"><a href="#点击桃心效果" class="headerlink" title="点击桃心效果"></a>点击桃心效果</h3><ul><li>新建<code>themes\next\source\js\cursor\love.min.js</code>下文件 </li></ul><figure class="highlight js"><figcaption><span>love.min.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">! <span class="function"><span class="keyword">function</span>(<span class="params">e, t, a</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">n</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    c(<span class="string">&quot;.heart&#123;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);&#125;.heart:after,.heart:before&#123;content: &#x27;&#x27;;width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;&#125;.heart:after&#123;top: -5px;&#125;.heart:before&#123;left: -5px;&#125;&quot;</span>), o(), r()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> e = <span class="number">0</span>; e &lt; d.length; e++) d[e].alpha &lt;= <span class="number">0</span> ? (t.body.removeChild(d[e].el), d.splice(e, <span class="number">1</span>)) : (d[e].y--, d[e].scale += <span class="number">.004</span>, d[e].alpha -= <span class="number">.013</span>, d[e].el.style.cssText = <span class="string">&quot;left:&quot;</span> + d[e].x + <span class="string">&quot;px;top:&quot;</span> + d[e].y + <span class="string">&quot;px;opacity:&quot;</span> + d[e].alpha + <span class="string">&quot;;transform:scale(&quot;</span> + d[e].scale + <span class="string">&quot;,&quot;</span> + d[e].scale + <span class="string">&quot;) rotate(45deg);background:&quot;</span> + d[e].color + <span class="string">&quot;;z-index:99999&quot;</span>);</span><br><span class="line">    requestAnimationFrame(r)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="string">&quot;function&quot;</span> == <span class="keyword">typeof</span> e.onclick &amp;&amp; e.onclick;</span><br><span class="line">    e.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">      t &amp;&amp; t(), i(e)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">i</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = t.createElement(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    a.className = <span class="string">&quot;heart&quot;</span>, d.push(&#123;</span><br><span class="line">      el: a,</span><br><span class="line">      x: e.clientX - <span class="number">5</span>,</span><br><span class="line">      y: e.clientY - <span class="number">5</span>,</span><br><span class="line">      scale: <span class="number">1</span>,</span><br><span class="line">      alpha: <span class="number">1</span>,</span><br><span class="line">      color: s()</span><br><span class="line">    &#125;), t.body.appendChild(a)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = t.createElement(<span class="string">&quot;style&quot;</span>);</span><br><span class="line">    a.type = <span class="string">&quot;text/css&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      a.appendChild(t.createTextNode(e))</span><br><span class="line">    &#125; <span class="keyword">catch</span> (t) &#123;</span><br><span class="line">      a.styleSheet.cssText = e</span><br><span class="line">    &#125;</span><br><span class="line">    t.getElementsByTagName(<span class="string">&quot;head&quot;</span>)[<span class="number">0</span>].appendChild(a)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">s</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;rgb(&quot;</span> + ~~(<span class="number">255</span> * <span class="built_in">Math</span>.random()) + <span class="string">&quot;,&quot;</span> + ~~(<span class="number">255</span> * <span class="built_in">Math</span>.random()) + <span class="string">&quot;,&quot;</span> + ~~(<span class="number">255</span> * <span class="built_in">Math</span>.random()) + <span class="string">&quot;)&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> d = [];</span><br><span class="line">  e.requestAnimationFrame = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(e, <span class="number">1e3</span> / <span class="number">60</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;(), n()</span><br><span class="line">&#125;(<span class="built_in">window</span>, <span class="built_in">document</span>);</span><br></pre></td></tr></table></figure><h3 id="点击礼花效果"><a href="#点击礼花效果" class="headerlink" title="点击礼花效果"></a>点击礼花效果</h3><ul><li>新建<code>themes\next\source\js\cursor\fireworks.js</code>下文件 </li></ul><figure class="highlight js"><figcaption><span>fireworks.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(&#123; origin, speed, color, angle, context &#125;) &#123;</span><br><span class="line">    <span class="built_in">this</span>.origin = origin</span><br><span class="line">    <span class="built_in">this</span>.position = &#123; ...this.origin &#125;</span><br><span class="line">    <span class="built_in">this</span>.color = color</span><br><span class="line">    <span class="built_in">this</span>.speed = speed</span><br><span class="line">    <span class="built_in">this</span>.angle = angle</span><br><span class="line">    <span class="built_in">this</span>.context = context</span><br><span class="line">    <span class="built_in">this</span>.renderCount = <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  draw() &#123;</span><br><span class="line">    <span class="built_in">this</span>.context.fillStyle = <span class="built_in">this</span>.color</span><br><span class="line">    <span class="built_in">this</span>.context.beginPath()</span><br><span class="line">    <span class="built_in">this</span>.context.arc(<span class="built_in">this</span>.position.x, <span class="built_in">this</span>.position.y, <span class="number">2</span>, <span class="number">0</span>, <span class="built_in">Math</span>.PI * <span class="number">2</span>)</span><br><span class="line">    <span class="built_in">this</span>.context.fill()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  move() &#123;</span><br><span class="line">    <span class="built_in">this</span>.position.x = (<span class="built_in">Math</span>.sin(<span class="built_in">this</span>.angle) * <span class="built_in">this</span>.speed) + <span class="built_in">this</span>.position.x</span><br><span class="line">    <span class="built_in">this</span>.position.y = (<span class="built_in">Math</span>.cos(<span class="built_in">this</span>.angle) * <span class="built_in">this</span>.speed) + <span class="built_in">this</span>.position.y + (<span class="built_in">this</span>.renderCount * <span class="number">0.3</span>)</span><br><span class="line">    <span class="built_in">this</span>.renderCount++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boom</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> (&#123; origin, context, circleCount = <span class="number">16</span>, area &#125;) &#123;</span><br><span class="line">    <span class="built_in">this</span>.origin = origin</span><br><span class="line">    <span class="built_in">this</span>.context = context</span><br><span class="line">    <span class="built_in">this</span>.circleCount = circleCount</span><br><span class="line">    <span class="built_in">this</span>.area = area</span><br><span class="line">    <span class="built_in">this</span>.stop = <span class="literal">false</span></span><br><span class="line">    <span class="built_in">this</span>.circles = []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  randomArray(range) &#123;</span><br><span class="line">    <span class="keyword">const</span> length = range.length</span><br><span class="line">    <span class="keyword">const</span> randomIndex = <span class="built_in">Math</span>.floor(length * <span class="built_in">Math</span>.random())</span><br><span class="line">    <span class="keyword">return</span> range[randomIndex]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  randomColor() &#123;</span><br><span class="line">    <span class="keyword">const</span> range = [<span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;#&#x27;</span> + <span class="built_in">this</span>.randomArray(range) + <span class="built_in">this</span>.randomArray(range) + <span class="built_in">this</span>.randomArray(range) + <span class="built_in">this</span>.randomArray(range) + <span class="built_in">this</span>.randomArray(range) + <span class="built_in">this</span>.randomArray(range)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  randomRange(start, end) &#123;</span><br><span class="line">    <span class="keyword">return</span> (end - start) * <span class="built_in">Math</span>.random() + start</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  init() &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.circleCount; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> circle = <span class="keyword">new</span> Circle(&#123;</span><br><span class="line">        context: <span class="built_in">this</span>.context,</span><br><span class="line">        origin: <span class="built_in">this</span>.origin,</span><br><span class="line">        color: <span class="built_in">this</span>.randomColor(),</span><br><span class="line">        angle: <span class="built_in">this</span>.randomRange(<span class="built_in">Math</span>.PI - <span class="number">1</span>, <span class="built_in">Math</span>.PI + <span class="number">1</span>),</span><br><span class="line">        speed: <span class="built_in">this</span>.randomRange(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="built_in">this</span>.circles.push(circle)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  move() &#123;</span><br><span class="line">    <span class="built_in">this</span>.circles.forEach(<span class="function">(<span class="params">circle, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (circle.position.x &gt; <span class="built_in">this</span>.area.width || circle.position.y &gt; <span class="built_in">this</span>.area.height) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.circles.splice(index, <span class="number">1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      circle.move()</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.circles.length == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">this</span>.stop = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  draw() &#123;</span><br><span class="line">    <span class="built_in">this</span>.circles.forEach(<span class="function"><span class="params">circle</span> =&gt;</span> circle.draw())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CursorSpecialEffects</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="built_in">this</span>.computerCanvas = <span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>)</span><br><span class="line">    <span class="built_in">this</span>.renderCanvas = <span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.computerContext = <span class="built_in">this</span>.computerCanvas.getContext(<span class="string">&#x27;2d&#x27;</span>)</span><br><span class="line">    <span class="built_in">this</span>.renderContext = <span class="built_in">this</span>.renderCanvas.getContext(<span class="string">&#x27;2d&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.globalWidth = <span class="built_in">window</span>.innerWidth</span><br><span class="line">    <span class="built_in">this</span>.globalHeight = <span class="built_in">window</span>.innerHeight</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.booms = []</span><br><span class="line">    <span class="built_in">this</span>.running = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleMouseDown(e) &#123;</span><br><span class="line">    <span class="keyword">const</span> boom = <span class="keyword">new</span> Boom(&#123;</span><br><span class="line">      origin: &#123; <span class="attr">x</span>: e.clientX, <span class="attr">y</span>: e.clientY &#125;,</span><br><span class="line">      context: <span class="built_in">this</span>.computerContext,</span><br><span class="line">      area: &#123;</span><br><span class="line">        width: <span class="built_in">this</span>.globalWidth,</span><br><span class="line">        height: <span class="built_in">this</span>.globalHeight</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    boom.init()</span><br><span class="line">    <span class="built_in">this</span>.booms.push(boom)</span><br><span class="line">    <span class="built_in">this</span>.running || <span class="built_in">this</span>.run()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handlePageHide() &#123;</span><br><span class="line">    <span class="built_in">this</span>.booms = []</span><br><span class="line">    <span class="built_in">this</span>.running = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  init() &#123;</span><br><span class="line">    <span class="keyword">const</span> style = <span class="built_in">this</span>.renderCanvas.style</span><br><span class="line">    style.position = <span class="string">&#x27;fixed&#x27;</span></span><br><span class="line">    style.top = style.left = <span class="number">0</span></span><br><span class="line">    style.zIndex = <span class="string">&#x27;999999999999999999999999999999999999999999&#x27;</span></span><br><span class="line">    style.pointerEvents = <span class="string">&#x27;none&#x27;</span></span><br><span class="line"></span><br><span class="line">    style.width = <span class="built_in">this</span>.renderCanvas.width = <span class="built_in">this</span>.computerCanvas.width = <span class="built_in">this</span>.globalWidth</span><br><span class="line">    style.height = <span class="built_in">this</span>.renderCanvas.height = <span class="built_in">this</span>.computerCanvas.height = <span class="built_in">this</span>.globalHeight</span><br><span class="line"></span><br><span class="line">    <span class="built_in">document</span>.body.append(<span class="built_in">this</span>.renderCanvas)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&#x27;mousedown&#x27;</span>, <span class="built_in">this</span>.handleMouseDown.bind(<span class="built_in">this</span>))</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&#x27;pagehide&#x27;</span>, <span class="built_in">this</span>.handlePageHide.bind(<span class="built_in">this</span>))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  run() &#123;</span><br><span class="line">    <span class="built_in">this</span>.running = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.booms.length == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.running = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    requestAnimationFrame(<span class="built_in">this</span>.run.bind(<span class="built_in">this</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.computerContext.clearRect(<span class="number">0</span>, <span class="number">0</span>, <span class="built_in">this</span>.globalWidth, <span class="built_in">this</span>.globalHeight)</span><br><span class="line">    <span class="built_in">this</span>.renderContext.clearRect(<span class="number">0</span>, <span class="number">0</span>, <span class="built_in">this</span>.globalWidth, <span class="built_in">this</span>.globalHeight)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.booms.forEach(<span class="function">(<span class="params">boom, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (boom.stop) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.booms.splice(index, <span class="number">1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      boom.move()</span><br><span class="line">      boom.draw()</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">this</span>.renderContext.drawImage(<span class="built_in">this</span>.computerCanvas, <span class="number">0</span>, <span class="number">0</span>, <span class="built_in">this</span>.globalWidth, <span class="built_in">this</span>.globalHeight)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cursorSpecialEffects = <span class="keyword">new</span> CursorSpecialEffects()</span><br><span class="line">cursorSpecialEffects.init()</span><br></pre></td></tr></table></figure><h3 id="点击爆炸效果"><a href="#点击爆炸效果" class="headerlink" title="点击爆炸效果"></a>点击爆炸效果</h3><ul><li>新建<code>themes\next\source\js\cursor\explosion.min.js</code>下文件</li></ul><figure class="highlight js"><figcaption><span>explosion.min.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;<span class="function"><span class="keyword">function</span> <span class="title">updateCoords</span>(<span class="params">e</span>)</span>&#123;pointerX=(e.clientX||e.touches[<span class="number">0</span>].clientX)-canvasEl.getBoundingClientRect().left,pointerY=e.clientY||e.touches[<span class="number">0</span>].clientY-canvasEl.getBoundingClientRect().top&#125;<span class="function"><span class="keyword">function</span> <span class="title">setParticuleDirection</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">var</span> t=anime.random(<span class="number">0</span>,<span class="number">360</span>)*<span class="built_in">Math</span>.PI/<span class="number">180</span>,a=anime.random(<span class="number">50</span>,<span class="number">180</span>),n=[<span class="number">-1</span>,<span class="number">1</span>][anime.random(<span class="number">0</span>,<span class="number">1</span>)]*a;<span class="keyword">return</span>&#123;<span class="attr">x</span>:e.x+n*<span class="built_in">Math</span>.cos(t),<span class="attr">y</span>:e.y+n*<span class="built_in">Math</span>.sin(t)&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">createParticule</span>(<span class="params">e,t</span>)</span>&#123;<span class="keyword">var</span> a=&#123;&#125;;<span class="keyword">return</span> a.x=e,a.y=t,a.color=colors[anime.random(<span class="number">0</span>,colors.length<span class="number">-1</span>)],a.radius=anime.random(<span class="number">16</span>,<span class="number">32</span>),a.endPos=setParticuleDirection(a),a.draw=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">Math</span>.PI,!<span class="number">0</span>),ctx.fillStyle=a.color,ctx.fill()&#125;,a&#125;<span class="function"><span class="keyword">function</span> <span class="title">createCircle</span>(<span class="params">e,t</span>)</span>&#123;<span class="keyword">var</span> a=&#123;&#125;;<span class="keyword">return</span> a.x=e,a.y=t,a.color=<span class="string">&quot;#F00&quot;</span>,a.radius=<span class="number">0.1</span>,a.alpha=<span class="number">0.5</span>,a.lineWidth=<span class="number">6</span>,a.draw=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;ctx.globalAlpha=a.alpha,ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">Math</span>.PI,!<span class="number">0</span>),ctx.lineWidth=a.lineWidth,ctx.strokeStyle=a.color,ctx.stroke(),ctx.globalAlpha=<span class="number">1</span>&#125;,a&#125;<span class="function"><span class="keyword">function</span> <span class="title">renderParticule</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;e.animatables.length;t++)&#123;e.animatables[t].target.draw()&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">animateParticules</span>(<span class="params">e,t</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=createCircle(e,t),n=[],i=<span class="number">0</span>;i&lt;numberOfParticules;i++)&#123;n.push(createParticule(e,t))&#125;anime.timeline().add(&#123;<span class="attr">targets</span>:n,<span class="attr">x</span>:<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">return</span> e.endPos.x&#125;,<span class="attr">y</span>:<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">return</span> e.endPos.y&#125;,<span class="attr">radius</span>:<span class="number">0.1</span>,<span class="attr">duration</span>:anime.random(<span class="number">1200</span>,<span class="number">1800</span>),<span class="attr">easing</span>:<span class="string">&quot;easeOutExpo&quot;</span>,<span class="attr">update</span>:renderParticule&#125;).add(&#123;<span class="attr">targets</span>:a,<span class="attr">radius</span>:anime.random(<span class="number">80</span>,<span class="number">160</span>),<span class="attr">lineWidth</span>:<span class="number">0</span>,<span class="attr">alpha</span>:&#123;<span class="attr">value</span>:<span class="number">0</span>,<span class="attr">easing</span>:<span class="string">&quot;linear&quot;</span>,<span class="attr">duration</span>:anime.random(<span class="number">600</span>,<span class="number">800</span>)&#125;,<span class="attr">duration</span>:anime.random(<span class="number">1200</span>,<span class="number">1800</span>),<span class="attr">easing</span>:<span class="string">&quot;easeOutExpo&quot;</span>,<span class="attr">update</span>:renderParticule,<span class="attr">offset</span>:<span class="number">0</span>&#125;)&#125;<span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">e,t</span>)</span>&#123;<span class="keyword">var</span> a;<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> n=<span class="built_in">this</span>,i=<span class="built_in">arguments</span>;<span class="built_in">clearTimeout</span>(a),a=<span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;e.apply(n,i)&#125;,t)&#125;&#125;<span class="keyword">var</span> canvasEl=<span class="built_in">document</span>.querySelector(<span class="string">&quot;.fireworks&quot;</span>);<span class="keyword">if</span>(canvasEl)&#123;<span class="keyword">var</span> ctx=canvasEl.getContext(<span class="string">&quot;2d&quot;</span>),numberOfParticules=<span class="number">30</span>,pointerX=<span class="number">0</span>,pointerY=<span class="number">0</span>,tap=<span class="string">&quot;mousedown&quot;</span>,colors=[<span class="string">&quot;#FF1461&quot;</span>,<span class="string">&quot;#18FF92&quot;</span>,<span class="string">&quot;#5A87FF&quot;</span>,<span class="string">&quot;#FBF38C&quot;</span>],setCanvasSize=debounce(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;canvasEl.width=<span class="number">2</span>*<span class="built_in">window</span>.innerWidth,canvasEl.height=<span class="number">2</span>*<span class="built_in">window</span>.innerHeight,canvasEl.style.width=<span class="built_in">window</span>.innerWidth+<span class="string">&quot;px&quot;</span>,canvasEl.style.height=<span class="built_in">window</span>.innerHeight+<span class="string">&quot;px&quot;</span>,canvasEl.getContext(<span class="string">&quot;2d&quot;</span>).scale(<span class="number">2</span>,<span class="number">2</span>)&#125;,<span class="number">500</span>),render=anime(&#123;<span class="attr">duration</span>:<span class="number">1</span>/<span class="number">0</span>,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;ctx.clearRect(<span class="number">0</span>,<span class="number">0</span>,canvasEl.width,canvasEl.height)&#125;&#125;);<span class="built_in">document</span>.addEventListener(tap,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="string">&quot;sidebar&quot;</span>!==e.target.id&amp;&amp;<span class="string">&quot;toggle-sidebar&quot;</span>!==e.target.id&amp;&amp;<span class="string">&quot;A&quot;</span>!==e.target.nodeName&amp;&amp;<span class="string">&quot;IMG&quot;</span>!==e.target.nodeName&amp;&amp;(render.play(),updateCoords(e),animateParticules(pointerX,pointerY))&#125;,!<span class="number">1</span>),setCanvasSize(),<span class="built_in">window</span>.addEventListener(<span class="string">&quot;resize&quot;</span>,setCanvasSize,!<span class="number">1</span>)&#125;<span class="string">&quot;use strict&quot;</span>;<span class="function"><span class="keyword">function</span> <span class="title">updateCoords</span>(<span class="params">e</span>)</span>&#123;pointerX=(e.clientX||e.touches[<span class="number">0</span>].clientX)-canvasEl.getBoundingClientRect().left,pointerY=e.clientY||e.touches[<span class="number">0</span>].clientY-canvasEl.getBoundingClientRect().top&#125;<span class="function"><span class="keyword">function</span> <span class="title">setParticuleDirection</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">var</span> t=anime.random(<span class="number">0</span>,<span class="number">360</span>)*<span class="built_in">Math</span>.PI/<span class="number">180</span>,a=anime.random(<span class="number">50</span>,<span class="number">180</span>),n=[<span class="number">-1</span>,<span class="number">1</span>][anime.random(<span class="number">0</span>,<span class="number">1</span>)]*a;<span class="keyword">return</span>&#123;<span class="attr">x</span>:e.x+n*<span class="built_in">Math</span>.cos(t),<span class="attr">y</span>:e.y+n*<span class="built_in">Math</span>.sin(t)&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">createParticule</span>(<span class="params">e,t</span>)</span>&#123;<span class="keyword">var</span> a=&#123;&#125;;<span class="keyword">return</span> a.x=e,a.y=t,a.color=colors[anime.random(<span class="number">0</span>,colors.length<span class="number">-1</span>)],a.radius=anime.random(<span class="number">16</span>,<span class="number">32</span>),a.endPos=setParticuleDirection(a),a.draw=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">Math</span>.PI,!<span class="number">0</span>),ctx.fillStyle=a.color,ctx.fill()&#125;,a&#125;<span class="function"><span class="keyword">function</span> <span class="title">createCircle</span>(<span class="params">e,t</span>)</span>&#123;<span class="keyword">var</span> a=&#123;&#125;;<span class="keyword">return</span> a.x=e,a.y=t,a.color=<span class="string">&quot;#F00&quot;</span>,a.radius=<span class="number">0.1</span>,a.alpha=<span class="number">0.5</span>,a.lineWidth=<span class="number">6</span>,a.draw=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;ctx.globalAlpha=a.alpha,ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">Math</span>.PI,!<span class="number">0</span>),ctx.lineWidth=a.lineWidth,ctx.strokeStyle=a.color,ctx.stroke(),ctx.globalAlpha=<span class="number">1</span>&#125;,a&#125;<span class="function"><span class="keyword">function</span> <span class="title">renderParticule</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;e.animatables.length;t++)&#123;e.animatables[t].target.draw()&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">animateParticules</span>(<span class="params">e,t</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=createCircle(e,t),n=[],i=<span class="number">0</span>;i&lt;numberOfParticules;i++)&#123;n.push(createParticule(e,t))&#125;anime.timeline().add(&#123;<span class="attr">targets</span>:n,<span class="attr">x</span>:<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">return</span> e.endPos.x&#125;,<span class="attr">y</span>:<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">return</span> e.endPos.y&#125;,<span class="attr">radius</span>:<span class="number">0.1</span>,<span class="attr">duration</span>:anime.random(<span class="number">1200</span>,<span class="number">1800</span>),<span class="attr">easing</span>:<span class="string">&quot;easeOutExpo&quot;</span>,<span class="attr">update</span>:renderParticule&#125;).add(&#123;<span class="attr">targets</span>:a,<span class="attr">radius</span>:anime.random(<span class="number">80</span>,<span class="number">160</span>),<span class="attr">lineWidth</span>:<span class="number">0</span>,<span class="attr">alpha</span>:&#123;<span class="attr">value</span>:<span class="number">0</span>,<span class="attr">easing</span>:<span class="string">&quot;linear&quot;</span>,<span class="attr">duration</span>:anime.random(<span class="number">600</span>,<span class="number">800</span>)&#125;,<span class="attr">duration</span>:anime.random(<span class="number">1200</span>,<span class="number">1800</span>),<span class="attr">easing</span>:<span class="string">&quot;easeOutExpo&quot;</span>,<span class="attr">update</span>:renderParticule,<span class="attr">offset</span>:<span class="number">0</span>&#125;)&#125;<span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">e,t</span>)</span>&#123;<span class="keyword">var</span> a;<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> n=<span class="built_in">this</span>,i=<span class="built_in">arguments</span>;<span class="built_in">clearTimeout</span>(a),a=<span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;e.apply(n,i)&#125;,t)&#125;&#125;<span class="keyword">var</span> canvasEl=<span class="built_in">document</span>.querySelector(<span class="string">&quot;.fireworks&quot;</span>);<span class="keyword">if</span>(canvasEl)&#123;<span class="keyword">var</span> ctx=canvasEl.getContext(<span class="string">&quot;2d&quot;</span>),numberOfParticules=<span class="number">30</span>,pointerX=<span class="number">0</span>,pointerY=<span class="number">0</span>,tap=<span class="string">&quot;mousedown&quot;</span>,colors=[<span class="string">&quot;#FF1461&quot;</span>,<span class="string">&quot;#18FF92&quot;</span>,<span class="string">&quot;#5A87FF&quot;</span>,<span class="string">&quot;#FBF38C&quot;</span>],setCanvasSize=debounce(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;canvasEl.width=<span class="number">2</span>*<span class="built_in">window</span>.innerWidth,canvasEl.height=<span class="number">2</span>*<span class="built_in">window</span>.innerHeight,canvasEl.style.width=<span class="built_in">window</span>.innerWidth+<span class="string">&quot;px&quot;</span>,canvasEl.style.height=<span class="built_in">window</span>.innerHeight+<span class="string">&quot;px&quot;</span>,canvasEl.getContext(<span class="string">&quot;2d&quot;</span>).scale(<span class="number">2</span>,<span class="number">2</span>)&#125;,<span class="number">500</span>),render=anime(&#123;<span class="attr">duration</span>:<span class="number">1</span>/<span class="number">0</span>,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;ctx.clearRect(<span class="number">0</span>,<span class="number">0</span>,canvasEl.width,canvasEl.height)&#125;&#125;);<span class="built_in">document</span>.addEventListener(tap,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="string">&quot;sidebar&quot;</span>!==e.target.id&amp;&amp;<span class="string">&quot;toggle-sidebar&quot;</span>!==e.target.id&amp;&amp;<span class="string">&quot;A&quot;</span>!==e.target.nodeName&amp;&amp;<span class="string">&quot;IMG&quot;</span>!==e.target.nodeName&amp;&amp;(render.play(),updateCoords(e),animateParticules(pointerX,pointerY))&#125;,!<span class="number">1</span>),setCanvasSize(),<span class="built_in">window</span>.addEventListener(<span class="string">&quot;resize&quot;</span>,setCanvasSize,!<span class="number">1</span>)&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="点击文字效果"><a href="#点击文字效果" class="headerlink" title="点击文字效果"></a>点击文字效果</h3><ul><li>新建<code>themes\next\source\js\cursor\text.js</code>文件</li></ul><figure class="highlight js"><figcaption><span>text.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a_idx = <span class="number">0</span>;</span><br><span class="line">jQuery(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params">$</span>) </span>&#123;</span><br><span class="line">  $(<span class="string">&quot;body&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">&quot;富强&quot;</span>, <span class="string">&quot;民主&quot;</span>, <span class="string">&quot;文明&quot;</span>, <span class="string">&quot;和谐&quot;</span>, <span class="string">&quot;自由&quot;</span>, <span class="string">&quot;平等&quot;</span>, <span class="string">&quot;公正&quot;</span> ,<span class="string">&quot;法治&quot;</span>, <span class="string">&quot;爱国&quot;</span>, <span class="string">&quot;敬业&quot;</span>, <span class="string">&quot;诚信&quot;</span>, <span class="string">&quot;友善&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> $i = $(<span class="string">&quot;&lt;span/&gt;&quot;</span>).text(a[a_idx]);</span><br><span class="line">    <span class="keyword">var</span> x = e.pageX,</span><br><span class="line">      y = e.pageY;</span><br><span class="line">    $i.css(&#123;</span><br><span class="line">      <span class="string">&quot;z-index&quot;</span>: <span class="number">99999</span>,</span><br><span class="line">      <span class="string">&quot;top&quot;</span>: y - <span class="number">28</span>,</span><br><span class="line">      <span class="string">&quot;left&quot;</span>: x - a[a_idx].length * <span class="number">8</span>,</span><br><span class="line">      <span class="string">&quot;position&quot;</span>: <span class="string">&quot;absolute&quot;</span>,</span><br><span class="line">      <span class="string">&quot;color&quot;</span>: <span class="string">&quot;#ff7a45&quot;</span></span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;body&quot;</span>).append($i);</span><br><span class="line">    $i.animate(&#123;</span><br><span class="line">      <span class="string">&quot;top&quot;</span>: y - <span class="number">180</span>,</span><br><span class="line">      <span class="string">&quot;opacity&quot;</span>: <span class="number">0</span></span><br><span class="line">    &#125;, <span class="number">1500</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      $i.remove();</span><br><span class="line">    &#125;);</span><br><span class="line">    a_idx = (a_idx + <span class="number">1</span>) % a.length;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="评论打字特效"><a href="#评论打字特效" class="headerlink" title="评论打字特效"></a>评论打字特效</h2><ul><li>打开主题配置文件<code>config.yml</code>，添加以下内容：</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># typing effect</span></span><br><span class="line"><span class="attr">typing_effect:</span></span><br><span class="line">  <span class="attr">colorful:</span> <span class="literal">true</span>  <span class="comment"># 礼花特效</span></span><br><span class="line">  <span class="attr">shake:</span> <span class="literal">false</span>  <span class="comment"># 震动特效</span></span><br></pre></td></tr></table></figure><ul><li>打开 <code>themes\next\layout\custom.swig</code> 文件，如果没有，则新建。</li></ul><figure class="highlight plain"><figcaption><span>custom.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;# 打字特效 #&#125;</span><br><span class="line">&#123;% if theme.typing_effect %&#125;</span><br><span class="line">  &lt;script src&#x3D;&quot;&#x2F;js&#x2F;cursor&#x2F;activate-power-mode.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    POWERMODE.colorful &#x3D; &#123;&#123; theme.typing_effect.colorful &#125;&#125;;</span><br><span class="line">    POWERMODE.shake &#x3D; &#123;&#123; theme.typing_effect.shake &#125;&#125;;</span><br><span class="line">    document.body.addEventListener(&#39;input&#39;, POWERMODE);</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><ul><li>新建<code>themes\next\source\js\cursor\activate-power-mode.min.js</code>文件</li></ul><figure class="highlight js"><figcaption><span>activate-power-mode.min.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">webpackUniversalModuleDefinition</span>(<span class="params">root,factory</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">exports</span>===<span class="string">&#x27;object&#x27;</span>&amp;&amp;<span class="keyword">typeof</span> <span class="built_in">module</span>===<span class="string">&#x27;object&#x27;</span>)<span class="built_in">module</span>.exports=factory();<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">typeof</span> define===<span class="string">&#x27;function&#x27;</span>&amp;&amp;define.amd)define([],factory);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">exports</span>===<span class="string">&#x27;object&#x27;</span>)<span class="built_in">exports</span>[<span class="string">&quot;POWERMODE&quot;</span>]=factory();<span class="keyword">else</span> root[<span class="string">&quot;POWERMODE&quot;</span>]=factory()&#125;)(<span class="built_in">this</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>(<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>)</span>&#123;<span class="keyword">var</span> installedModules=&#123;&#125;;<span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>)</span>&#123;<span class="keyword">if</span>(installedModules[moduleId])<span class="keyword">return</span> installedModules[moduleId].exports;<span class="keyword">var</span> <span class="built_in">module</span>=installedModules[moduleId]=&#123;<span class="attr">exports</span>:&#123;&#125;,<span class="attr">id</span>:moduleId,<span class="attr">loaded</span>:<span class="literal">false</span>&#125;;modules[moduleId].call(<span class="built_in">module</span>.exports,<span class="built_in">module</span>,<span class="built_in">module</span>.exports,__webpack_require__);<span class="built_in">module</span>.loaded=<span class="literal">true</span>;<span class="keyword">return</span> <span class="built_in">module</span>.exports&#125;__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p=<span class="string">&quot;&quot;</span>;<span class="keyword">return</span> __webpack_require__(<span class="number">0</span>)&#125;)([<span class="function"><span class="keyword">function</span>(<span class="params">module,exports,__webpack_require__</span>)</span>&#123;<span class="string">&#x27;use strict&#x27;</span>;<span class="keyword">var</span> canvas=<span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>);canvas.width=<span class="built_in">window</span>.innerWidth;canvas.height=<span class="built_in">window</span>.innerHeight;canvas.style.cssText=<span class="string">&#x27;position:fixed;top:0;left:0;pointer-events:none;z-index:999999&#x27;</span>;<span class="built_in">window</span>.addEventListener(<span class="string">&#x27;resize&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;canvas.width=<span class="built_in">window</span>.innerWidth;canvas.height=<span class="built_in">window</span>.innerHeight&#125;);<span class="built_in">document</span>.body.appendChild(canvas);<span class="keyword">var</span> context=canvas.getContext(<span class="string">&#x27;2d&#x27;</span>);<span class="keyword">var</span> particles=[];<span class="keyword">var</span> particlePointer=<span class="number">0</span>;POWERMODE.shake=<span class="literal">true</span>;<span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params">min,max</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">Math</span>.random()*(max-min)+min&#125;<span class="function"><span class="keyword">function</span> <span class="title">getColor</span>(<span class="params">el</span>)</span>&#123;<span class="keyword">if</span>(POWERMODE.colorful)&#123;<span class="keyword">var</span> u=getRandom(<span class="number">0</span>,<span class="number">360</span>);<span class="keyword">return</span><span class="string">&#x27;hsla(&#x27;</span>+getRandom(u<span class="number">-10</span>,u+<span class="number">10</span>)+<span class="string">&#x27;, 100%, &#x27;</span>+getRandom(<span class="number">50</span>,<span class="number">80</span>)+<span class="string">&#x27;%, &#x27;</span>+<span class="number">1</span>+<span class="string">&#x27;)&#x27;</span>&#125;<span class="keyword">else</span>&#123;<span class="keyword">return</span> <span class="built_in">window</span>.getComputedStyle(el).color&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">getCaret</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> el=<span class="built_in">document</span>.activeElement;<span class="keyword">var</span> bcr;<span class="keyword">if</span>(el.tagName===<span class="string">&#x27;TEXTAREA&#x27;</span>||(el.tagName===<span class="string">&#x27;INPUT&#x27;</span>&amp;&amp;el.getAttribute(<span class="string">&#x27;type&#x27;</span>)===<span class="string">&#x27;text&#x27;</span>))&#123;<span class="keyword">var</span> offset=__webpack_require__(<span class="number">1</span>)(el,el.selectionStart);bcr=el.getBoundingClientRect();<span class="keyword">return</span>&#123;<span class="attr">x</span>:offset.left+bcr.left,<span class="attr">y</span>:offset.top+bcr.top,<span class="attr">color</span>:getColor(el)&#125;&#125;<span class="keyword">var</span> selection=<span class="built_in">window</span>.getSelection();<span class="keyword">if</span>(selection.rangeCount)&#123;<span class="keyword">var</span> range=selection.getRangeAt(<span class="number">0</span>);<span class="keyword">var</span> startNode=range.startContainer;<span class="keyword">if</span>(startNode.nodeType===<span class="built_in">document</span>.TEXT_NODE)&#123;startNode=startNode.parentNode&#125;bcr=range.getBoundingClientRect();<span class="keyword">return</span>&#123;<span class="attr">x</span>:bcr.left,<span class="attr">y</span>:bcr.top,<span class="attr">color</span>:getColor(startNode)&#125;&#125;<span class="keyword">return</span>&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:<span class="number">0</span>,<span class="attr">color</span>:<span class="string">&#x27;transparent&#x27;</span>&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">createParticle</span>(<span class="params">x,y,color</span>)</span>&#123;<span class="keyword">return</span>&#123;<span class="attr">x</span>:x,<span class="attr">y</span>:y,<span class="attr">alpha</span>:<span class="number">1</span>,<span class="attr">color</span>:color,<span class="attr">velocity</span>:&#123;<span class="attr">x</span>:<span class="number">-1</span>+<span class="built_in">Math</span>.random()*<span class="number">2</span>,<span class="attr">y</span>:<span class="number">-3.5</span>+<span class="built_in">Math</span>.random()*<span class="number">2</span>&#125;&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">POWERMODE</span>(<span class="params"></span>)</span>&#123;&#123;<span class="keyword">var</span> caret=getCaret();<span class="keyword">var</span> numParticles=<span class="number">5</span>+<span class="built_in">Math</span>.round(<span class="built_in">Math</span>.random()*<span class="number">10</span>);<span class="keyword">while</span>(numParticles--)&#123;particles[particlePointer]=createParticle(caret.x,caret.y,caret.color);particlePointer=(particlePointer+<span class="number">1</span>)%<span class="number">500</span>&#125;&#125;&#123;<span class="keyword">if</span>(POWERMODE.shake)&#123;<span class="keyword">var</span> intensity=<span class="number">1</span>+<span class="number">2</span>*<span class="built_in">Math</span>.random();<span class="keyword">var</span> x=intensity*(<span class="built_in">Math</span>.random()&gt;<span class="number">0.5</span>?<span class="number">-1</span>:<span class="number">1</span>);<span class="keyword">var</span> y=intensity*(<span class="built_in">Math</span>.random()&gt;<span class="number">0.5</span>?<span class="number">-1</span>:<span class="number">1</span>);<span class="built_in">document</span>.body.style.marginLeft=x+<span class="string">&#x27;px&#x27;</span>;<span class="built_in">document</span>.body.style.marginTop=y+<span class="string">&#x27;px&#x27;</span>;<span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">document</span>.body.style.marginLeft=<span class="string">&#x27;&#x27;</span>;<span class="built_in">document</span>.body.style.marginTop=<span class="string">&#x27;&#x27;</span>&#125;,<span class="number">75</span>)&#125;&#125;&#125;;POWERMODE.colorful=<span class="literal">false</span>;<span class="function"><span class="keyword">function</span> <span class="title">loop</span>(<span class="params"></span>)</span>&#123;requestAnimationFrame(loop);context.clearRect(<span class="number">0</span>,<span class="number">0</span>,canvas.width,canvas.height);<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;particles.length;++i)&#123;<span class="keyword">var</span> particle=particles[i];<span class="keyword">if</span>(particle.alpha&lt;=<span class="number">0.1</span>)<span class="keyword">continue</span>;particle.velocity.y+=<span class="number">0.075</span>;particle.x+=particle.velocity.x;particle.y+=particle.velocity.y;particle.alpha*=<span class="number">0.96</span>;context.globalAlpha=particle.alpha;context.fillStyle=particle.color;context.fillRect(<span class="built_in">Math</span>.round(particle.x<span class="number">-1.5</span>),<span class="built_in">Math</span>.round(particle.y<span class="number">-1.5</span>),<span class="number">3</span>,<span class="number">3</span>)&#125;&#125;requestAnimationFrame(loop);<span class="built_in">module</span>.exports=POWERMODE&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">module,exports</span>)</span>&#123;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> properties=[<span class="string">&#x27;direction&#x27;</span>,<span class="string">&#x27;boxSizing&#x27;</span>,<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;overflowX&#x27;</span>,<span class="string">&#x27;overflowY&#x27;</span>,<span class="string">&#x27;borderTopWidth&#x27;</span>,<span class="string">&#x27;borderRightWidth&#x27;</span>,<span class="string">&#x27;borderBottomWidth&#x27;</span>,<span class="string">&#x27;borderLeftWidth&#x27;</span>,<span class="string">&#x27;borderStyle&#x27;</span>,<span class="string">&#x27;paddingTop&#x27;</span>,<span class="string">&#x27;paddingRight&#x27;</span>,<span class="string">&#x27;paddingBottom&#x27;</span>,<span class="string">&#x27;paddingLeft&#x27;</span>,<span class="string">&#x27;fontStyle&#x27;</span>,<span class="string">&#x27;fontVariant&#x27;</span>,<span class="string">&#x27;fontWeight&#x27;</span>,<span class="string">&#x27;fontStretch&#x27;</span>,<span class="string">&#x27;fontSize&#x27;</span>,<span class="string">&#x27;fontSizeAdjust&#x27;</span>,<span class="string">&#x27;lineHeight&#x27;</span>,<span class="string">&#x27;fontFamily&#x27;</span>,<span class="string">&#x27;textAlign&#x27;</span>,<span class="string">&#x27;textTransform&#x27;</span>,<span class="string">&#x27;textIndent&#x27;</span>,<span class="string">&#x27;textDecoration&#x27;</span>,<span class="string">&#x27;letterSpacing&#x27;</span>,<span class="string">&#x27;wordSpacing&#x27;</span>,<span class="string">&#x27;tabSize&#x27;</span>,<span class="string">&#x27;MozTabSize&#x27;</span>];<span class="keyword">var</span> isFirefox=<span class="built_in">window</span>.mozInnerScreenX!=<span class="literal">null</span>;<span class="function"><span class="keyword">function</span> <span class="title">getCaretCoordinates</span>(<span class="params">element,position,options</span>)</span>&#123;<span class="keyword">var</span> debug=options&amp;&amp;options.debug||<span class="literal">false</span>;<span class="keyword">if</span>(debug)&#123;<span class="keyword">var</span> el=<span class="built_in">document</span>.querySelector(<span class="string">&#x27;#input-textarea-caret-position-mirror-div&#x27;</span>);<span class="keyword">if</span>(el)&#123;el.parentNode.removeChild(el)&#125;&#125;<span class="keyword">var</span> div=<span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);div.id=<span class="string">&#x27;input-textarea-caret-position-mirror-div&#x27;</span>;<span class="built_in">document</span>.body.appendChild(div);<span class="keyword">var</span> style=div.style;<span class="keyword">var</span> computed=<span class="built_in">window</span>.getComputedStyle?getComputedStyle(element):element.currentStyle;style.whiteSpace=<span class="string">&#x27;pre-wrap&#x27;</span>;<span class="keyword">if</span>(element.nodeName!==<span class="string">&#x27;INPUT&#x27;</span>)style.wordWrap=<span class="string">&#x27;break-word&#x27;</span>;style.position=<span class="string">&#x27;absolute&#x27;</span>;<span class="keyword">if</span>(!debug)style.visibility=<span class="string">&#x27;hidden&#x27;</span>;properties.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">prop</span>)</span>&#123;style[prop]=computed[prop]&#125;);<span class="keyword">if</span>(isFirefox)&#123;<span class="keyword">if</span>(element.scrollHeight&gt;<span class="built_in">parseInt</span>(computed.height))style.overflowY=<span class="string">&#x27;scroll&#x27;</span>&#125;<span class="keyword">else</span>&#123;style.overflow=<span class="string">&#x27;hidden&#x27;</span>&#125;div.textContent=element.value.substring(<span class="number">0</span>,position);<span class="keyword">if</span>(element.nodeName===<span class="string">&#x27;INPUT&#x27;</span>)div.textContent=div.textContent.replace(<span class="regexp">/\s/g</span>,<span class="string">&quot;\u00a0&quot;</span>);<span class="keyword">var</span> span=<span class="built_in">document</span>.createElement(<span class="string">&#x27;span&#x27;</span>);span.textContent=element.value.substring(position)||<span class="string">&#x27;.&#x27;</span>;div.appendChild(span);<span class="keyword">var</span> coordinates=&#123;<span class="attr">top</span>:span.offsetTop+<span class="built_in">parseInt</span>(computed[<span class="string">&#x27;borderTopWidth&#x27;</span>]),<span class="attr">left</span>:span.offsetLeft+<span class="built_in">parseInt</span>(computed[<span class="string">&#x27;borderLeftWidth&#x27;</span>])&#125;;<span class="keyword">if</span>(debug)&#123;span.style.backgroundColor=<span class="string">&#x27;#aaa&#x27;</span>&#125;<span class="keyword">else</span>&#123;<span class="built_in">document</span>.body.removeChild(div)&#125;<span class="keyword">return</span> coordinates&#125;<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">module</span>!=<span class="string">&quot;undefined&quot;</span>&amp;&amp;<span class="keyword">typeof</span> <span class="built_in">module</span>.exports!=<span class="string">&quot;undefined&quot;</span>)&#123;<span class="built_in">module</span>.exports=getCaretCoordinates&#125;<span class="keyword">else</span>&#123;<span class="built_in">window</span>.getCaretCoordinates=getCaretCoordinates&#125;&#125;())&#125;])&#125;);</span><br></pre></td></tr></table></figure><h2 id="修改链接样式"><a href="#修改链接样式" class="headerlink" title="修改链接样式"></a>修改链接样式</h2><ul><li>打开<code>source/_data/styles.styl</code>，添加以下内容：</li></ul><figure class="highlight styl"><figcaption><span>styles.styl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="comment">// 文章内链接文本样式</span></span><br><span class="line"><span class="selector-class">.post-body</span> <span class="selector-tag">p</span> a&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#0593d3</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: none;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#0593d3</span>;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fc6423</span>;</span><br><span class="line">    <span class="attribute">border-bottom</span>: none;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#fc6423</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.post-body</span> <span class="selector-tag">ul</span> a&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#0593d3</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: none;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#0593d3</span>;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fc6423</span>;</span><br><span class="line">    <span class="attribute">border-bottom</span>: none;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#fc6423</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">......</span><br></pre></td></tr></table></figure><h2 id="修改字体（提高网页加载速度）"><a href="#修改字体（提高网页加载速度）" class="headerlink" title="修改字体（提高网页加载速度）"></a>修改字体（提高网页加载速度）</h2><ul><li>打开主题配置文件<code>config.yml</code>，更换为中科大字体镜像源，设置全局字体大小</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">font:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> </span><br><span class="line"></span><br><span class="line">  <span class="comment"># Uri of fonts host, e.g. //fonts.googleapis.com (Default).</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">//fonts.proxy.ustclug.org</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font options:</span></span><br><span class="line">  <span class="comment"># `external: true` will load this font family from `host` above.</span></span><br><span class="line">  <span class="comment"># `family: Times New Roman`. Without any quotes.</span></span><br><span class="line">  <span class="comment"># `size: x.x`. Use `em` as unit. Default: 1 (16px)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Global font settings used for all elements inside &lt;body&gt;.</span></span><br><span class="line">  <span class="attr">global:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">Lato</span></span><br><span class="line">    <span class="attr">size:</span> <span class="number">0.9</span></span><br></pre></td></tr></table></figure><h2 id="底部跳动的心"><a href="#底部跳动的心" class="headerlink" title="底部跳动的心"></a>底部跳动的心</h2><ul><li>修改主题配置文件<code>config.yml</code></li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Icon between year and copyright info.</span></span><br><span class="line"><span class="attr">icon:</span></span><br><span class="line">  <span class="comment"># Icon name in Font Awesome. See: https://fontawesome.com/v4.7.0/icons/</span></span><br><span class="line">  <span class="comment"># `heart` is recommended with animation in red (#ff0000).</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">heart</span></span><br><span class="line">  <span class="comment"># If you want to animate the icon, set it to true.</span></span><br><span class="line">  <span class="attr">animated:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Change the color of icon, using Hex Code.</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#ff0000&quot;</span></span><br></pre></td></tr></table></figure><h2 id="添加加载条"><a href="#添加加载条" class="headerlink" title="添加加载条"></a>添加加载条</h2><ul><li><p><a href="http://github.hubspot.com/pace/docs/welcome/">加载条 样式</a></p></li><li><p>在Next主题根目录下安装 <a href="https://github.com/theme-next/theme-next-pace">theme-next-pace</a></p></li></ul><pre><code>$ git clone https://github.com/theme-next/theme-next-pace source/lib/pace</code></pre><ul><li>修改Next主题配置文件<code>config.yml</code></li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">......</span></span><br><span class="line"><span class="comment"># Progress bar in the top during page loading.</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-pace</span></span><br><span class="line"><span class="comment"># For more information: https://github.com/HubSpot/pace</span></span><br><span class="line"><span class="attr">pace:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Themes list:</span></span><br><span class="line">  <span class="comment"># big-counter | bounce | barber-shop | center-atom | center-circle | center-radar | center-simple</span></span><br><span class="line">  <span class="comment"># corner-indicator | fill-left | flat-top | flash | loading-bar | mac-osx | material | minimal</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">corner-indicator</span></span><br><span class="line"><span class="string">......</span></span><br><span class="line">  <span class="comment"># Internal version: 1.0.2</span></span><br><span class="line">  <span class="comment"># pace: //cdn.jsdelivr.net/npm/pace-js@1/pace.min.js</span></span><br><span class="line">  <span class="comment"># pace: //cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js</span></span><br><span class="line">  <span class="comment"># pace_css: //cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css</span></span><br><span class="line">  <span class="comment"># pace_css: //cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-minimal.min.css</span></span><br><span class="line">  <span class="attr">pace:</span> <span class="string">/cdn.jsdelivr.net/npm/pace-js@1/pace.min.js</span></span><br><span class="line">  <span class="attr">pace_css:</span> <span class="string">//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css</span></span><br><span class="line"><span class="string">......</span></span><br></pre></td></tr></table></figure><h2 id="文章底部的标签样式"><a href="#文章底部的标签样式" class="headerlink" title="文章底部的标签样式"></a>文章底部的标签样式</h2><p>－　打开<code>source/_data/styles.styl</code>，添加以下内容：</p><figure class="highlight styl"><figcaption><span>styles.styl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*文章底部标签样式*/</span></span><br><span class="line"><span class="selector-class">.posts-expand</span> <span class="selector-class">.post-tags</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);</span><br><span class="line">  -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);</span><br><span class="line">  box-shadow: 0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&#x27;Comic Sans MS&#x27;</span>, sans-serif;</span><br><span class="line">  transition: .2s ease-out;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">3px</span> <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f5f5f5</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: none;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line"></span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">1px</span> <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">8px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    <span class="attribute">background</span>: rgba(<span class="number">100</span>,<span class="number">154</span>,<span class="number">182</span>,<span class="number">0.902</span>);</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    -webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">16px</span> <span class="number">0</span> rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.2</span>), <span class="number">0</span> <span class="number">6px</span> <span class="number">20px</span> <span class="number">0</span> rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.19</span>);</span><br><span class="line">    -moz-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">16px</span> <span class="number">0</span> rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.2</span>), <span class="number">0</span> <span class="number">6px</span> <span class="number">20px</span> <span class="number">0</span> rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.19</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">16px</span> <span class="number">0</span> rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.2</span>), <span class="number">0</span> <span class="number">6px</span> <span class="number">20px</span> <span class="number">0</span> rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.19</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其它标签页修改可参考<a href="https://leafjame.github.io/posts/4158923031.html">Hexo NexT主题之自定义标签页</a>，有彩色标签页、球形标签页、心形标签页等样式。</p><h2 id="网站-logo-炫彩效果"><a href="#网站-logo-炫彩效果" class="headerlink" title="网站 logo 炫彩效果"></a>网站 logo 炫彩效果</h2><p>我使用的是 NexT 5 的 Pisces（主题 _config.yml 中 scheme 配置），主要设置样式为 site-meta，其它的主题类型需要自己调整。</p><ul><li>打开<code>source/_data/styles.styl</code>，添加以下内容：</li></ul><figure class="highlight styl"><figcaption><span>styles.styl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 网站 logo 炫彩效果</span></span><br><span class="line">.site-title&#123;</span><br><span class="line">  <span class="attribute">background-image</span>: linear-gradient(</span><br><span class="line">    to <span class="attribute">right</span>,</span><br><span class="line">    orangered,</span><br><span class="line">    orange,</span><br><span class="line">    gold,</span><br><span class="line">    lightgreen,</span><br><span class="line">    cyan,</span><br><span class="line">    dodgerblue,</span><br><span class="line">    mediumpurple,</span><br><span class="line">    hotpink,</span><br><span class="line">    orangered</span><br><span class="line">  );</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">110vw</span>;</span><br><span class="line">  -webkit-<span class="attribute">background-clip</span>: text;</span><br><span class="line">  <span class="attribute">color</span>: rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.1</span>); <span class="comment">/* transparent IE 不支持 */</span></span><br><span class="line">  <span class="attribute">animation</span>: sliding <span class="number">30s</span> linear infinite;</span><br><span class="line">&#125;</span><br><span class="line">@keyframes sliding&#123;</span><br><span class="line">  to&#123;</span><br><span class="line">    <span class="attribute">background-position</span>:  -<span class="number">2000vw</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.site-meta</span>,</span><br><span class="line"><span class="selector-class">.site-subtitle</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.1</span>); <span class="comment">/* transparent IE 不支持 */</span></span><br><span class="line">  <span class="attribute">animation</span>: hue <span class="number">1.5s</span> linear infinite;</span><br><span class="line">  <span class="attribute">background-image</span>: linear-gradient(to right bottom, rgb(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>), rgb(<span class="number">255</span>,<span class="number">128</span>,<span class="number">0</span>), rgb(<span class="number">255</span>,<span class="number">255</span>,<span class="number">0</span>), rgb(<span class="number">0</span>,<span class="number">255</span>,<span class="number">0</span>), rgb(<span class="number">0</span>,<span class="number">255</span>,<span class="number">128</span>), rgb(<span class="number">0</span>,<span class="number">255</span>,<span class="number">255</span>), rgb(<span class="number">0</span>,<span class="number">128</span>,<span class="number">255</span>), rgb(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>), rgb(<span class="number">128</span>,<span class="number">0</span>,<span class="number">255</span>), rgb(<span class="number">255</span>,<span class="number">0</span>,<span class="number">255</span>), rgb(<span class="number">255</span>,<span class="number">0</span>,<span class="number">128</span>));</span><br><span class="line">  -webkit-<span class="attribute">background-clip</span>: text;</span><br><span class="line">&#125;</span><br><span class="line">@keyframes hue &#123;</span><br><span class="line">  from &#123;</span><br><span class="line">      <span class="attribute">filter</span>: hue-rotate(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">      <span class="attribute">filter</span>: hue-rotate(-<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.site-meta&#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ecf9f8</span>;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: linear-gradient(<span class="number">90deg</span>,<span class="number">#f79533</span> <span class="number">0</span>,<span class="number">#f37055</span> <span class="number">15%</span>,<span class="number">#ef4e7b</span> <span class="number">30%</span>,<span class="number">#a166ab</span> <span class="number">44%</span>,<span class="number">#5073b8</span> <span class="number">58%</span>,<span class="number">#1098ad</span> <span class="number">72%</span>,<span class="number">#07b39b</span> <span class="number">86%</span>,<span class="number">#6dba82</span> <span class="number">100%</span>)!important;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="背景图片"><a href="#背景图片" class="headerlink" title="背景图片"></a>背景图片</h2><h3 id="主题背景图片"><a href="#主题背景图片" class="headerlink" title="主题背景图片"></a>主题背景图片</h3><ul><li>打开<code>source/_data/styles.styl</code>，添加以下内容：</li></ul><figure class="highlight styl"><figcaption><span>styles.styl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//背景</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  background:url(https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/bg2.jpg);</span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">  <span class="attribute">background-attachment</span>:fixed;</span><br><span class="line">  <span class="attribute">background-position</span>:<span class="number">50%</span> <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="动态背景"><a href="#动态背景" class="headerlink" title="动态背景"></a>动态背景</h2><h3 id="动态线条-canvas-nest"><a href="#动态线条-canvas-nest" class="headerlink" title="动态线条 canvas_nest"></a>动态线条 canvas_nest</h3><ul><li>主题目录下运行以下命令</li></ul><pre><code>$ git clone https://github.com/theme-next/theme-next-canvas-nest source/lib/canvas-nest</code></pre><ul><li>修改主题配置文件<code>config.yml</code>，当然也可以使用CDN。</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 动态线条</span></span><br><span class="line"><span class="comment"># Canvas-nest</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-canvas-nest</span></span><br><span class="line"><span class="comment"># For more information: https://github.com/hustcc/canvas-nest.js</span></span><br><span class="line"><span class="attr">canvas_nest:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">onmobile:</span> <span class="literal">true</span> <span class="comment"># Display on mobile or not</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;0,0,255&quot;</span> <span class="comment"># RGB values, use `,` to separate</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.5</span> <span class="comment"># The opacity of line: 0~1</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># z-index property of the background</span></span><br><span class="line">  <span class="attr">count:</span> <span class="number">99</span> <span class="comment"># The number of lines</span></span><br><span class="line"></span><br><span class="line"><span class="string">.....</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Internal version: 1.0.0</span></span><br><span class="line">  <span class="comment"># canvas_nest: //cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js</span></span><br><span class="line">  <span class="comment"># canvas_nest_nomobile: //cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest-nomobile.min.js</span></span><br><span class="line">  <span class="attr">canvas_nest:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@latest/canvas-nest.min.js</span></span><br><span class="line">  <span class="attr">canvas_nest_nomobile:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@latest/canvas-nest-nomobile.min.js</span></span><br></pre></td></tr></table></figure><h3 id="动态彩带-canvas-ribbon"><a href="#动态彩带-canvas-ribbon" class="headerlink" title="动态彩带 canvas_ribbon"></a>动态彩带 canvas_ribbon</h3><ul><li>主题目录下运行以下命令</li></ul><pre><code>$ git clone https://github.com/theme-next/theme-next-canvas-ribbon source/lib/canvas-ribbon</code></pre><ul><li>修改主题配置文件<code>config.yml</code>，当然也可以使用CDN。</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 动态彩带</span></span><br><span class="line"><span class="comment"># Canvas-ribbon</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-canvas-ribbon</span></span><br><span class="line"><span class="comment"># For more information: https://github.com/zproo/canvas-ribbon</span></span><br><span class="line"><span class="attr">canvas_ribbon:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">size:</span> <span class="number">300</span> <span class="comment"># The width of the ribbon</span></span><br><span class="line">  <span class="attr">alpha:</span> <span class="number">0.6</span> <span class="comment"># The transparency of the ribbon</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># The display level of the ribbon</span></span><br><span class="line"></span><br><span class="line"><span class="string">.....</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Internal version: 1.0.0</span></span><br><span class="line">  <span class="comment"># canvas_ribbon: //cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js</span></span><br><span class="line">  <span class="attr">canvas_ribbon:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js</span></span><br></pre></td></tr></table></figure><h3 id="Tree-三维特效"><a href="#Tree-三维特效" class="headerlink" title="Tree 三维特效"></a>Tree 三维特效</h3><p>提供<code>three_waves</code>、<code>canvas_lines</code>、<code>canvas_sphere</code>三种特效。</p><ul><li>主题目录下运行以下命令</li></ul><pre><code>$ git clone https://github.com/theme-next/theme-next-three source/lib/three</code></pre><ul><li>修改主题配置文件<code>config.yml</code>，当然也可以使用CDN。</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 三维动效</span></span><br><span class="line"><span class="comment"># JavaScript 3D library.</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-three</span></span><br><span class="line"><span class="attr">three:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">three_waves:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">canvas_lines:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">canvas_sphere:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="string">.....</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Internal version: 1.0.0</span></span><br><span class="line">  <span class="comment"># three: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js</span></span><br><span class="line">  <span class="comment"># three_waves: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three-waves.min.js</span></span><br><span class="line">  <span class="comment"># canvas_lines: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/canvas_lines.min.js</span></span><br><span class="line">  <span class="comment"># canvas_sphere: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/canvas_sphere.min.js</span></span><br><span class="line">  <span class="attr">three:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js</span></span><br><span class="line">  <span class="attr">three_waves:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-three@latest/three-waves.min.js</span></span><br><span class="line">  <span class="attr">canvas_lines:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-three@latest/canvas_lines.min.js</span></span><br><span class="line">  <span class="attr">canvas_sphere:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-three@latest/canvas_sphere.min.js</span></span><br></pre></td></tr></table></figure><h2 id="返回顶部图标"><a href="#返回顶部图标" class="headerlink" title="返回顶部图标"></a>返回顶部图标</h2><h3 id="猫"><a href="#猫" class="headerlink" title="猫"></a>猫</h3><ul><li>打开<code>source/_data/styles.styl</code>，添加以下内容：</li></ul><figure class="highlight styl"><figcaption><span>styles.styl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回顶部 猫</span></span><br><span class="line"><span class="selector-class">.back-to-top</span> &#123;</span><br><span class="line">  <span class="comment">//right: 60px;</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">70px</span>;  <span class="comment">//图片素材宽度</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">900px</span>;  <span class="comment">//图片素材高度</span></span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">900px</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: unset;</span><br><span class="line">  transition: all .5s ease-in-out;</span><br><span class="line">  <span class="attribute">background</span>: url(<span class="string">&quot;/images/scroll.png&quot;</span>);</span><br><span class="line">  <span class="comment">//隐藏箭头图标</span></span><br><span class="line">  &gt; <span class="selector-tag">i</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.back-to-top-on</span> &#123;</span><br><span class="line">    <span class="attribute">bottom</span>: unset;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">100vh</span> &lt; (<span class="number">900px</span> + <span class="number">200px</span>) ? calc( <span class="number">100vh</span> - <span class="number">900px</span> - <span class="number">200px</span> ) : <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="有趣小插件"><a href="#有趣小插件" class="headerlink" title="有趣小插件"></a>有趣小插件</h2><h3 id="每日一言"><a href="#每日一言" class="headerlink" title="每日一言"></a>每日一言</h3><p>放在合适位置即可</p><ul><li>中文版</li></ul><pre><code>&lt;script type=&quot;text/javascript&quot; src=&quot;https://api.uixsj.cn/hitokoto/w.php?code=js&quot;&gt;&lt;/script&gt;&lt;div id=&quot;xsjhitokoto&quot;&gt;&lt;script&gt;xsjhitokoto()&lt;/script&gt;&lt;/div&gt;</code></pre><ul><li>中英文版</li></ul><pre><code>&lt;script type=&quot;text/javascript&quot; src=&quot;https://api.uixsj.cn/hitokoto/en.php?code=js&quot;&gt;&lt;/script&gt;&lt;div id=&quot;enhitokoto&quot;&gt;&lt;script&gt;enhitokoto()&lt;/script&gt;&lt;/div&gt;</code></pre><h3 id="天气预报"><a href="#天气预报" class="headerlink" title="天气预报"></a>天气预报</h3><pre><code>&lt;iframe scrolling=&quot;no&quot; src=&quot;https://tianqiapi.com/api.php?style=tx&amp;skin=sogou&quot; frameborder=&quot;0&quot; width=&quot;100%&quot; height=&quot;30&quot; allowtransparency=&quot;true&quot;&gt;&lt;/iframe&gt;</code></pre><h3 id="每日必应图片"><a href="#每日必应图片" class="headerlink" title="每日必应图片"></a>每日必应图片</h3><pre><code>&lt;img src=&quot;https://api.uixsj.cn/bing/bing.php&quot; width=&quot;300px&quot; height=&quot;auto&quot;&gt;</code></pre><h3 id="地球仪显示访客位置（RevolverMaps）插件"><a href="#地球仪显示访客位置（RevolverMaps）插件" class="headerlink" title="地球仪显示访客位置（RevolverMaps）插件"></a>地球仪显示访客位置（RevolverMaps）插件</h3><pre><code>&lt;script type=&quot;text/javascript&quot; src=&quot;//rf.revolvermaps.com/0/0/5.js?i=5b3ac4cx0nk&amp;amp;m=0&amp;amp;c=ff0000&amp;amp;cr1=ffffff&quot; async=&quot;async&quot;&gt;&lt;/script&gt;</code></pre><h2 id="彩色标签云"><a href="#彩色标签云" class="headerlink" title="彩色标签云"></a>彩色标签云</h2><ul><li>修改主题配置文件<code>config.yml</code>。</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标签云</span></span><br><span class="line"><span class="comment"># TagCloud settings for tags page.</span></span><br><span class="line"><span class="attr">tagcloud:</span></span><br><span class="line">  <span class="comment"># All values below are same as default, change them by yourself.</span></span><br><span class="line">  <span class="attr">min:</span> <span class="number">12</span> <span class="comment"># Minimun font size in px</span></span><br><span class="line">  <span class="attr">max:</span> <span class="number">30</span> <span class="comment"># Maxium font size in px</span></span><br><span class="line">  <span class="attr">start:</span> <span class="string">&quot;#9733EE&quot;</span> <span class="comment"># Start color (hex, rgba, hsla or color keywords)</span></span><br><span class="line">  <span class="attr">end:</span> <span class="string">&quot;#FF512F&quot;</span> <span class="comment"># End color (hex, rgba, hsla or color keywords)</span></span><br><span class="line">  <span class="attr">amount:</span> <span class="number">200</span> <span class="comment"># Amount of tags, change it if you have more than 200 tags</span></span><br></pre></td></tr></table></figure><h2 id="添加文本结束"><a href="#添加文本结束" class="headerlink" title="添加文本结束"></a>添加文本结束</h2><h3 id="通常样式"><a href="#通常样式" class="headerlink" title="通常样式"></a>通常样式</h3><p>参考 <a href="https://asdfv1929.github.io/2018/01/28/add-the-end/">Hexo NexT主题内给每篇文章后添加结束标语</a></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/next/%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/%E6%96%87%E6%9C%AC%E7%BB%93%E6%9D%9F1.PNG" width="300" hegiht="200"></center><ul><li>新建 <code>themes\next\layout\_macro\passage-end-tag.swig</code> 文件</li></ul><figure class="highlight plain"><figcaption><span>passage-end-tag.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &#123;% if not is_index %&#125;</span><br><span class="line">        &lt;div style&#x3D;&quot;text-align:center;color: #ccc;font-size:14px;&quot;&gt;-------------本文结束&lt;i class&#x3D;&quot;fa fa-paw&quot;&gt;&lt;&#x2F;i&gt;感谢您的阅读-------------&lt;&#x2F;div&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure><ul><li>打开 <code>themes\next\layout\_macro\post.swig</code>文件，添加以下内容。</li></ul><figure class="highlight plain"><figcaption><span>post.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">   &lt;div&gt;</span><br><span class="line">&#123;% if not is_index %&#125;</span><br><span class="line">&#123;% include &#39;passage-end-tag.swig&#39; %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">   &#123;#####################&#125;</span><br><span class="line">   &#123;### END POST BODY ###&#125;</span><br><span class="line">   &#123;#####################&#125;</span><br></pre></td></tr></table></figure><ul><li>打开主题配置文件<code>config.yml</code>，添加以下内容。</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#文章末尾添加“本文结束”标记</span></span><br><span class="line"><span class="attr">passage_end_tag:</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="进一步美化"><a href="#进一步美化" class="headerlink" title="进一步美化"></a>进一步美化</h3><p>参考 <a href="http://yiluyanxia.site/">一路烟霞</a><br><a href="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/next/%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/css_pattern_bottom.png">css_pattern_bottom.png</a></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/next/%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/%E6%96%87%E6%9C%AC%E7%BB%93%E6%9D%9F2.PNG" width="300" hegiht="200"></center><ul><li><p>图片存放路径 <code>themes\next\source\images\css_pattern_bottom.png</code></p></li><li><p>修改 <code>themes\next\layout\_macro\passage-end-tag.swig</code> 文件</p></li></ul><figure class="highlight plain"><figcaption><span>passage-end-tag.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &#123;% if not is_index %&#125;</span><br><span class="line">        &lt;footer class&#x3D;&quot;article-over-footer&quot;&gt;完&lt;&#x2F;footer&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure><ul><li>打开<code>source/_data/styles.styl</code>，添加以下内容：</li></ul><figure class="highlight styl"><figcaption><span>styles.styl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加文本结束</span></span><br><span class="line">.article-over-footer&#123;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">background-image</span>: url(<span class="string">&#x27;/images/css_pattern_bottom.png&#x27;</span>);</span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-position</span>: center bottom;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">70px</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="搞怪网页标题"><a href="#搞怪网页标题" class="headerlink" title="搞怪网页标题"></a>搞怪网页标题</h2><ul><li>打开主题配置文件<code>config.yml</code>，添加以下内容：</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a trick on website title</span></span><br><span class="line"><span class="attr">title_trick:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">leave:</span> <span class="string">&quot;(つェ⊂)我藏好了哦~&quot;</span></span><br><span class="line">  <span class="attr">enter:</span> <span class="string">&quot;(*´∇｀*) 被你发现啦~&quot;</span></span><br></pre></td></tr></table></figure><ul><li>打开 <code>themes\next\layout\custom.swig</code> 文件，如果没有，则新建。</li></ul><figure class="highlight plain"><figcaption><span>custom.swig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;# 搞怪网页标题 #&#125;</span><br><span class="line">&#123;% if theme.title_trick.enable %&#125;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    var OriginTitile &#x3D; document.title;</span><br><span class="line">    var titleTime;</span><br><span class="line">    document.addEventListener(&#39;visibilitychange&#39;, function() &#123;</span><br><span class="line">      if (document.hidden) &#123;</span><br><span class="line">        document.title &#x3D; &#39;&#123;&#123; theme.title_trick.leave &#125;&#125;&#39; + OriginTitile;</span><br><span class="line">        clearTimeout(titleTime);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        document.title &#x3D; &#39;&#123;&#123; theme.title_trick.enter &#125;&#125;&#39; + OriginTitile;</span><br><span class="line">        titleTime &#x3D; setTimeout(function() &#123;</span><br><span class="line">          document.title &#x3D; OriginTitile;</span><br><span class="line">        &#125;, 2000);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html">hexo的next主题个性化教程:打造炫酷网站</a></li><li><a href="https://blog.csdn.net/qq_36759224/article/details/85420403">Hexo 博客优化之博客美化系列（持续更新）</a></li><li><a href="https://zhuanlan.zhihu.com/p/60424755">hexo的next主题个性化配置</a></li><li><a href="http://yearito.cn/posts/hexo-theme-beautify.html">Hexo 搭建个人博客系列：主题美化篇</a></li><li><a href="http://yearito.cn/posts/hexo-advanced-settings.html">Hexo 搭建个人博客系列：进阶设置篇</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> hexo博客 </category>
          
          <category> next主题优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo博客 </tag>
            
            <tag> next主题优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo博客：写作技巧</title>
      <link href="/2019/02/06/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9A%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/"/>
      <url>/2019/02/06/hexo%E5%8D%9A%E5%AE%A2%EF%BC%9A%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>主要参考 <a href="http://yearito.cn/posts/hexo-writing-skills.html">Hexo 搭建个人博客系列：写作技巧篇</a></p><p><strong>常用技巧</strong></p><ul><li>阅读更多： <code>&lt;!-- more--&gt;</code></li><li>空格： 1个空格字符<code>&amp;nbsp;</code> &emsp; 1个中文宽度<code>&amp;emsp;</code></li><li>换&nbsp;行： <code>&lt;/br&gt;</code></li><li>插入图片： <code>&lt;img src=&quot; &quot; width=&quot;600&quot; hegiht=&quot;400&quot; &gt;</code></li><li>居中： <code>&lt;center&gt; &lt;/center&gt;</code> </li></ul><a id="more"></a><h2 id="文本居中标签"><a href="#文本居中标签" class="headerlink" title="文本居中标签"></a>文本居中标签</h2><p>参考 <a href="https://theme-next.iissnan.com/tag-plugins.html">内置标签 文本居中的引用</a> </p><p>文本居中标签有以下三种写法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- HTML方式: 直接在 Markdown 文件中编写 HTML 来调用 --&gt;</span><br><span class="line">&lt;!-- 其中 class&#x3D;&quot;blockquote-center&quot; 是必须的 --&gt;</span><br><span class="line">&lt;blockquote class&#x3D;&quot;blockquote-center&quot;&gt;时光荏苒，珍惜当下&lt;&#x2F;blockquote&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 标签方式 --&gt;</span><br><span class="line">&#123;% centerquote %&#125;时光荏苒，珍惜当下&#123;% endcenterquote %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- 标签别名 --&gt;</span><br><span class="line">&#123;% cq %&#125;时光荏苒，珍惜当下&#123;% endcq %&#125;</span><br></pre></td></tr></table></figure><p><strong>举例：</strong></p><pre><code>&lt;blockquote class=&quot;blockquote-center&quot;&gt;时光荏苒，珍惜当下&lt;/blockquote&gt;</code></pre><p><strong>效果：</strong></p><blockquote class="blockquote-center">时光荏苒，珍惜当下</blockquote><h2 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h2><p>书写方式：</p><pre><code>// ``` [language] [title] [url] [link text]// code snippet// ```</code></pre><p>其中，各参数意义如下：</p><ul><li>langugae：语言名称，引导渲染引擎正确解析并高亮显示关键字</li><li>title：代码块标题，将会显示在左上角</li><li>url：链接地址，如果没有指定 link text 则会在右上角显示 link</li><li>link text：链接名称，指定 url 后有效，将会显示在右上角</li></ul><p>如果不想填写 title，可以在 language 和 url 之间添加至少三个空格。</p><h2 id="note-标签"><a href="#note-标签" class="headerlink" title="note 标签"></a>note 标签</h2><h3 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h3><ul><li>打开主题配置文件<code>config.yml</code>, 修改 note 标签 。</li></ul><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># note 标签</span></span><br><span class="line"><span class="comment"># Note tag (bs-callout)</span></span><br><span class="line"><span class="attr">note:</span></span><br><span class="line">  <span class="comment"># Note tag style values:</span></span><br><span class="line">  <span class="comment">#  - simple    bs-callout old alert style. Default.</span></span><br><span class="line">  <span class="comment">#  - modern    bs-callout new (v2-v3) alert style.</span></span><br><span class="line">  <span class="comment">#  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span></span><br><span class="line">  <span class="comment">#  - disabled  disable all CSS styles import of note tag.</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">flat</span></span><br><span class="line">  <span class="attr">icons:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">border_radius:</span> <span class="number">3</span></span><br><span class="line">  <span class="comment"># Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line">  <span class="comment"># Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line">  <span class="attr">light_bg_offset:</span> <span class="number">20</span><span class="string">%</span>  <span class="comment"># 默认背景减淡效果，以百分比计算</span></span><br></pre></td></tr></table></figure><h3 id="效果展示"><a href="#效果展示" class="headerlink" title="效果展示"></a>效果展示</h3><p>通过 note 标签可以为段落添加背景色，语法如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [class] %&#125;</span><br><span class="line">文本内容 (支持行内标签)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>支持的 class 种类包括 <code>default</code> <code>primary</code> <code>success</code> <code>info</code> <code>warning</code> <code>danger</code>，也可以不指定 class。</p><p><strong>举例：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note default %&#125;</span><br><span class="line">路是自己走出来的；机会是自己创造出来的。人不能创造时机，但是它可以抓住那些已经出现的时机。累了，才放慢脚步。错了，才想到最后。苦了，才知道满足。伤了，才明白坚强。</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary %&#125;</span><br><span class="line">尝试后可能会放弃，但千万不能放弃尝试。</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success %&#125;</span><br><span class="line">每天给自己一个希望，试着不为明天而烦恼，不为昨天而叹息，只为今天更美好！人生没有对错，只有选择后的坚持，不后悔，走下去，就是对的。走着走着，花就开了。</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info %&#125;</span><br><span class="line">如果把我们能做到的都做了，最终连我们自己都会被吓到。</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning %&#125;</span><br><span class="line"> 今日的事情，尽心、尽意、尽力去做了，无论成绩如何，都应该高高兴兴地上床恬睡。</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger %&#125;</span><br><span class="line">生活其实很简单，过了今天就是明天。</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p><strong>效果：</strong>（按顺序，加上小图标）</p><div class="note default">            <p>路是自己走出来的；机会是自己创造出来的。人不能创造时机，但是它可以抓住那些已经出现的时机。累了，才放慢脚步。错了，才想到最后。苦了，才知道满足。伤了，才明白坚强。</p>          </div><div class="note primary">            <p>尝试后可能会放弃，但千万不能放弃尝试。</p>          </div><div class="note success">            <p>每天给自己一个希望，试着不为明天而烦恼，不为昨天而叹息，只为今天更美好！人生没有对错，只有选择后的坚持，不后悔，走下去，就是对的。走着走着，花就开了。</p>          </div><div class="note info">            <p>如果把我们能做到的都做了，最终连我们自己都会被吓到。</p>          </div><div class="note warning">            <p>今日的事情，尽心、尽意、尽力去做了，无论成绩如何，都应该高高兴兴地上床恬睡。</p>          </div><div class="note danger">            <p>生活其实很简单，过了今天就是明天。</p>          </div><h2 id="button-按钮"><a href="#button-按钮" class="headerlink" title="button 按钮"></a>button 按钮</h2><p>通过 button 标签可以快速添加带有主题样式的按钮，语法如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% button &#x2F;path&#x2F;to&#x2F;url&#x2F;, text, icon [class], title %&#125;</span><br><span class="line">也可简写为：</span><br><span class="line">&#123;% btn &#x2F;path&#x2F;to&#x2F;url&#x2F;, text, icon [class], title %&#125;</span><br></pre></td></tr></table></figure><p><strong>举例：</strong></p><pre><code>&#123;% btn #, 文本 %&#125;&#123;% btn #, 文本 & 标题, 标题 %&#125;&#123;% btn #, 文本 & 图标, home %&#125;&#123;% btn #, 文本 & 大图标 (固定宽度), home fa-fw fa-lg %&#125;</code></pre><p><strong>效果：</strong></p><a class="btn" href="#">文本</a><a class="btn" href="#"><i class="fa fa-标题"></i>文本 & 标题</a><a class="btn" href="#"><i class="fa fa-home"></i>文本 & 图标</a><a class="btn" href="#"><i class="fa fa-home fa-fw fa-lg"></i>文本 & 大图标 (固定宽度)</a><h2 id="tab-标签"><a href="#tab-标签" class="headerlink" title="tab 标签"></a>tab 标签</h2><p>tab 标签用于快速创建 tab 选项卡，语法如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs [Unique name], [index] %&#125;</span><br><span class="line">  &lt;!-- tab [Tab caption]@[icon] --&gt;</span><br><span class="line">  标签页内容（支持行内标签）</span><br><span class="line">  &lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>其中，各参数意义如下：</p><ul><li>Unique name: 全局唯一的 Tab 名称，将作为各个标签页的 id 属性前缀</li><li>index: 当前激活的标签页索引，如果未定义则默认选中显示第一个标签页，如果设为 - 1 则默认隐藏所有标签页</li><li>Tab caption: 当前标签页的标题，如果不指定则会以 Unique name 加上索引作为标题</li><li>icon: 在标签页标题中添加 Font awesome 图标</li></ul><p><strong>举例：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Tab标签列表 %&#125;</span><br><span class="line">  &lt;!-- tab 王祖贤1 --&gt;</span><br><span class="line">    标签页1文本内容</span><br><span class="line">&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;hexo-1257031621.cos.ap-chengdu.myqcloud.com&#x2F;%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE&#x2F;hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7&#x2F;1.jpg&quot; width&#x3D;&quot;600&quot; hegiht&#x3D;&quot;400&quot; &gt;</span><br><span class="line">  &lt;!-- endtab --&gt;</span><br><span class="line">  &lt;!-- tab 王祖贤2 --&gt;</span><br><span class="line">    标签页2文本内容</span><br><span class="line">&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;hexo-1257031621.cos.ap-chengdu.myqcloud.com&#x2F;%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE&#x2F;hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7&#x2F;2.jpg&quot; width&#x3D;&quot;600&quot; hegiht&#x3D;&quot;400&quot; &gt;</span><br><span class="line">  &lt;!-- endtab --&gt;</span><br><span class="line">  &lt;!-- tab 王祖贤3 --&gt;</span><br><span class="line">    标签页3文本内容</span><br><span class="line">&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;hexo-1257031621.cos.ap-chengdu.myqcloud.com&#x2F;%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE&#x2F;hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7&#x2F;3.jpg&quot; width&#x3D;&quot;600&quot; hegiht&#x3D;&quot;400&quot; &gt;</span><br><span class="line">  &lt;!-- endtab --&gt;</span><br><span class="line">  &lt;!-- tab 王祖贤4 --&gt;</span><br><span class="line">    标签页4文本内容</span><br><span class="line">&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;hexo-1257031621.cos.ap-chengdu.myqcloud.com&#x2F;%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE&#x2F;hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7&#x2F;4.jpg&quot; width&#x3D;&quot;600&quot; hegiht&#x3D;&quot;400&quot; &gt;</span><br><span class="line">  &lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p><strong>效果：</strong></p><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">王祖贤1</a></li><li class="tab"><a href="#tab标签列表-2">王祖贤2</a></li><li class="tab"><a href="#tab标签列表-3">王祖贤3</a></li><li class="tab"><a href="#tab标签列表-4">王祖贤4</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><p>   标签页1文本内容<br><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/1.jpg" width="600" hegiht="400" ></p></div><div class="tab-pane" id="tab标签列表-2"><p>   标签页2文本内容<br><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/2.jpg" width="600" hegiht="400" ></p></div><div class="tab-pane" id="tab标签列表-3"><p>   标签页3文本内容<br><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/3.jpg" width="600" hegiht="400" ></p></div><div class="tab-pane" id="tab标签列表-4"><p>   标签页4文本内容<br><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E5%86%99%E4%BD%9C%E6%8A%80%E5%B7%A7/4.jpg" width="600" hegiht="400" ></p></div></div></div>]]></content>
      
      
      <categories>
          
          <category> hexo博客 </category>
          
          <category> next主题优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo博客 </tag>
            
            <tag> 写作技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo+github 免费搭建属于自己的博客</title>
      <link href="/2019/02/06/hexo+github%20%E5%85%8D%E8%B4%B9%E6%90%AD%E5%BB%BA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/"/>
      <url>/2019/02/06/hexo+github%20%E5%85%8D%E8%B4%B9%E6%90%AD%E5%BB%BA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;<a href="https://hexo.io/zh-cn/">Hexo</a>是一款基于Node.js的静态博客框架，依赖少易于安装使用，可以方便的生成静态网页托管在GitHub和Coding上，是搭建博客的首选框架。</p><pre><code># Hexo 安装$ npm install hexo-cli -g$ hexo init blog$ cd blog$ npm install$ hexo server# 命令组合$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo s        # 清除、生成、启动$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo d        # 清除、生成、部署# hexo 部署$ npm install hexo-deployer-git --save</code></pre><a id="more"></a><h2 id="安装Hexo博客框架"><a href="#安装Hexo博客框架" class="headerlink" title="安装Hexo博客框架"></a>安装Hexo博客框架</h2><h3 id="安装Node-js-和-Git工具"><a href="#安装Node-js-和-Git工具" class="headerlink" title="安装Node.js 和 Git工具"></a>安装Node.js 和 Git工具</h3><p>&emsp;&emsp;参考<a href="https://hexo.io/zh-cn/docs/">Hexo文档</a>，<a href="https://hexo.io/zh-cn/">Hexo</a> 是一个快速、简洁且高效的博客框架。安装 Hexo 相当简单，需要事先安装Node.js 和 Git两个工具。</p><ul><li><a href="https://nodejs.org/en/">Node.js</a> (Node.js 版本需不低于 8.6，建议使用 Node.js 10.0 及以上版本)</li><li><a href="https://git-scm.com/">Git</a></li></ul><div class="note info">            <p>注意：其中git for windows最好挂上一个代理，否则下载速度十分缓慢,可以选择<a href="https://github.com/waylau/git-for-win">国内下载站</a></p>          </div><h3 id="安装-Hexo-博客框架"><a href="#安装-Hexo-博客框架" class="headerlink" title="安装 Hexo 博客框架"></a>安装 Hexo 博客框架</h3><p>（1） Node.js 和 Git安装完成后，打开要安装博客的盘或者文件夹，右键选择<code>Git Bash Here</code>，再输入以下命令安装Hexo。 </p><pre><code>$ npm install hexo-cli -g$ hexo init blog$ cd blog$ npm install$ hexo server</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E5%AE%89%E8%A3%85Hexo2.JPG" width="400" hegiht="300" >（图）Git Bash安装Hexo </center><p>（2）打开浏览器，输入网址<a href="http://localhost:4000/">http://localhost:4000/</a>，可以看到Hexo生成的本地界面（默认landscape主题）。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E5%AE%89%E8%A3%85Hexo3.JPG" width="500" hegiht="400" >（图）landscape主题</center><h3 id="常用hexo命令介绍"><a href="#常用hexo命令介绍" class="headerlink" title="常用hexo命令介绍"></a>常用hexo命令介绍</h3><p><strong>命令缩写</strong></p><pre><code>$ hexo g：    hexo generate    # 生成静态网页$ hexo c：    hexo clean    # 清除$ hexo s：    hexo server    # 生成本地服务器$ hexo d：    hexo deploy    # 部署</code></pre><p><strong>命令组合</strong></p><pre><code>$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo s        # 清除、生成、启动$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo d        # 清除、生成、部署</code></pre><h2 id="Hexo部署到Github"><a href="#Hexo部署到Github" class="headerlink" title="Hexo部署到Github"></a>Hexo部署到Github</h2><p>&emsp;&emsp;此前只可以在本地访问博客，将hexo部署到GitHub是为了能在任何设备上浏览博客。</p><p>&emsp;&emsp;Hexo 提供了快速方便的一键部署功能，让您只需一条命令就能将网站部署到服务器上。本文依托的是gitHub pages服务+hexo来搭建。使用Github pages服务搭建博客的好处是访问速度快（全是静态文件）、免费搭建、不需要服务器和后台、绑定域名方便。</p><h3 id="创建Github仓库"><a href="#创建Github仓库" class="headerlink" title="创建Github仓库"></a>创建Github仓库</h3><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">1.注册账号</a></li><li class="tab"><a href="#tab标签列表-2">2.创建仓库</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><p>打开<a href="https://github.com/">Github官网</a>，注册账号。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E6%96%B0%E5%BB%BA%E4%BB%93%E5%BA%931.jpg" width="400" hegiht="300" >（图）注册Github账号 </center></div><div class="tab-pane" id="tab标签列表-2"><p>点击“+”号，再点击<code>New repository</code>，创建仓库。仓库名应该为<code>username.github.io</code>。<br>例如我的<a href="https://github.com/xxty847/xxty847.github.io">xxty847.github.io</a></p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E6%96%B0%E5%BB%BA%E4%BB%93%E5%BA%932.jpg" width="400" hegiht="400" ><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E6%96%B0%E5%BB%BA%E4%BB%93%E5%BA%933.png" width="400" hegiht="400" >（图）创建Github仓库 </center></div></div></div><h3 id="添加SSH公钥到GitHub"><a href="#添加SSH公钥到GitHub" class="headerlink" title="添加SSH公钥到GitHub"></a>添加SSH公钥到GitHub</h3><p>（1）打开Git Bash终端，输入以下命令生成秘钥</p><pre><code>$ git config --global user.name &quot;yourname&quot;$ git config --global user.email &quot;youremail&quot;$ ssh-keygen -t rsa -C &quot;youremail&quot;其中yourname为GitHub用户名，youremail为GitHub注册邮箱。</code></pre><p>此时，在C盘用户文件夹下就会有一个新的.ssh文件夹，里面有刚刚创建的ssh密钥文件id_rsa和id_rsa.pub。<br>把id_rsa.pub公钥放在GitHub上，这样当你链接GitHub自己的账户时，它就会根据公钥匹配你的私钥，当能够相互匹配时，才能够顺利的通过git上传你的文件到GitHub上。</p><div class="note warning">            <p>id_rsa是你这台电脑的私人秘钥，不能给别人看的;id_rsa.pub是公共秘钥，可以随便给别人看。</p>          </div><p>（2）在GitHub的<code>setting</code>中，找到<code>SSH keys</code>的设置选项<br>（3）点击<code>New SSH key</code>，把公钥id_rsa.pub里面的信息复制进去。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E6%B7%BB%E5%8A%A0%E5%85%AC%E9%92%A51.png" width="150" hegiht="400" ><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E6%B7%BB%E5%8A%A0%E5%85%AC%E9%92%A52.jpg" width="500" hegiht="400" >（图）添加SSH公钥 </center><h3 id="将hexo部署到GitHub"><a href="#将hexo部署到GitHub" class="headerlink" title="将hexo部署到GitHub"></a>将hexo部署到GitHub</h3><p>（1）打开Git Bash终端，输入以下命令</p><pre><code>$ npm install hexo-deployer-git --save</code></pre><p>（2）打开站点配置文件 <code>_config.yml</code>。以我的<a href="https://github.com/xxty847/xxty847.github.io">xxty847.github.io</a>为例，末尾添加以下内容：</p><figure class="highlight yml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">......</span></span><br><span class="line"><span class="comment"># Deployment 注释</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="comment"># 类型</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="comment"># 仓库</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/xxty847/xxty847.github.io.git</span></span><br><span class="line">  <span class="comment"># 分支</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p>（3）打开Git Bash终端，输入以下命令</p><pre><code>$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code></pre><p>打开浏览器，输入<a href="https://github.com/xxty847/xxty847.github.io">http:/xxty847.github.io</a>。可以看到与本地生成的<a href="http://localhost:4000/">http://localhost:4000/</a>网页一样，不同的是<a href="https://github.com/xxty847/xxty847.github.io">http:/xxty847.github.io</a>可以在任何设备上浏览。</p><h2 id="绑定域名"><a href="#绑定域名" class="headerlink" title="绑定域名"></a>绑定域名</h2><p>&emsp;&emsp;不想花钱购买域名以跳过这个步骤，GitHub 提供的二级域名<code>username.github.io</code>，平常自己写写博客也够用了。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E5%9F%9F%E5%90%8D2.JPG" width="600" hegiht="400" >（图）GitHub 二级域名 </center><p><strong>购买域名</strong></p><p>&emsp;&emsp;国内的域名代理商可以选择<a href="https://cloud.tencent.com/">腾讯云</a>或者<a href="https://www.aliyun.com/">阿里云</a>。我在腾讯云购买的域名<a href="xioaxioataoya.club">xioaxioataoya.club</a>。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E5%9F%9F%E5%90%8D1.JPG" width="800" hegiht="500" >（图）购买域名 </center><h3 id="设置云解析"><a href="#设置云解析" class="headerlink" title="设置云解析"></a>设置云解析</h3><p>可参考github help：<a href="https://help.github.com/en/articles/managing-a-custom-domain-for-your-github-pages-site">自定义域名解析设置</a>文档。里面关于IP地址有四个：</p><pre><code>185.199.108.153185.199.109.153185.199.110.153185.199.111.153</code></pre><p>也可以自己 <code>ping xxty847.github.io</code> 查看IP地址。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E5%9F%9F%E5%90%8D3.JPG" width="500" hegiht="300" >（图）IP地址 </center><p>云解析设置主要有两部分：</p><pre><code>主机记录:@   记录类型：A      记录值：IP地址主机记录:www 记录类型：CNAME  记录值：GitHub 二级域名</code></pre><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E5%9F%9F%E5%90%8D4.JPG" width="800" hegiht="500" >（图）设置云解析 </center><h3 id="博客绑定域名"><a href="#博客绑定域名" class="headerlink" title="博客绑定域名"></a>博客绑定域名</h3><p>（1）在博客根目录下source文件夹下创建CNAME文件(没有任何后缀)，添加自己购买的的域名。</p><figure class="highlight c"><figcaption><span>CNAME</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xioaxioataoya.club</span><br></pre></td></tr></table></figure><p>（2）打开仓库 ，点击setting ，下滑找到custom domain，添加域名</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/hexo%20blog%20%E6%90%AD%E5%BB%BA/%E5%9F%9F%E5%90%8D5.JPG" width="600" hegiht="400" >（图）设置自定义域名 </center><p>（3）打开Git Bash终端，输入以下命令</p><pre><code>$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code></pre><p>（4）打开浏览器，输入自己域名<a href="xioaxioataoya.club">xioaxioataoya.club</a>查看是否成功显示。</p><h2 id="出现的问题"><a href="#出现的问题" class="headerlink" title="出现的问题"></a>出现的问题</h2><h3 id="warning-LF-will-be-replaced-by-CRLF问题。"><a href="#warning-LF-will-be-replaced-by-CRLF问题。" class="headerlink" title="warning: LF will be replaced by CRLF问题。"></a>warning: LF will be replaced by CRLF问题。</h3><p>&emsp;&emsp;在windows上传时可能出现 <code>warning: LF will be replaced by CRLF</code>问题。这是由于windows中的换行符为CRLF， 而在linux下的换行符为LF，所以在执行add . 时出现提示。</p><p><strong>解决办法</strong></p><p>在博客根目录下打开git终端：</p><p>（1）删除.git</p><pre><code>$ rm -rf .git  // 删除.git  $ git config --global core.autocrlf false  // 禁用自动转换</code></pre><p>（2）重新安装</p><pre><code>$ git init  // 重新安装 git   $ git add .  // 注意有 .</code></pre>]]></content>
      
      
      <categories>
          
          <category> hexo博客 </category>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo博客 </tag>
            
            <tag> 博客搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>科学趣闻：四维空间</title>
      <link href="/2018/12/29/%E7%A7%91%E5%AD%A6%E8%B6%A3%E9%97%BB%EF%BC%9A%E5%9B%9B%E7%BB%B4%E7%A9%BA%E9%97%B4/"/>
      <url>/2018/12/29/%E7%A7%91%E5%AD%A6%E8%B6%A3%E9%97%BB%EF%BC%9A%E5%9B%9B%E7%BB%B4%E7%A9%BA%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><ul><li><p>零维：点的世界；</p></li><li><p>一维：线的世界，只有长度；</p></li><li><p>二维：平面世界，只有长和宽；</p></li><li><p>三维：立体空间世界，具有长、宽、高；</p></li><li><p>四维：一种时空概念，多是指爱因斯坦相对论中提及的“四维时空”概念，即我们的宇宙是由时间和空间构成。时空的关系，是在三维的架构上的长、宽、高三条轴外又加了一条时间轴。</p></li></ul><a id="more"></a></br><h2 id="1-四维空间"><a href="#1-四维空间" class="headerlink" title="1. 四维空间"></a>1. 四维空间</h2><blockquote><p>&emsp;&emsp;经过点、线、面的发展，人们将自己现在所处的空间定义为三维空间，我们知道三维空间之前还有一维、二维空间，那么在三维空间之上是否存在着四维空间呢？如果存在四维空间，四维空间又是怎么样的呢？<br>&emsp;&emsp;然而，四维空间并不是指爱因斯坦广义相对论里的三维空间加一维时间，这是一个认识上的很大误区。事实上，时间维是独立于空间维的，一维空间也有时间，二维空间也有时间，三维空间也有时间，三维空间加上一维时间构成一个四维时空，这并不等同于纯粹的四维空间。黎曼几何之后的高维几何学已经发展了很多年，在超弦理论里宇宙的结构是九维空间加一维时间，而M理论里宇宙是十维空间加一维时间的十一维时空结构。</p></blockquote><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%A7%91%E5%AD%A6%E8%B6%A3%E9%97%BB/%E5%9B%9B%E7%BB%B4%E7%A9%BA%E9%97%B4.jpg" >四维空间</center><blockquote><p>&emsp;&emsp;四维空间究竟该怎样理解呢？如上图，两条互相垂直的直线构成了一个二维空间坐标轴；想像第三条直线穿过交点并垂直于前面两直线，就形成了一个三维空间的坐标轴；现在，想像有第四条直线从交点穿过，并且垂直于前面三条直线，就形成了一个四维空间坐标轴。然而，这条直线是不可能在三维空间里图出来的，它实际上延伸到坐标轴交点内部的四维空间中（在三维空间里，有前后左右上下六个方向；而在四维空间里，还要多出“里”“外”两个方向）。以此类推，如果有第五条直线垂直于前面四条直线，那么它必定存在于五维空间中。</p></blockquote></br>## 2. 高维全貌与天眼> &emsp;&emsp;假设你是一个二维的平面人，生活在清明上河图里，你眼中的世界会是什么样子呢？是点和线！没错，你所看到的只能是一个由杂乱无章的点和线组成的世界，而只有到了三维世界，你才会发现那是一幅精美的图画。这也就意味着，一个人只有到了更高维的空间才能一览无余地看到所在空间的全貌；我们生活在三维空间里，但实际上我们看不到这个空间的全貌，如果我们在四维空间里观察这个世界，某些看似杂乱无章的古代遗迹可能就会变成一幅奇妙的图画。> &emsp;&emsp;还有类似“天眼”的现象。像某些宗教修行到了一定阶段的人，能坐在一间屋子里却看到整个城市——并非像望远镜那样逐区扫描，而是一览无余地看到所有建筑、街道和行人。一个人即使视野再宽，想看到一个建筑的所有侧面也要绕着它走一圈，但开了天眼的人却可以“同时”看到这个建筑的360度，这或许是因为此人的意识暂时进入了四维空间，在四维空间里观察三维空间的结果。> &emsp;&emsp;也就是说，站在一个位置，三维空间的生命可以一下子看到一个面，而四维空间的生命则可以直接看到整个三维物体的全貌。四维生命的最小观察单元是面，而面与面平行或相交就构成了三维空间，所以，四维生命可以轻而易举地观察到整个三维物体的全貌也就不足为奇了。</br>## 3. 透视与穿墙术> &emsp;&emsp;想像纸面上有一个细胞切面，如果你是一个二维的平面人，除非刺破它，否则永远看不到这个细胞里面有什么。然而我们在三维空间却可以一眼看到这个细胞的内部结构。再形像一点说就是：低维空间不过是高维空间的表皮！由此我们再联想到一些透视的例子，如果一个人的视觉能够穿越维度的话，那么看到另一个人的内脏是很自然的结果（当然透视可能并不都是这种原因）。> &emsp;&emsp;在一个二维平面里，如果想围住一个人只要用一个封闭圆圈就可以了，但如果这个人能进入三维空间就可以轻易跳出这个圈子。以此类推，在三维世界里用一个封闭空间就可隔离一个人，但如这个人能够进入四维空间也可以轻易跳出这个三维空间的隔离，这或许就是某些穿墙术的原理。</br>## 4. 莫比乌斯环、克菜因瓶> &emsp;&emsp;一个纸条有正面和反面，如果不充许从边界绕过去，有没有办法从一面到另一面呢？有，就是把这个纸条的一端扭转180度再和另一端连接起来，形成一个莫比乌斯环（如上面左图）。实际上，这个扭曲的二维结构是没有正反面之分的，仔细观察就会发现，只要你在这个纸面上沿着一个方向走，就能够经过这个纸条的所有位置并且回到原点。然而，莫比乌斯环表面虽然是一个二维结构，但是它本身却只能在三维空间存在。<center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%A7%91%E5%AD%A6%E8%B6%A3%E9%97%BB/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E7%8E%AF%E3%80%81%E5%85%8B%E8%8F%9C%E5%9B%A0%E7%93%B6.jpg" >莫比乌斯环、克菜因瓶</center><blockquote><p>&emsp;&emsp;那么三维空间有没有对应的结构呢？有，就是克菜因瓶（如右图）。在这个奇怪的管状物里行走，你能经历所有空间的正面和反面。其实这只是一种简化的表示，真正的克菜因瓶是不可能在三维空间里画出来的，因为它本身存在于四维空间。克菜因瓶好像有一个与自己相交的部分，然而在四维空间它并不相交，就像莫比乌斯环在三维空间不相交一样。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 科学趣闻 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 科学趣闻 </tag>
            
            <tag> 四维空间 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>科学趣闻：薛定谔的猫</title>
      <link href="/2018/12/28/%E7%A7%91%E5%AD%A6%E8%B6%A3%E9%97%BB%EF%BC%9A%E8%96%9B%E5%AE%9A%E8%B0%94%E7%9A%84%E7%8C%AB/"/>
      <url>/2018/12/28/%E7%A7%91%E5%AD%A6%E8%B6%A3%E9%97%BB%EF%BC%9A%E8%96%9B%E5%AE%9A%E8%B0%94%E7%9A%84%E7%8C%AB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;薛定谔的猫”是由奥地利物理学家埃德温.薛定谔(Erwin Schrödinger)于1935年提出的有关猫生死叠加的著名思想实验，是把微观领域的量子行为扩展到宏观世界的推演。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%A7%91%E5%AD%A6%E8%B6%A3%E9%97%BB/%E5%9F%83%E5%B0%94%E6%B8%A9%C2%B7%E8%96%9B%E5%AE%9A%E8%B0%94.jpg" width="200" hegiht="160">埃德温.薛定谔</center><a id="more"></a></br><blockquote><p>&emsp;&emsp;薛定谔如此描述这实验：<br>&emsp;&emsp;实验者甚至可以设置出相当荒谬的案例来。把一只猫关在一个封闭的铁容器里面，并且装置以下仪器（注意必须确保这仪器不被容器中的猫直接干扰）：在一台盖革计数器内置入极少量放射性物质，在一小时内，这个放射性物质至少有一个原子衰变的概率为50%，它没有任何原子衰变的概率也同样为50%；假若衰变事件发生了，则盖革计数管会放电，通过继电器启动一个榔头，榔头会打破装有氰化氢的烧瓶。经过一小时以后，假若没有发生衰变事件，则猫仍旧存活；否则发生衰变，这套机构被触发，氰化氢挥发，导致猫随即死亡。用以描述整个事件的波函数竟然表达出了活猫与死猫各半纠合在一起的状态。<br>&emsp;&emsp;类似这典型案例的众多案例里，原本只局限于原子领域的不明确性被以一种巧妙的机制变为宏观不明确性，只有通过打开这个箱子来直接观察才能解除这样的不明确性。它使得我们难以如此天真地接受采用这种笼统的模型来正确代表实体的量子特性。就其本身的意义而言，它不会蕴含任何不清楚或矛盾的涵义。但是，在一张摇晃或失焦的图片与云堆雾层的快照之间，实则有很大的不同之处。<br>&emsp;&emsp;——埃尔温·薛定谔，Die gegenwärtige Situation in der Quantenmechanik (The present situation in quantum mechanics)</p></blockquote><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%A7%91%E5%AD%A6%E8%B6%A3%E9%97%BB/%E8%96%9B%E5%AE%9A%E8%B0%94%E7%9A%84%E7%8C%AB.jpg" >薛定谔的猫</center><blockquote><p>&emsp;&emsp;根据量子力学的哥本哈根诠释，在实验进行一段时间后，猫会处于又活又死的叠加态。没有测量之前，一个粒子的状态模糊不清，处于各种可能性的混合叠加.比如一个放射性原子，它何时衰变是完全概率性的。只要没有观察，它便处于衰变/不衰变的叠加状态中，只有确实地测量了，它才随机选择一种状态而出现。那么让我们把这个原子放在一个不透明的箱子中让它保持这种叠加状态。现在薛定谔想象了一种结构巧妙的精密装置，每当原子衰变而放出一个中子，它就激发一连串连锁反应，最终结果是打破箱子里的一个毒气瓶，而同时在箱子里的还有一只可怜的猫。事情很明显：如果原子衰变了，那么毒气瓶就被打破，猫就被毒死。要是原子没有衰变，那么猫就好好地活着。</p></blockquote><blockquote><p>&emsp;&emsp;自然的推论：当它们都被锁在箱子里时，因为我们没有观察，所以那个原子处在衰变/不衰变的叠加状态。因为原子的状态不确定，所以猫的状态也不确定，只有当我们打开箱子察看，事情才最终定论：要么猫四脚朝天躺在箱子里死掉了，要么它活蹦乱跳地“喵呜”直叫。问题是，当我们没有打开箱子之前，这只猫处在什么状态？似乎唯一的可能就是，它和我们的原子一样处在叠加态，这只猫当时陷于一种死/活的混合。</p></blockquote><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%A7%91%E5%AD%A6%E8%B6%A3%E9%97%BB/%E8%96%9B%E5%AE%9A%E8%B0%94%E7%9A%84%E7%8C%AB2.png" >薛定谔的猫</center><blockquote><p>&emsp;&emsp;一只猫同时又是死的又是活的？它处在不死不活的叠加态？这未免和常识太过冲突，同时在生物学角度来讲也是奇谈怪论。如果打开箱子出来一只活猫，那么要是它能说话，它会不会描述那种死/活叠加的奇异感受？恐怕不太可能。</p></blockquote><blockquote><p>&emsp;&emsp;简单说，“薛定谔的猫”是薛定谔提出的一个思想实验，用于在宏观现实中描述量子世界诡异的叠加态和不确定性，让人们更加直观地了解量子世界到底多么地诡异！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 科学趣闻 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 科学趣闻 </tag>
            
            <tag> 薛定谔的猫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>经文：心经</title>
      <link href="/2018/08/18/%E7%BB%8F%E6%96%87%EF%BC%9A%E5%BF%83%E7%BB%8F/"/>
      <url>/2018/08/18/%E7%BB%8F%E6%96%87%EF%BC%9A%E5%BF%83%E7%BB%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;《心经》是一本佛教徒必读，必知的一本经典佛经。全称《摩诃般若波罗蜜多心经》，略称《般若心经》或《心经》。全经只有一卷，260字。属于《大品般若经》中600卷中的一节，是佛经中字数最少的一部经典著作，因其字数最少、含义最深、传奇最多、影响最大，被认为是般若经类的提要。该经曾有过七种汉译本。较为有名的是后秦鸠摩罗什所译的《摩诃般若波罗蜜大明咒经》和唐朝玄奘所译的《般若波罗蜜多心经》。</p><a id="more"></a><h2 id="心经全文"><a href="#心经全文" class="headerlink" title="心经全文"></a>心经全文</h2><blockquote><p>&emsp;&emsp;观自在菩萨，行深般若波罗蜜多时，照见五蕴皆空，度一切苦厄。<br>&emsp;&emsp;舍利子，色不异空，空不异色，色即是空，空即是色，受想行识，亦复如是。舍利子，是诸法空相，不生不灭，不垢不净，不增不减。<br>&emsp;&emsp;是故空中无色，无受想行识，无眼耳鼻舌身意，无色声香味触法，无眼界，乃至无意识界，无无明，亦无无明尽，乃至无老死，亦无老死尽。无苦集灭道，无智亦无得。以无所得故。<br>&emsp;&emsp;菩提萨埵，依般若波罗蜜多故，心无挂碍。无挂碍故，无有恐怖，远离颠倒梦想，究竟涅盘。三世诸佛，依般若波罗蜜多故，得阿耨多罗三藐三菩提。<br>&emsp;&emsp;故知般若波罗蜜多，是大神咒，是大明咒，是无上咒，是无等等咒，能除一切苦，真实不虚。故说般若波罗蜜多咒，即说咒曰：揭谛揭谛，波罗揭谛，波罗僧揭谛，菩提萨婆诃。</p></blockquote><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BB%8F%E6%96%87/%E5%BF%83%E7%BB%8F.jpg" width="600" hegiht="400" ></center>]]></content>
      
      
      <categories>
          
          <category> 古文章 </category>
          
          <category> 经文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 古文章 </tag>
            
            <tag> 经文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>经文：清静经</title>
      <link href="/2018/08/18/%E7%BB%8F%E6%96%87%EF%BC%9A%E6%B8%85%E9%9D%99%E7%BB%8F/"/>
      <url>/2018/08/18/%E7%BB%8F%E6%96%87%EF%BC%9A%E6%B8%85%E9%9D%99%E7%BB%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;《清静经》，全称《太上老君说常清静经》。一卷仅五百九十一字。作者不详，成书不低于晋魏。是道教炼养术重要资料之一。道教称老君西游龟台之时，为西王母说常清静经。后经仙人转传，为葛玄所得，笔录而传之于世。即葛玄曰：“吾昔受之于东华帝君，东华帝君受之于金阙帝君，金阙帝君受之于西王母。西王母皆口口相传，不记文字，吾今于世书而录之。”因而《清静经》被认为是三国时葛玄依托之作。</p><a id="more"></a><h2 id="清静经全文"><a href="#清静经全文" class="headerlink" title="清静经全文"></a>清静经全文</h2><blockquote><p>&emsp;&emsp;老君曰：大道无形，生育天地；大道无情，运行日月；大道无名，长养万物；吾不知其名，强名曰道。夫道者：有清有浊，有动有静；天清地浊，天动地静。男清女浊，男动女静。降本流末，而生万物。清者浊之源，动者静之基。人能常清静，天地悉皆归。夫人神好清，而心扰之；人心好静，而欲牵之。常能遣其欲，而心自静，澄其心而神自清。自然六欲不生，三毒消灭。所以不能者，为心未澄，欲未遣也。能遣之者，内观其心，心无其心；外观其形，形无其形；远观其物，物无其物。三者既悟，唯见於空；观空亦空，空无所空；所空既无，无无亦无；无无既无，湛然常寂；寂无所寂，欲岂能生？欲既不生，即是真静。真常应物，真常得性；常应常静，常清静矣。如此清静，渐入真道；既入真道，名为得道，虽名得道，实无所得；为化众生，名为得道；能悟之者，可传圣道。 　<br>&emsp;&emsp;老君曰：上士无争，下士好争；上德不德，下德执德。执著之者，不明道德。众生所以不得真道者，为有妄心。既有妄心，即惊其神；既惊其神，即著万物；既著万物，即生贪求；既生贪求，即是烦恼；烦恼妄想，忧苦身心；但遭浊辱，流浪生死，常沉苦海，永失真道。真常之道，悟者自得，得悟道者，常清静矣。 　　<br>&emsp;&emsp;仙人葛翁曰：吾得真道，曾诵此经万遍。此经是天人所习，不传下士。吾昔受之于东华帝君，东华帝君受之于金阙帝君，金阙帝君受之于西王母。西王母皆口口相传，不记文字。吾今于世，书而录之。上士悟之，升为天官；中士修之，南宫列仙；下士得之，在世长年，游行三界，升入金门。 　　<br>&emsp;&emsp;左玄真人曰：学道之士，持诵此经，即得十天善神，拥护其人。然后玉符保神，金液炼形。形神俱妙，与道合真。　　<br>&emsp;&emsp;正一真人曰：人家有此经，悟解之者，灾障不干，众圣护门。神升上界，朝拜高尊。功满德就，相感帝君。诵持不退，身腾紫云。</p></blockquote><div class="tabs" id="tab标签列表"><ul class="nav-tabs"><li class="tab active"><a href="#tab标签列表-1">1/5</a></li><li class="tab"><a href="#tab标签列表-2">2/5</a></li><li class="tab"><a href="#tab标签列表-3">3/5</a></li><li class="tab"><a href="#tab标签列表-4">4/5</a></li><li class="tab"><a href="#tab标签列表-5">5/5</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab标签列表-1"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BB%8F%E6%96%87/%E5%B8%B8%E6%B8%85%E9%9D%99%E7%BB%8F1.jpg" width="400" hegiht="600" ></div><div class="tab-pane" id="tab标签列表-2"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BB%8F%E6%96%87/%E5%B8%B8%E6%B8%85%E9%9D%99%E7%BB%8F2.jpg" width="400" hegiht="600" ></div><div class="tab-pane" id="tab标签列表-3"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BB%8F%E6%96%87/%E5%B8%B8%E6%B8%85%E9%9D%99%E7%BB%8F3.jpg" width="400" hegiht="600" ></div><div class="tab-pane" id="tab标签列表-4"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BB%8F%E6%96%87/%E5%B8%B8%E6%B8%85%E9%9D%99%E7%BB%8F4.jpg" width="400" hegiht="600" ></div><div class="tab-pane" id="tab标签列表-5"><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E7%BB%8F%E6%96%87/%E5%B8%B8%E6%B8%85%E9%9D%99%E7%BB%8F5.jpg" width="400" hegiht="600" ></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 古文章 </category>
          
          <category> 经文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 古文章 </tag>
            
            <tag> 经文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>古诗文：春江花月夜</title>
      <link href="/2018/06/19/%E5%8F%A4%E8%AF%97%E6%96%87%EF%BC%9A%E6%98%A5%E6%B1%9F%E8%8A%B1%E6%9C%88%E5%A4%9C/"/>
      <url>/2018/06/19/%E5%8F%A4%E8%AF%97%E6%96%87%EF%BC%9A%E6%98%A5%E6%B1%9F%E8%8A%B1%E6%9C%88%E5%A4%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>&emsp;&emsp;《春江花月夜》是唐代诗人张若虚的作品。此诗沿用陈隋乐府旧题，运用富有生活气息的清丽之笔，以月为主体，以江为场景，描绘了一幅幽美邈远、惝恍迷离的春江月夜图，抒写了游子思妇真挚动人的离情别绪以及富有哲理意味的人生感慨，表现了一种迥绝的宇宙意识，创造了一个深沉、寥廓、宁静的境界。全诗共三十六句，每四句一换韵，通篇融诗情、画意、哲理为一体，意境空明，想象奇特，语言自然隽永，韵律宛转悠扬，洗净了六朝宫体的浓脂腻粉，具有极高的审美价值，素有“孤篇盖全唐”之誉。</p><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8F%A4%E8%AF%97%E6%96%87/%E6%98%A5%E6%B1%9F%E8%8A%B1%E6%9C%88%E5%A4%9C.jpg" width="600" hegiht="400" ></center><a id="more"></a><center> （唐）张若虚</center><blockquote><center>春江潮水连海平，海上明月共潮生。<center>滟滟随波千万里，何处春江无月明！<center>江流宛转绕芳甸，月照花林皆似霰。<center>空里流霜不觉飞，汀上白沙看不见。<center>江天一色无纤尘，皎皎空中孤月轮。<center>江畔何人初见月？江月何年初照人？<center>人生代代无穷已，江月年年望相似。<center>不知江月待何人，但见长江送流水。<center>白云一片去悠悠，青枫浦上不胜愁。<center>谁家今夜扁舟子？何处相思明月楼？<center>可怜楼上月徘徊，应照离人妆镜台。<center>玉户帘中卷不去，捣衣砧上拂还来。<center>此时相望不相闻，愿逐月华流照君。<center>鸿雁长飞光不度，鱼龙潜跃水成文。<center>昨夜闲潭梦落花，可怜春半不还家。<center>江水流春去欲尽，江潭落月复西斜。<center>斜月沉沉藏海雾，碣石潇湘无限路。<center>不知乘月几人归，落月摇情满江树。</blockquote><div class="note info">            <p>注音：&emsp;&emsp;  滟(yàn)  &emsp;&emsp;  甸(diàn) &emsp;&emsp;  霰(xiàn) &emsp;&emsp;  汀(tīng) &emsp;&emsp;  砧(zhēn)  &emsp;&emsp;  复西斜(古字中读xiá) &emsp;&emsp;  斜(xié)月  &emsp;&emsp;   碣(jié）</p>          </div>]]></content>
      
      
      <categories>
          
          <category> 古诗文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 古诗词 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>古诗文：桃花源记</title>
      <link href="/2018/06/19/%E5%8F%A4%E8%AF%97%E6%96%87%EF%BC%9A%E6%A1%83%E8%8A%B1%E6%BA%90%E8%AE%B0/"/>
      <url>/2018/06/19/%E5%8F%A4%E8%AF%97%E6%96%87%EF%BC%9A%E6%A1%83%E8%8A%B1%E6%BA%90%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><center><img src="https://hexo-1257031621.cos.ap-chengdu.myqcloud.com/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%9B%BE/%E5%8F%A4%E8%AF%97%E6%96%87/%E6%A1%83%E8%8A%B1%E6%BA%90%E8%AE%B0.jpg" width="600" hegiht="400" > </center><a id="more"></a><center> （东晋）陶渊明</center>  <blockquote><p>&emsp;&emsp;晋太元中，武陵人捕鱼为业。缘溪行，忘路之远近。忽逢桃花林，夹岸数百步，中无杂树，芳草鲜美，落英缤纷，渔人甚异之。复前行，欲穷其林。</p></blockquote><blockquote><p>&emsp;&emsp;林尽水源，便得一山，山有小口，仿佛若有光。便舍船，从口入。初极狭，才通人。复行数十步，豁然开朗。土地平旷，屋舍俨然，有良田美池桑竹之属。阡陌交通，鸡犬相闻。其中往来种作，男女衣着，悉如外人。黄发垂髫，并怡然自乐。</p></blockquote><blockquote><p>&emsp;&emsp;见渔人，乃大惊，问所从来。具答之。便要还家，设酒杀鸡作食。村中闻有此人，咸来问讯。自云先世避秦时乱，率妻子邑人来此绝境，不复出焉，遂与外人间隔。问今是何世，乃不知有汉，无论魏晋。此人一一为具言所闻，皆叹惋。余人各复延至其家，皆出酒食。停数日，辞去。此中人语云：“不足为外人道也。”</p></blockquote><blockquote><p>&emsp;&emsp;既出，得其船，便扶向路，处处志之。及郡下，诣太守，说如此。太守即遣人随其往，寻向所志，遂迷，不复得路。</p></blockquote><blockquote><p>&emsp;&emsp;南阳刘子骥，高尚士也，闻之，欣然规往。未果，寻病终，后遂无问津者。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 古诗文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 古文章 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2018/03/10/hello-world/"/>
      <url>/2018/03/10/hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo博客 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
